# Go 常见问题

> Go 语言使用过程中的常见问题解答

---

## 安装相关

### Q: Go 安装后命令找不到？

**A**: 
- 确认 Go 已添加到 PATH 环境变量
- Windows 默认安装到 `C:\Go`，需要添加到 PATH
- Linux/macOS 通常需要手动添加到 `~/.bashrc` 或 `~/.zshrc`

### Q: 怎么检查 Go 是否安装成功？

**A**: 
```bash
go version
go env GOPATH
```

### Q: 如何更新 Go 版本？

**A**: 
- Windows：下载新版本重新安装
- macOS：`brew upgrade go`
- Linux：下载新版本替换或使用包管理器

---

## 语法相关

### Q: Go 有异常机制吗？

**A**: Go 没有传统意义上的异常机制。错误通过返回值传递：
```go
result, err := doSomething()
if err != nil {
    // 处理错误
}
```

### Q: 为什么 := 和 var 不能混用？

**A**: 
- `:=` 是短变量声明，用于函数内
- `var` 是显式声明，可用于函数外
- 两者不能同时用于同一变量

### Q: Go 支持泛型吗？

**A**: Go 1.18+ 开始支持泛型：
```go
func Print[T any](s []T) {
    for _, v := range s {
        fmt.Println(v)
    }
}
```

---

## 并发相关

### Q: Goroutine 和线程的区别？

**A**: 
- Goroutine 由 Go 运行时管理，比线程更轻量
- 创建数千个 Goroutine 不会耗尽资源
- 使用通道（channel）进行通信

### Q: 通道应该关闭吗？

**A**: 
- 通常由发送方关闭通道
- 接收方可以使用 `v, ok := <-ch` 检查通道是否关闭
- 不要给已关闭的通道发送数据

### Q: 如何优雅地等待 Goroutine 完成？

**A**: 使用 `sync.WaitGroup`：
```go
var wg sync.WaitGroup

for i := 0; i < 5; i++ {
    wg.Add(1)
    go func(i int) {
        defer wg.Done()
        fmt.Println(i)
    }(i)
}

wg.Wait()
```

---

## 包管理相关

### Q: GOPATH 和 Go Module 有什么区别？

**A**: 
- GOPATH：旧的依赖管理方式，依赖放在 `$GOPATH/src`
- Go Module（go.mod）：现代方式，更好的版本控制

### Q: 依赖下载很慢怎么办？

**A**: 
```bash
# 使用国内镜像
go env -w GOPROXY=https://goproxy.cn,direct

# 还可以设置
go env -w GOPROXY=https://proxy.golang.org,direct
```

### Q: 怎么查看依赖关系？

**A**: 
```bash
go mod graph
go list -m all
```

---

## 性能相关

### Q: 如何进行性能分析？

**A**: 
```bash
# CPU 分析
go test -cpuprofile=cpu.out

# 内存分析
go test -memprofile=mem.out

# 使用 pprof 分析
go tool pprof cpu.out
```

### Q: 如何优化 Go 程序？

**A**: 
- 使用 `strings.Builder` 拼接字符串
- 避免不必要的内存分配
- 使用池（sync.Pool）复用对象
- 合理使用通道

---

## 工具相关

### Q: go fmt 和 go vet 有什么区别？

**A**: 
- `go fmt`：格式化代码风格
- `go vet`：静态分析，检查潜在错误

### Q: 怎么生成文档？

**A**: 
```bash
go doc <包名>
go doc <函数名>

# 本地文档服务器
go doc -http=:6060
```

---

## 错误相关

### Q: 常见编译错误有哪些？

**A**: 
- `undefined: xxx` - 变量未定义
- `mismatched types` - 类型不匹配
- `invalid character` - 字符编码问题
- `package xxx is not in GOROOT` - 包路径错误

### Q: 运行时 panic 怎么办？

**A**: 
- 使用 defer 和 recover 捕获：
```go
func safeCall() {
    defer func() {
        if r := recover(); r != nil {
            fmt.Println("Recovered:", r)
        }
    }()
    // 可能 panic 的代码
}
```
