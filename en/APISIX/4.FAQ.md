# APISIX FAQ

Common questions and answers.

## Installation

### Q: Docker container won't start?

**Solutions:**
1. Confirm Docker is installed and running
```bash
docker --version
docker ps
```
2. Check if ports are occupied
```bash
netstat -tlnp | grep 9080
netstat -tlnp | grep 2379
```
3. View container logs
```bash
docker logs apisix
docker logs etcd
```
4. Confirm etcd is running

### Q: Startup failed, etcd connection error?

**Solutions:**
1. Confirm etcd is running
```bash
docker ps | grep etcd
```
2. Check if etcd is listening on correct port
```bash
curl http://127.0.0.1:2379/version
```
3. Check etcd address in config
4. If using Docker, ensure network connectivity

### Q: Port already in use?

**Solutions:**
1. Find process using the port
```bash
lsof -i:9080
netstat -tlnp | grep 9080
```
2. Kill the process or change APISIX port
```yaml
apisix:
  node_listen: 9081
```

### Q: Dependency installation failed?

**Solutions:**
1. Confirm system has basic dev tools
2. Ubuntu/Debian:
```bash
sudo apt-get update
sudo apt-get install -y build-essential
```
3. CentOS/RHEL:
```bash
sudo yum install -y gcc gcc-c++
```

## Usage

### Q: Route not working?

**Solutions:**
1. Check route config format
```bash
curl http://127.0.0.1:9180/apisix/admin/routes \
  -H "X-API-KEY: 123456"
```
2. Confirm route was created correctly
3. Check URI matching rules
4. Check APISIX error logs
```bash
tail -f logs/error.log
```

### Q: Plugin not working?

**Solutions:**
1. Confirm plugin is enabled
```bash
curl http://127.0.0.1:9180/apisix/admin/plugins \
  -H "X-API-KEY: 123456"
```
2. Check plugin config format
3. Confirm plugin dependencies are met (e.g., JWT requires Consumer first)
4. Check plugin error messages in logs

### Q: Upstream service not accessible?

**Solutions:**
1. Confirm upstream service is running
2. Check network connectivity
```bash
curl -v http://backend.example.com:8080
```
3. Check upstream address and port in config
4. Check firewall rules

### Q: How to implement canary release?

**Solutions:**
Use traffic plugin:

```bash
curl -X PUT http://127.0.0.1:9180/apisix/admin/routes/1 \
  -H "X-API-KEY: 123456" \
  -d '{
    "uri": "/api/*",
    "plugins": {
      "traffic": {
        "rules": [
          {
            "match": [
              {"vars": [["http_header", "X-Version", "==", "v2"]]}
            ],
            "weight": 50
          }
        ]
      }
    }
  }'
```

## Configuration

### Q: How to configure SSL/TLS certificates?

**Solutions:**
1. Upload SSL certificate
```bash
curl -X PUT http://127.0.0.1:9180/apisix/admin/ssls/1 \
  -H "X-API-KEY: 123456" \
  -d '{
    "cert": "certificate-content",
    "key": "private-key",
    "sni": "example.com"
  }'
```

### Q: How to configure CORS?

**Solutions:**
Use cors plugin:

```bash
curl -X PUT http://127.0.0.1:9180/apisix/admin/routes/1 \
  -H "X-API-KEY: 123456" \
  -d '{
    "uri": "/api/*",
    "plugins": {
      "cors": {}
    }
  }'
```

### Q: How to use environment variables?

**Solutions:**
You can use environment variables in config:

```yaml
apisix:
  node_listen: ${APISIX_PORT}
etcd:
  host:
    - ${ETCD_HOST}
```

## Performance

### Q: Memory usage keeps increasing?

**Solutions:**
1. Check for memory leaks in plugins
2. Limit buffer size
```yaml
apisix:
  proxy_buffering: off
```
3. Regularly clean logs

### Q: High CPU usage?

**Solutions:**
1. Check for high request volume
2. Optimize regex matching rules
3. Reduce plugin count
4. Use connection pools

### Q: How to improve concurrency?

**Solutions:**
1. Increase worker process count
```nginx
worker_processes auto;
worker_rlimit_nofile 65440;
```
2. Adjust connection limits
```nginx
worker_connections 10240;
```
3. Enable keepalive
```json
{
  "keepalive": 32
}
```

## Security

### Q: How to protect Admin API?

**Solutions:**
1. Use strong keys
2. Restrict access IPs
```yaml
apisix:
  allow_admin:
    - 127.0.0.1
    - 10.0.0.0/8
```
3. Enable HTTPS
4. Use ACL control

### Q: How to prevent attacks?

**Solutions:**
1. Enable rate limiting plugin
2. Enable IP blacklist
3. Enable firewall
4. Monitor anomalous requests

## Learning Resources

### Q: Where to learn APISIX?

- Official Docs: https://apisix.apache.org/docs
- GitHub: https://github.com/apache/apisix
- Official Blog: https://apisix.apache.org/blog
- Video Tutorials: Bilibili, YouTube

### Q: How to get help?

- Submit Issue: https://github.com/apache/apisix/issues
- Community Forum: https://apisix.discourse.group
- Slack: Join Apache APISIX channel

### Q: How to contribute code?

- Read contributor guide: https://apisix.apache.org/docs/general/contributor-guide
- Start with good first issue: https://github.com/apache/apisix/labels/good%20first%20issue
