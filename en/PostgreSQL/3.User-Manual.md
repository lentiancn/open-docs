# PostgreSQL User Manual

## Connecting to PostgreSQL

### Using psql (Command Line)

```bash
# Connect to default database
psql -U postgres

# Connect to specific database
psql -U username -d databasename

# Connect to remote server
psql -h hostname -p 5432 -U username -d databasename
```

### Using pgAdmin

1. Download pgAdmin from https://www.pgadmin.org/
2. Add new server connection
3. Enter connection details

---

## Basic SQL Operations

### Create Table

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### Insert Data

```sql
INSERT INTO users (username, email, password_hash)
VALUES ('john_doe', 'john@example.com', 'hashed_password_here');
```

### Query Data

```sql
-- Select all users
SELECT * FROM users;

-- Select specific columns
SELECT username, email FROM users;

-- Filter with WHERE
SELECT * FROM users WHERE id = 1;

-- Sort results
SELECT * FROM users ORDER BY created_at DESC;

-- Limit results
SELECT * FROM users LIMIT 10 OFFSET 0;
```

### Update Data

```sql
UPDATE users
SET email = 'newemail@example.com'
WHERE id = 1;
```

### Delete Data

```sql
DELETE FROM users WHERE id = 1;
```

---

## Advanced Features

### JSON Operations

```sql
-- Create table with JSON column
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    attributes JSON
);

-- Insert JSON data
INSERT INTO products (name, attributes)
VALUES ('Laptop', '{"brand": "Dell", "specs": {"ram": "16GB", "storage": "512GB"}}');

-- Query JSON data
SELECT name, attributes->>'brand' AS brand FROM products;
SELECT attributes->'specs'->>'ram' AS ram FROM products;
```

### Full-Text Search

```sql
-- Create index for full-text search
CREATE INDEX idx_title ON articles USING GIN(to_tsvector('english', title));

-- Search
SELECT * FROM articles
WHERE to_tsvector('english', title) @@ to_tsquery('english', 'postgres');
```

### JOIN Operations

```sql
-- INNER JOIN
SELECT users.username, orders.order_id
FROM users
INNER JOIN orders ON users.id = orders.user_id;

-- LEFT JOIN
SELECT users.username, orders.order_id
FROM users
LEFT JOIN orders ON users.id = orders.user_id;
```

---

## Database Administration

### Backup Database

```bash
# Backup single database
pg_dump -U postgres myapp > myapp_backup.sql

# Backup all databases
pg_dumpall -U postgres > all_databases_backup.sql

# Compressed backup
pg_dump -U postgres -Fc myapp > myapp_backup.dump
```

### Restore Database

```bash
# Restore from SQL file
psql -U postgres myapp < myapp_backup.sql

# Restore from compressed dump
pg_restore -U postgres -d myapp myapp_backup.dump
```

### User Management

```sql
-- Create user
CREATE USER newuser WITH PASSWORD 'password';

-- Grant privileges
GRANT ALL PRIVILEGES ON DATABASE myapp TO newuser;

-- Grant schema access
GRANT ALL PRIVILEGES ON SCHEMA myschema TO newuser;

-- Revoke privileges
REVOKE ALL PRIVILEGES ON DATABASE myapp FROM newuser;
```

### Index Optimization

```sql
-- Create index
CREATE INDEX idx_username ON users(username);

-- Create composite index
CREATE INDEX idx_email_created ON users(email, created_at);

-- Create partial index
CREATE INDEX idx_active_users ON users(id) WHERE status = 'active';
```

---

## Performance Tuning

### Explain Analyze

```sql
EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'user@example.com';
```

### Vacuum

```sql
-- Reclaim storage
VACUUM;

-- Reclaim storage and update statistics
VACUUM ANALYZE;
```

### Connection Pooling

Consider using PgBouncer for connection pooling in high-traffic applications.
