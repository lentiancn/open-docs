# Руководство пользователя JMeter

## Начало работы с JMeter

### Создание первого тестового плана

1. **Запустите JMeter**: Запустите GUI JMeter
2. **Добавьте группу потоков**: Правый клик по тестовому плану → Добавить → Группа потоков
3. **Настройте группу потоков**:
   - Количество потоков: Количество пользователей
   - Период разгона: Время для запуска всех пользователей
   - Количество циклов: Количество выполнений теста
4. **Добавьте сэмплер**: Правый клик по группе потоков → Добавить → HTTP-запрос
5. **Настройте HTTP-запрос**: Введите имя сервера, путь и параметры
6. **Добавьте слушатели**: Правый клик по группе потоков → Добавить → Слушатель (дерево результатов, сводный отчёт)
7. **Запустите тест**: Нажмите зелёную кнопку "Старт"

## Основные компоненты

### Группа потоков
Группа потоков имитирует пользователей. Ключевые настройки:
- **Количество потоков**: Параллельные пользователи
- **Период разгона**: Время для достижения полной нагрузки
- **Количество циклов**: Сколько раз каждый пользователь выполняет тест
- **Задержка создания потока**: Добавить задержку между созданием потоков

### Сэмплеры
Сэмплеры выполняют фактические запросы:

| Сэмплер | Описание |
|---------|----------|
| HTTP-запрос | Тестирование веб-серверов |
| JDBC-запрос | Тестирование баз данных |
| LDAP-запрос | Тестирование LDAP-серверов |
| FTP-запрос | Тестирование FTP-серверов |
| SOAP/XML-RPC | Тестирование веб-служб |
| TCP-сэмплер | Тестирование TCP-серверов |

### Контроллеры
Контроллеры организуют тестовый поток:

- **Простой контроллер**: Группирует запросы
- **Контроллер цикла**: Повторяет запросы
- **Контроллер условия**: Условное выполнение
- **Транзакционный контроллер**: Измеряет время транзакции

### Слушатели
Слушатели отображают результаты тестов:
- **Дерево результатов**: Детальный запрос/ответ
- **Сводный отчёт**: Агрегированная статистика
- **Графические результаты**: Визуальные графики производительности
- **График времени отклика**: Визуализация времени отклика

### Таймеры
Таймеры добавляют задержки между запросами:
- **Постоянный таймер**: Фиксированная задержка
- **Гауссовский случайный таймер**: Случайная задержка с гауссовским распределением
- **Равномерный случайный таймер**: Случайная задержка в диапазоне

### Утверждения
Утверждения проверяют ответы:
- **Утверждение ответа**: Проверить содержимое ответа
- **Утверждение длительности**: Проверить время отклика
- **Утверждение размера**: Проверить размер ответа
- **XML-утверждение**: Проверить формат XML

## Расширенные функции

### Извлечение данных (корреляция)

Извлечение значений из ответов для динамических данных:

1. **JSON-экстрактор**: Извлечение значений JSON
2. **XPath-экстрактор**: Извлечение значений XML
3. **CSS/JQuery-экстрактор**: Извлечение значений HTML
4. **Экстрактор регулярных выражений**: Извлечение с помощью регулярных выражений

### Переменные и функции

Используйте переменные для параметризации тестов:
- `${variable_name}`: Ссылки на переменные
- `${__functionName(param)}`: Использование встроенных функций

Общие функции:
- `__Random`: Генерация случайных значений
- `__time`: Текущая временная метка
- `__counter`: Инкрементный счётчик
- `__property`: Чтение свойств

### Распределённое тестирование

Выполнение тестов на нескольких машинах:

1. **Настройка удалённых серверов**: Редактирование `remote_hosts` в jmeter.properties
2. **Запуск удалённых серверов**: Запуск `jmeter-server` на каждом слэйве
3. **Запуск теста**: Нажмите "Удалённый старт" в GUI

```bash
# Запуск удалённого сервера
jmeter-server

# Запуск распределённого теста
jmeter -R server1,server2 -t testplan.jmx
```

### Файлы свойств

Настройка поведения JMeter:
- `jmeter.properties`: Основная конфигурация
- `user.properties`: Пользовательские настройки
- `system.properties`: Системные свойства

## Рекомендации

1. **Используйте режим CLI для нагрузочных тестов**: Режим GUI использует больше памяти
2. **Начинайте с низкой нагрузки**: Проверьте работу теста перед масштабированием
3. **Используйте утверждения**: Проверяйте ответы для обнаружения ошибок
4. **Извлекайте динамические данные**: Обрабатывайте идентификаторы сессий, токены и т.д.
5. **Очищайте ресурсы**: Используйте группу потоков tearDown для очистки
6. **Отслеживайте системные ресурсы**: ЦП, память, сеть
7. **Используйте правильные имена**: Понятные имена облегчают отладку
8. **Контроль версий**: Храните тестовые планы в системе контроля версий

## Оптимизация производительности

### Настройки JVM
```bash
HEAP="-Xms1g -Xmx4g"
NEW="-XX:NewSize=512m -XX:MaxNewSize=1024m"
```

### Настройки JMeter
```properties
# Увеличить лимит потоков
thread_nums_higher_limit=10000

# Отключить подробное логирование
log_level.jmeter=INFO
```

## Устранение неполадок

### OutOfMemoryError
- Увеличить размер кучи
- Уменьшить количество потоков
- Использовать режим CLI

### Высокая задержка
- Проверить сетевые условия
- Оптимизировать тестовый план
- Использовать распределённое тестирование

### Ошибки скрипта
- Проверить дерево результатов для деталей
- Включить отладочное логирование
- Проверить утверждения
