# Docker インストールガイド

このガイドでは、さまざまなオペレーティングシステムに Docker Desktop と Docker Engine をインストールする方法について詳しく説明します。

---

## 目次

1. [Docker の概要](#docker-の概要)
2. [バージョン情報](#バージョン情報)
3. [Windows へのインストール](#windows-へのインストール)
4. [macOS へのインストール](#macos-へのインストール)
5. [Linux へのインストール](#linux-へのインストール)
6. [Docker Engine のインストール（CLI のみ）](#docker-engine-のインストールcli-のみ)
7. [インストールの確認](#インストールの確認)
8. [Docker のアンインストール](#docker-のアンインストール)
9. [よくある質問](#よくある質問)

---

## Docker の概要

Docker はアプリケーションの開発、デプロイ、実行のためのオープンソースのコンテナ化プラットフォームです。Docker を使用すると、アプリケーションとその依存関係を軽量でポータブルなコンテナにパッケージ化し、「一度構築すればどこでも実行」を実現できます。

### Docker Desktop と Docker Engine の違い

| 機能 | Docker Desktop | Docker Engine |
|------|----------------|---------------|
| 対応プラットフォーム | Windows、macOS、Linux | Linux |
| GUI | あり | なし |
| 含まれるコンポーネント | Docker Engine、Docker CLI、Docker Compose、Kubernetes など | Docker Engine、Docker CLI |
| 商利用 | 従業員250名以上または年間収益1000万ドル以上で有償サブスクリプションが必要 | 免费（オープンソース） |

> **重要な注意**：大企業（従業員250名以上または年間収益1000万米ドル以上）の商業利用には有償サブスクリプションが必要です。個人利用、従業員250名未満かつ年間収益1000万米ドル未満の小企业、教育用途、非商業オープンソースプロジェクトは免费です。

---

## バージョン情報

Docker は2つの更新チャネルを提供します：

- **安定版（Stable）**：最新の一般公開バージョン、一般ユーザーに适しています
- **テスト版（Test）**：プレリリースバージョン、新機能のテストに适しています（注意して使用）

---

## Windows へのインストール

### システム要件

#### WSL 2 バックエンド（推奨）

- Windows 10 64 ビット：Enterprise、Pro、Education バージョン 22H2（ビルド 19045）
- Windows 11 64 ビット：Enterprise、Pro、Education バージョン 23H2（ビルド 22631）以降
- WSL バージョン 2.1.5 以降
- 64 ビットプロセッサ、二次アドレス変換（SLAT）機能対応
- 4GB システムメモリ
- BIOS/UEFI でハードウェア仮想化を有効にする

#### Hyper-V バックエンド

- Windows 10 64 ビット：Enterprise、Pro、Education バージョン 22H2（ビルド 19045）
- Windows 11 64 ビット：Enterprise、Pro、Education バージョン 23H2（ビルド 22631）以降
- Hyper-V と Containers Windows 機能を有効にする
- 64 ビットプロセッサ、二次アドレス変換（SLAT）機能対応
- 4GB システムメモリ
- BIOS/UEFI でハードウェア仮想化を有効にする

> **注意**：Docker Desktop は Windows Server（Windows Server 2019 や Windows Server 2022 など）ではサポートされていません。Windows Server でコンテナを実行するには、Microsoft の公式ドキュメントを参照してください。

> **重要な注意**：Windows コンテナを実行するには、Windows 10 または Windows 11 Professional または Enterprise エディションが必要です。Windows Home または Education エディションでは Linux コンテナのみ実行できます。

### インストール手順

1. **Docker Desktop インストーラーをダウンロード**：
   - [Docker Desktop for Windows - x86_64](https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe)

2. **ダブルクリックしてインストーラーを実行**。デフォルトのインストールパスは `C:\Program Files\Docker\Docker` です。

3. **構成ページで、「Hyper-V の代わりに WSL 2 を使用する」** 选择（または必要に応じて Hyper-V を選択）。

4. **インストールウィザードの指示に従ってインストールを承認し続行**。

5. **インストールが成功したら、「閉じる」を選択してインストールを完了**。

6. **Docker Desktop を起動**。

### 管理者権限

ユーザーアカウントが管理者アカウントと異なる場合は、より高度な権限が必要な機能にアクセスするために、ユーザーを **docker-users** グループに追加する必要があります：

1. **管理者**として**コンピュータの管理**を実行
2. **ローカルユーザーとグループ** > **グループ** > **docker-users** に移動
3. 右クリックしてユーザーをグループに追加
4. 変更を適用するにはサインアウトして再サインイン

---

## macOS へのインストール

### システム要件

#### Apple Silicon（M シリーズ芯片）

- macOS 11.0（Big Sur）以降
- 少なくとも 4GB のメモリ

#### Intel 芯片

- macOS 10.15（Catalina）以降
- 少なくとも 4GB のメモリ

### インストール手順

1. **Docker Desktop for Mac をダウンロード**：
   - [Apple Silicon（M シリーズ）](https://desktop.docker.com/mac/main/arm64/Docker.dmg)
   - [Intel 芯片](https://desktop.docker.com/mac/main/amd64/Docker.dmg)

2. **Docker.dmg をダブルクリックしてインストーラーを開く**。

3. **Docker アプリケーションを Applications フォルダーにドラッグ**。

4. **Applications フォルダーまたは Launchpad から Docker Desktop を起動**。

5. **Docker サブスクリプションサービス契約に同意**。

6. **Docker Desktop の初期化が完了するのを待つ**。

---

## Linux へのインストール

### 対応ディストリビューション

| ディストリビューション | x86_64/amd64 | arm64/aarch64 |
|--------------|:------------:|:-------------:|
| Ubuntu | ✅ | ✅ |
| Debian | ✅ | ✅ |
| Fedora | ✅ | ✅ |
| CentOS | ✅ | ✅ |
| RHEL | ✅ | ✅ |

### Ubuntu へのインストール

1. **古いバージョンをアンインストール**：
```bash
sudo apt-get remove docker docker-engine docker.io containerd runc
```

2. **apt パッケージインデックスを更新**：
```bash
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg lsb-release
```

3. **Docker の公式 GPG キーを追加**：
```bash
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg
```

4. **安定版リポジトリを設定**：
```bash
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

5. **Docker Engine をインストール**：
```bash
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

### Debian へのインストール

1. **古いバージョンをアンインストール**：
```bash
sudo apt-get remove docker docker-engine docker.io containerd runc
```

2. **Docker Engine をインストール**：
```bash
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

### Fedora へのインストール

```bash
sudo dnf -y install dnf-plugins-core
sudo dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo
sudo dnf install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

### CentOS へのインストール

```bash
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

---

## Docker Engine のインストール（CLI のみ）

任意の Linux ディストリビューション用の静的バイナリインストール：

1. **Docker バイナリをダウンロード**：
```bash
curl -OL https://download.docker.com/linux/static/stable/x86_64/docker-24.0.7.tgz
```

2. **展開**：
```bash
tar xzf docker-24.0.7.tgz
```

3. **バイナリを PATH に移動**：
```bash
sudo cp docker/* /usr/local/bin/
sudo rm -rf docker
```

4. **Docker デーモンを起動**：
```bash
sudo dockerd &
```

---

## インストールの確認

オペレーティングシステムに関係なく、Docker が正常に動作していることを確認できます：

```bash
docker --version          # Docker バージョンを表示
docker-compose --version  # Docker Compose バージョンを表示
docker run hello-world    # テストコンテナを実行
```

「Hello from Docker！」メッセージが表示されれば、インストールは成功です。

---

## Docker のアンインストール

### Windows

1. Windows 設定 > アプリを開く
2. Docker Desktop を見つける
3. アンインストールをクリック

### macOS

1. Applications フォルダーから Docker アプリケーションを削除
2. 残りのファイルをクリーンアップ：
```bash
rm -rf ~/Library/Containers/com.docker.docker
rm -rf ~/Library/Application\ Support/Docker
```

### Linux

```bash
sudo apt-get remove docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo rm -rf /var/lib/docker
sudo rm -rf /var/lib/containerd
```

---

## よくある質問

### Q1: Docker Desktop は有料ですか？

Docker Desktop は以下の用途に免费です：
- 小企业（従業員250名未満かつ年間収益1000万米ドル未満）
- 個人利用
- 教育用途
- 非商業オープンソースプロジェクト

商業利用（従業員250名以上または年間収益1000万米ドル以上）には有償サブスクリプションが必要です。

### Q2: Docker Desktop で Windows コンテナと Linux コンテナを切り替えるには？

Docker Desktop メニューから選択：
- **Switch to Windows containers** - Windows コンテナを使用
- **Switch to Linux containers** - Linux コンテナを使用（デフォルト）

### Q3: Docker Desktop はどの Windows バージョンに対応していますか？

Docker Desktop は Microsoft のサービスタイムラインにある Windows バージョンのみサポートしています：
- Windows 10 Enterprise、Pro、Education 22H2
- Windows 11 Enterprise、Pro、Education 23H2

### Q4: Docker Desktop のプロキシを設定するには？

Docker Desktop 設定 > リソース > プロキシで構成できます。

---

## 関連リンク

- [Docker 公式ドキュメント](https://docs.docker.com/)
- [Docker Desktop ダウンロード](https://www.docker.com/products/docker-desktop/)
- [Docker Hub](https://hub.docker.com/)
- [Docker サブスクリプションと料金](https://www.docker.com/pricing/)
