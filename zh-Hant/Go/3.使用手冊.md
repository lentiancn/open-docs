# Go 使用手冊

> Go 語言程式設計完整指南

---

## 快速開始

### 第一個 Go 程式

```go
package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}
```

執行程式：

```bash
go run main.go
```

---

## 基礎語法

### 變數宣告

```go
// 方式一：類型推斷
var name = "Go"

// 方式二：顯式類型
var age int = 10

// 方式三：短變數宣告（函數內）
message := "Hello"
```

### 資料類型

```go
// 整數
var i int = 10
var ui uint = 10

// 浮點數
var f float64 = 3.14

// 字串
var s string = "Hello"

// 布林值
var b bool = true

// 陣列
var arr [5]int = [5]int{1, 2, 3, 4, 5}

// 切片
slice := []int{1, 2, 3}

// 映射
m := map[string]int{"a": 1, "b": 2}
```

### 控制流

```go
// if 條件
if x > 10 {
    fmt.Println("大於10")
} else {
    fmt.Println("小於等於10")
}

// for 迴圈
for i := 0; i < 10; i++ {
    fmt.Println(i)
}

// switch
switch day {
case 1:
    fmt.Println("週一")
default:
    fmt.Println("其他")
}
```

---

## 函數

### 函數定義

```go
// 基礎函數
func add(a, b int) int {
    return a + b
}

// 多返回值
func divide(a, b int) (int, error) {
    if b == 0 {
        return 0, errors.New("除數不能為零")
    }
    return a / b, nil
}

// 命名返回值
func split(sum int) (x, y int) {
    x = sum * 4 / 9
    y = sum - x
    return
}
```

### 變長參數

```go
func sum(nums ...int) int {
    total := 0
    for _, n := range nums {
        total += n
    }
    return total
}

// 使用
sum(1, 2, 3, 4, 5)
```

---

## 結構體和方法

### 結構體定義

```go
type Person struct {
    Name string
    Age  int
}

// 方法
func (p Person) SayHello() {
    fmt.Printf("你好，我是 %s\n", p.Name)
}
```

### 介面

```go
type Writer interface {
    Write([]byte) (int, error)
}

type Reader interface {
    Read([]byte) (int, error)
}
```

---

## 並發程式設計

### Goroutine

```go
// 啟動協程
go func() {
    fmt.Println("Hello from goroutine")
}()

// 帶參數
go func(msg string) {
    fmt.Println(msg)
}("Hello")
```

### Channel

```go
// 建立通道
ch := make(chan int)

// 發送資料
ch <- 10

// 接收資料
value := <-ch

// 帶緩衝的通道
buffered := make(chan int, 10)
```

### Select

```go
select {
case msg := <-ch1:
    fmt.Println("收到:", msg)
case msg := <-ch2:
    fmt.Println("收到:", msg)
case <-time.After(time.Second):
    fmt.Println("超時")
}
```

---

## 錯誤處理

### 錯誤定義

```go
import "errors"

func divide(a, b int) (int, error) {
    if b == 0 {
        return 0, errors.New("除數不能為零")
    }
    return a / b, nil
}
```

### 錯誤檢查

```go
result, err := divide(10, 0)
if err != nil {
    fmt.Println("錯誤:", err)
    return
}
fmt.Println("結果:", result)
```

---

## 套件管理

### 初始化模組

```bash
go mod init github.com/username/project
```

### 新增依賴

```bash
go get github.com/package/name
```

### 整理依賴

```bash
go mod tidy
```

---

## 測試

### 單元測試

```go
package main

import "testing"

func TestAdd(t *testing.T) {
    result := add(2, 3)
    if result != 5 {
        t.Errorf("期望 5, 實際 %d", result)
    }
}
```

執行測試：

```bash
go test ./...
```

### 基準測試

```go
func BenchmarkHello(b *testing.B) {
    for i := 0; i < b.N; i++ {
        Hello()
    }
}
```

執行基準測試：

```bash
go test -bench=.
```

---

## 最佳實踐

1. 使用 Go Module 管理依賴
2. 遵循 Go 程式碼規範（執行 `go fmt`）
3. 優先使用通道進行並發通訊
4. 避免全域變數
5. 撰寫單元測試
6. 錯誤及時處理
7. 使用 `context` 管理請求生命週期
