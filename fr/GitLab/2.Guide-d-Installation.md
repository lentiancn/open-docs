# GitLab Guide d'Installation

> Guide complet pour installer et configurer GitLab

---

## Configuration Requise

| Ressource | Minimum | Recommandé |
|-----------|---------|------------|
| CPU | 2 cœurs | 4+ cœurs |
| Mémoire | 4 Go | 8+ Go |
| Stockage | 10 Go | 50+ Go |
| OS | Ubuntu, Debian, CentOS, RHEL, Kubernetes | - |

---

## Méthodes d'Installation

### Paquet Omnibus (Recommandé pour Linux)

#### Ubuntu/Debian

```bash
# Installer les dépendances
sudo apt-get update
sudo apt-get install -y curl openssh-server ca-certificates tzdata perl

# Ajouter le dépôt GitLab
curl -fsSL https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.deb.sh | sudo bash

# Installer GitLab
sudo EXTERNAL_URL="https://gitlab.example.com" apt-get install gitlab-ee
```

#### CentOS/RHEL

```bash
# Installer les dépendances
sudo yum install -y curl policycoreutils openssh-server

# Ajouter le dépôt GitLab
curl -fsSL https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash

# Installer GitLab
sudo EXTERNAL_URL="https://gitlab.example.com" yum install -y gitlab-ee
```

### Installation Docker

```bash
# Télécharger l'image Docker GitLab
docker run --detach \
  --hostname gitlab.example.com \
  --publish 443:443 --publish 80:80 --publish 22:22 \
  --name gitlab \
  --restart always \
  --volume /srv/gitlab/config:/etc/gitlab \
  --volume /srv/gitlab/logs:/var/log/gitlab \
  --volume /srv/gitlab/data:/var/opt/gitlab \
  gitlab/gitlab-ee:latest
```

### Installation Kubernetes

```bash
# Utilisant le chart Helm
helm repo add gitlab https://charts.gitlab.io
helm install gitlab gitlab/gitlab \
  --set externalUrl="https://gitlab.example.com" \
  --set certmanager-issuer.email="admin@example.com"
```

---

## Configuration Initiale

### Configurer l'URL Externe

```bash
# Éditer la configuration GitLab
sudo vim /etc/gitlab/gitlab.rb

# Définir l'URL externe
external_url 'https://gitlab.example.com'

# Reconfigurer GitLab
sudo gitlab-ctl reconfigure
```

### Configurer SMTP (Email)

```bash
# Configurer SMTP dans /etc/gitlab/gitlab.rb
gitlab_rails['smtp_enable'] = true
gitlab_rails['smtp_address'] = "smtp.example.com"
gitlab_rails['smtp_port'] = 587
gitlab_rails['smtp_user_name'] = "smtp_user"
gitlab_rails['smtp_password'] = "smtp_password"
gitlab_rails['smtp_domain'] = "example.com"

# Appliquer les changements
sudo gitlab-ctl reconfigure
```

### Activer HTTPS avec Let's Encrypt

```bash
# Dans /etc/gitlab/gitlab.rb
letsencrypt['enable'] = true
letsencrypt['contact_emails'] = ['admin@example.com']

# Reconfigurer
sudo gitlab-ctl reconfigure
---

## Connexion Initiale

1. Accédez à GitLab via votre URL externe
2. Connectez-vous avec l'utilisateur: `root`
3. Le mot de passe est défini lors de la première visite
4. Créez votre premier projet

---

## Commandes Courantes

```bash
# Vérifier le statut
sudo gitlab-ctl status

# Démarrer les services
sudo gitlab-ctl start

# Arrêter les services
sudo gitlab-ctl stop

# Redémarrer les services
sudo gitlab-ctl restart

# Voir les logs
sudo gitlab-ctl tail

# Vérifier la configuration
sudo gitlab-rake gitlab:env:info
```

---

## Dépannage

### L'installation échoue?

- Vérifier les exigences système
- Installer toutes les dépendances
- Vérifier les paramètres du pare-feu et SELinux
- Consulter les journaux d'installation

### GitLab ne démarre pas?

```bash
# Vérifier les conflits de port
sudo netstat -tulpn | grep -E ':(80|443|22)\s'

# Vérifier l'espace disque
df -h

# Consulter les logs
sudo gitlab-ctl tail
```

### Performance lente?

- Augmenter les ressources serveur
- Activer les métriques Prometheus
- Configurer l'espace swap approprié
- Optimiser PostgreSQL

---

## Ressources

- Docs Installation Officielle: https://docs.gitlab.com/ee/install/
- Exigences Matérielles: https://docs.gitlab.com/ee/install/requirements.html
- Forum Communauté: https://forum.gitlab.com/
