# Docker User Manual

This manual provides detailed instructions on Docker's basic usage, including image management, container operations, network configuration, volume management, and more.

---

## Table of Contents

1. [Docker Basic Concepts](#docker-basic-concepts)
2. [Image Operations](#image-operations)
3. [Container Operations](#container-operations)
4. [Network Management](#network-management)
5. [Volume Management](#volume-management)
6. [Using Docker Compose](#using-docker-compose)
7. [Writing Dockerfiles](#writing-dockerfiles)
8. [Docker Common Commands Quick Reference](#docker-common-commands-quick-reference)
9. [Best Practices](#best-practices)
10. [Troubleshooting](#troubleshooting)

---

## Docker Basic Concepts

### What is a Container?

Containers are lightweight, executable standalone packages that contain everything needed to run the software: code, runtime, system tools, system libraries, and settings. Containerization ensures software runs consistently in any environment.

### Core Components

- **Image**: A read-only template used to create containers
- **Container**: A running instance of an image
- **Repository**: A place to store images
- **Dockerfile**: A script used to build images
- **Docker Compose**: A tool for defining and running multi-container applications

---

## Image Operations

### Pull Images

Pull images from Docker Hub:

```bash
# Pull latest version
docker pull nginx

# Pull specific version
docker pull nginx:1.25
```

### List Images

```bash
# List all local images
docker images
```

### Remove Images

```bash
# Remove specified image
docker rmi nginx:latest

# Force remove
docker rmi -f nginx:latest
```

### Build Images

Build images using Dockerfile:

```bash
docker build -t myapp:latest .
```

---

## Container Operations

### Create and Start Containers

```bash
# Interactive container (with terminal)
docker run -it ubuntu /bin/bash

# Daemon container (running in background)
docker run -d nginx

# Port mapping
docker run -d -p 8080:80 nginx

# Specify container name
docker run -d --name my-nginx nginx
```

### View Containers

```bash
# List running containers
docker ps

# List all containers (including stopped)
docker ps -a
```

### Container Lifecycle Management

```bash
# Start container
docker start my-nginx

# Stop container
docker stop my-nginx

# Restart container
docker restart my-nginx

# Remove container
docker rm my-nginx
```

### Enter Container

```bash
# Use exec to enter running container
docker exec -it my-nginx /bin/bash
```

---

## Network Management

### View Networks

```bash
# List all networks
docker network ls

# View network detailed information
docker network inspect bridge
```

### Create Network

```bash
# Create bridge network
docker network create my-network
```

---

## Volume Management

### Create Volume

```bash
# Create volume
docker volume create my-volume

# List volumes
docker volume ls
```

### Use Volumes

```bash
# Mount volume
docker run -d -v my-volume:/container/path nginx

# Mount host directory
docker run -d -v /host/path:/container/path nginx
```

---

## Using Docker Compose

### Docker Compose File Structure

```yaml
version: '3.8'

services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
    depends_on:
      - redis

  redis:
    image: redis:alpine
```

### Common Commands

```bash
# Start all services
docker-compose up

# Start in background
docker-compose up -d

# Stop all services
docker-compose down
```

---

## Writing Dockerfiles

### Basic Instructions

```dockerfile
# Specify base image
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Copy files
COPY . .

# Expose ports
EXPOSE 3000

# Start command
CMD ["node", "index.js"]
```

### Multi-stage Build Example

```dockerfile
# Build stage
FROM golang:1.20 AS builder
WORKDIR /app
RUN go build -o main .

# Run stage
FROM alpine:latest
WORKDIR /app
COPY --from=builder /app/main .
CMD ["./main"]
```

---

## Docker Common Commands Quick Reference

### Image Commands

| Command | Description |
|---------|-------------|
| `docker pull <image>` | Pull image |
| `docker images` | List images |
| `docker rmi <image>` | Remove image |
| `docker build -t <name> .` | Build image |

### Container Commands

| Command | Description |
|---------|-------------|
| `docker run -d <image>` | Run container in background |
| `docker run -it <image>` | Run container interactively |
| `docker ps` | List running containers |
| `docker ps -a` | List all containers |
| `docker start <container>` | Start container |
| `docker stop <container>` | Stop container |
| `docker rm <container>` | Remove container |
| `docker exec -it <container> /bin/bash` | Enter container |

---

## Best Practices

### Image Optimization

1. **Use multi-stage builds**: Reduce final image size
2. **Choose appropriate base images**: Prefer lightweight images like alpine
3. **Reduce layers**: Combine RUN instructions
4. **Use .dockerignore**: Exclude unnecessary files

### Security Recommendations

1. **Don't run as root**: Use USER instruction
2. **Update base images regularly**: Get latest security patches
3. **Use official images**: Prefer verified official images

---

## Troubleshooting

### Container Won't Start

```bash
# View container logs
docker logs <container>
```

### Port Conflicts

```bash
# Check port usage
netstat -tlnp | grep <port>

# Use different port
docker run -d -p 8081:80 nginx
```

### Disk Space Issues

```bash
# Clean unused images
docker image prune -a

# Clean all unused resources
docker system prune -a
```

---

## Related Links

- [Docker Official Documentation](https://docs.docker.com/)
- [Docker Hub](https://hub.docker.com/)
- [Docker Compose Documentation](https://docs.docker.com/compose/)
