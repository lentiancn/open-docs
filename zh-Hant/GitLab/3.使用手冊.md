# GitLab 使用手冊

> 全面掌握 GitLab 的使用方法

---

## 快速開始

### 建立第一個專案

1. 登入 GitLab 後，點擊「新建專案」按鈕
2. 選擇專案範本或空白專案
3. 填寫專案名稱、描述和可見性層級
4. 點擊「建立專案」完成初始化

### 複製專案到本機

```bash
# 複製 HTTPS
git clone https://gitlab.example.com/username/project.git

# 複製 SSH
git clone git@gitlab.example.com:username/project.git
```

---

## 程式碼管理

### 分支操作

```bash
# 建立新分支
git checkout -b feature/new-feature

# 推送分支到遠端
git push -u origin feature/new-feature

# 查看所有分支
git branch -a

# 刪除本機分支
git branch -d feature/new-feature

# 刪除遠端分支
git push origin --delete feature/new-feature
```

### 合併請求（Merge Request）

1. 在本機分支完成開發後，推送到遠端倉庫
2. 開啟專案頁面，點擊「建立合併請求」
3. 填寫標題、描述，選擇來源分支和目標分支
4. 指定審閱者，設定相關標籤和里程碑
5. 建立合併請求，等待程式碼審查

### 程式碼審查

- **行內評論**：審閱者可以直接在程式碼行上新增評論
- **審批規則**：可以設定合併所需的審批人數
- **流水線檢查**：可以要求流水線通過後才能合併
- **衝突解決**：在合併前需要解決可能的衝突

---

## 問題追蹤

### 建立問題

1. 進入專案 → 問題 → 新建問題
2. 填寫標題和描述（支援 Markdown）
3. 設定標籤、里程碑、指派人
4. 設定權重和截止日期

### 使用看板

1. 進入專案 → 問題 → 看板
2. 建立欄位（如：待處理、進行中、已完成）
3. 拖曳問題卡片到對應欄位
4. 可以按成員或標籤篩選

### 里程碑

- 建立里程碑並設定開始和結束日期
- 將相關問題關聯到里程碑
- 追蹤里程碑進度

---

## CI/CD 流水線

### .gitlab-ci.yml 基本結構

```yaml
stages:
  - build
  - test
  - deploy

build:
  stage: build
  script:
    - echo "Building..."
    - npm install
    - npm run build
  artifacts:
    paths:
      - dist/
    expire_in: 1 week

test:
  stage: test
  script:
    - echo "Testing..."
    - npm test
  coverage: '/Coverage: \d+\.\d+%/'

deploy:
  stage: deploy
  script:
    - echo "Deploying..."
  only:
    - main
  environment:
    name: production
```

### 常用Runner設定

#### Docker Executor

```yaml
job:
  image: node:18
  services:
    - postgres:14
  variables:
    POSTGRES_DB: test_db
    POSTGRES_USER: test_user
    POSTGRES_PASSWORD: test_password
```

#### 快取設定

```yaml
cache:
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - node_modules/
    - .npm/
```

### 部署環境

- **正式環境**：正式發布使用
- **預發環境**：上線前測試
- **開發環境**：日常開發使用

---

## Wiki 文檔

### 建立 Wiki 頁面

1. 進入專案 → Wiki → 新建頁面
2. 使用 Markdown 編寫內容
3. 儲存頁面

### 側邊欄

- 自動產生目錄導航
- 可以自訂側邊欄內容

---

## 容器鏡像倉庫

### 推送映像檔

```bash
# 登入 GitLab Registry
docker login registry.gitlab.example.com

# 標記映像檔
docker tag my-image:latest registry.gitlab.example.com/username/project/my-image:latest

# 推送映像檔
docker push registry.gitlab.example.com/username/project/my-image:latest
```

### 拉取映像檔

```bash
docker pull registry.gitlab.example.com/username/project/my-image:latest
```

---

## 安全掃描

### 自動掃描功能

- **依賴掃描**：檢查專案依賴中的安全漏洞
- **容器掃描**：檢查 Docker 映像檔中的安全問題
- **SAST**：靜態應用安全測試
- **DAST**：動態應用安全測試

### 查看安全儀表板

1. 進入專案 → 安全與合規 → 安全儀表板
2. 查看所有漏洞列表
3. 按嚴重程度篩選
4. 建立漏洞追蹤問題

---

## 專案管理技巧

### 使用範本

- 為新專案設定預設分支保護規則
- 設定專案範本
- 使用專案繼承

### 成員管理

- 新增專案成員並設定存取層級
- 使用群組管理多個專案
- 設定存取權杖

### Webhooks

- 設定 Webhook 整合外部服務
- 支援觸發器：push、merge request、tag 等

---

## 最佳實踐

1. **使用功能分支開發**：每個功能或修復使用獨立分支
2. **及時提交**：頻繁提交，保持提交資訊清晰
3. **程式碼審查**：所有程式碼必須經過審查才能合併
4. **自動化測試**：確保 CI/CD 流水線包含測試步驟
5. **文檔完善**：使用 Wiki 記錄專案文檔
6. **安全問題**：定期檢查安全掃描報告
