# Yarn Usage Guide

Comprehensive guide for using Yarn effectively.

---

## Basic Commands

### Initialize a Project

```bash
# Create package.json
yarn init

# Add project details interactively
yarn init -y
```

### Install Dependencies

```bash
# Install all dependencies from package.json
yarn
# or
yarn install

# Install specific package
yarn add <package>
yarn add lodash

# Install as dev dependency
yarn add -D <package>
yarn add --dev jest

# Install specific version
yarn add lodash@4.17.21

# Install from git
yarn add https://github.com/user/repo.git
```

### Remove Packages

```bash
yarn remove <package>
yarn remove lodash
```

### Update Packages

```bash
# Update specific package
yarn upgrade lodash

# Update to latest
yarn upgrade lodash@latest

# Update all packages
yarn upgrade
```

---

## Yarn 1 (Classic) Specific Commands

### Lock File

```bash
# Generate/update yarn.lock
yarn.lock
```

### Offline Mode

```bash
# Install from cache
yarn install --offline

# Add package to cache
yarn cache add lodash
```

### Workspaces

```bash
# Install all workspaces
yarn install

# Run script in all workspaces
yarn workspaces run build
```

### Scripts

```bash
# Run script from package.json
yarn run <script>
yarn run build

# List available scripts
yarn run
```

---

## Yarn 2/3/4 (Berry) Specific Commands

### Zero-Install

```bash
# Enable zero-install
yarn config set enableGlobalCache false

# Check zero-install status
yarn config get enableGlobalStore
```

### Yarn Plug'n'Play (PnP)

```bash
# Enable PnP
yarn set mode classic
# or
yarn set mode node-linker
```

### Workspace Commands

```bash
# Run command in workspace
yarn workspace my-app build

# Add to workspace
yarn workspace my-app add lodash
```

### Interactive Upgrade

```bash
# Interactive upgrade mode
yarn up

# Upgrade specific package
yarn up lodash

# Upgrade to latest
yarn up lodash@latest

# Upgrade all
yarn up -A
```

### Plugin Commands

```bash
# Add plugin
yarn plugin import workspace-tools

# List plugins
yarn plugin list
```

---

## Configuration

### .yarnrc.yml (Berry)

```yaml
# Enable node-modules plugin
enableGlobalCache: false

# Set default node version
nodeLinker: node-modules

# Enable zero-installs
enableZeroInstalls: true
```

### .yarnrc (Classic)

```bash
# Registry
yarn config set registry https://registry.npmjs.org

# Cache folder
yarn config set cache-folder /path/to/cache
```

---

## Common Options

### Global Installation

```bash
# Install global package
yarn global add <package>

# List global packages
yarn global list

# Find global package location
yarn global bin
```

### Verbose Output

```bash
# Verbose mode
yarn add lodash --verbose

# Debug mode
yarn add lodash --debug
```

### CI/Production

```bash
# Install production only
yarn install --production

# Ignore scripts
yarn install --ignore-scripts
```

---

## Troubleshooting

### Clear Cache

```bash
# Clear yarn cache
yarn cache clean

# Clean all caches
yarn cache cleanall
```

### Reset Project

```bash
# Remove node_modules and lock file
rm -rf node_modules yarn.lock
yarn install
```

### Diagnose Issues

```bash
# Check configuration
yarn config list

# Verbose logging
yarn add <package> --verbose
```

---

## Best Practices

1. **Use version control** - Commit yarn.lock to ensure reproducible builds
2. **Use workspaces** - For monorepos, use Yarn workspaces
3. **Keep Yarn updated** - Use the latest version for security and performance
4. **Use --save-exact** - For reproducible builds, use exact versions
5. **Check for vulnerabilities** - Run `yarn audit` regularly

---

## Migration from npm

### Convert package-lock.json

```bash
# Import npm lock file
yarn import
```

### Common Equivalents

| npm | Yarn |
|-----|------|
| npm install | yarn |
| npm install <pkg> | yarn add <pkg> |
| npm install -D <pkg> | yarn add -D <pkg> |
| npm install -g <pkg> | yarn global add <pkg> |
| npm uninstall <pkg> | yarn remove <pkg> |
| npm update | yarn upgrade |
| npm run | yarn |
| npm ci | yarn install --frozen-lockfile |

---

## Next Steps

- Explore [Yarn Documentation](https://yarnpkg.com/)
