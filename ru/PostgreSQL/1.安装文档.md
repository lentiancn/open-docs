# Руководство по установке PostgreSQL

PostgreSQL — мощная система управления объектно-реляционными базами данных с открытым исходным кодом. В этом руководстве описаны методы установки во всех средах.

## Информация о версиях

| Версия | Статус | Описание |
|--------|--------|----------|
| PostgreSQL 16.x | ✅ Текущая | Последняя стабильная версия |
| PostgreSQL 15.x | ✅ Поддерживаемая | Стабильная версия |
| PostgreSQL 14.x | ⚠️ Обслуживание | Обновления безопасности |
| PostgreSQL 13.x | ⚠️ Обслуживание | Долгосрочная поддержка |
| PostgreSQL 12.x | ❌ Устаревшая | Поддержка прекращена |

> **Важно**: Это руководство в первую очередь касается **PostgreSQL 16.x**. Для новых проектов рекомендуется использовать последнюю версию.

## Системные требования

### Аппаратные требования

| Требование | Минимум | Рекомендуется |
|------------|----------|---------------|
| CPU | 1 ядро | 2+ ядра |
| Оперативная память | 1 ГБ | 4+ ГБ |
| Диск | 10 ГБ | 50+ ГБ |

### Поддерживаемые операционные системы

- **Linux**: Ubuntu, Debian, CentOS, RHEL, Fedora, openSUSE
- **Windows**: Windows Server 2016+, Windows 10+
- **macOS**: 10.14+

## Способы установки

### Способ 1: Установка в Windows

#### 1. Использование установщика (рекомендуется)

1. Скачайте установщик PostgreSQL: https://www.postgresql.org/download/windows/
2. Запустите postgresql-16.x-x-windows-x64.exe
3. Следуйте инструкциям мастера установки
4. Установите пароль для суперпользователя postgres

#### 2. Использование Chocolatey

```powershell
# Установить PostgreSQL
choco install postgresql

# Установить конкретную версию
choco install postgresql --version=16.0
```

#### 3. Использование ZIP-архива

```powershell
# Скачать ZIP-архив
# Распаковать в C:\Program Files\PostgreSQL\16

# Инициализировать базу данных
"C:\Program Files\PostgreSQL\16\bin\initdb" -D "C:\Program Files\PostgreSQL\16\data"

# Запустить службу
"C:\Program Files\PostgreSQL\16\bin\pg_ctl" -D "C:\Program Files\PostgreSQL\16\data" -l logfile start
```

### Способ 2: Установка в macOS

#### 1. Использование Homebrew (рекомендуется)

```bash
# Установить PostgreSQL
brew install postgresql@16

# Запустить службу
brew services start postgresql@16

# Остановить службу
brew services stop postgresql@16
```

#### 2. Использование PostgreSQL.app

1. Скачайте PostgreSQL.app: https://postgresapp.com/
2. Перетащите в папку Applications
3. Нажмите для запуска

#### 3. Использование MacPorts

```bash
sudo port install postgresql16
sudo port load postgresql16-server
```

### Способ 3: Установка в Linux

#### Ubuntu/Debian

```bash
# Добавить официальный репозиторий PostgreSQL
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'

# Импортировать ключ
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

# Обновить список пакетов
sudo apt-get update

# Установить PostgreSQL
sudo apt-get install -y postgresql-16

# Запустить службу
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

#### CentOS/RHEL

```bash
# Установить RPM-репозиторий
sudo yum install -y https://download.postgresql.org/pub/repos/yum/16/redhat/rhel-9-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# Установить PostgreSQL
sudo yum install -y postgresql16-server

# Инициализировать базу данных
sudo /usr/pgsql-16/bin/postgresql-16-setup initdb

# Запустить службу
sudo systemctl start postgresql-16
sudo systemctl enable postgresql-16
```

#### Fedora

```bash
# Установить PostgreSQL
sudo dnf install -y postgresql-server postgresql-contrib

# Инициализировать базу данных
sudo postgresql-setup --initdb

# Запустить службу
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

### Способ 4: Установка через Docker

```bash
# Скачать образ
docker pull postgres:16

# Запустить контейнер
docker run -d \
  --name postgres \
  -e POSTGRES_PASSWORD=mysecretpassword \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_DB=mydb \
  -p 5432:5432 \
  -v postgres_data:/var/lib/postgresql/data \
  postgres:16
```

#### Docker Compose

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:16
    container_name: postgres
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: mysecretpassword
      POSTGRES_DB: mydb
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

Запуск:

```bash
docker-compose up -d
```

## Настройка после установки

### Подключение к PostgreSQL

```bash
# Использование psql
sudo -u postgres psql

# Или
psql -U postgres -h localhost -p 5432
```

### Создание базы данных

```sql
CREATE DATABASE mydb;

-- Создать пользователя
CREATE USER myuser WITH PASSWORD 'mypassword';

-- Предоставить права
GRANT ALL PRIVILEGES ON DATABASE mydb TO myuser;
```

### Файлы конфигурации

#### postgresql.conf

```properties
# Адрес прослушивания
listen_addresses = '*'

# Порт
port = 5432

# Максимальное количество подключений
max_connections = 100

# Общий буфер
shared_buffers = 128MB

# Рабочая память
work_mem = 4MB
```

#### pg_hba.conf

```properties
# Разрешить локальные подключения
host    all             all             127.0.0.1/32            trust
host    all             all             ::1/128                 trust

# Разрешить удаленные подключения
host    all             all             0.0.0.0/0              md5
host    all             all             ::/0                    md5
```

### Настройка удаленного подключения

```sql
-- Разрешить удаленные подключения
ALTER SYSTEM SET listen_addresses = '*';

-- Перезагрузить конфигурацию
SELECT pg_reload_conf();
```

## Часто задаваемые вопросы

### Подключение отклонено?

Проверьте брандмауэр:

```bash
# Ubuntu
sudo ufw allow 5432/tcp

# CentOS
sudo firewall-cmd --add-port=5432/tcp --permanent
sudo firewall-cmd --reload
```

### Забыли пароль postgres?

```bash
# Остановить PostgreSQL
sudo systemctl stop postgresql

# Запустить в режиме обхода
sudo -u postgres /usr/lib/postgresql/16/bin/pg_ctl -D /var/lib/postgresql/16/main -m fast stop

# Изменить пароль
sudo -u postgres psql -c "ALTER USER postgres PASSWORD 'newpassword';"
```

### База данных не запускается?

Проверьте журналы:

```bash
# Просмотр журналов
tail -f /var/log/postgresql/postgresql-16-main.log
```

## 相关链接

- [Официальный сайт PostgreSQL](https://www.postgresql.org/)
- [Документация PostgreSQL](https://www.postgresql.org/docs/)
- [Инструмент pgAdmin](https://www.pgadmin.org/)
