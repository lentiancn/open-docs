# Nginx - 简介

Nginx（发音为 "engine-x"）是一个高性能的 HTTP 服务器和反向代理服务器，由俄罗斯工程师 Igor Sysoev 于 2004 年开发。Nginx 以其高并发处理能力、低内存占用而闻名，是世界上最流行的 Web 服务器之一。

## Nginx 的核心特性

### 1. 高性能

Nginx 采用事件驱动的异步架构，能够处理大量并发连接：

```bash
# 性能对比（每秒请求数）
# Nginx: 50,000+
# Apache: 10,000-20,000
```

### 2. 反向代理

Nginx 强大的反向代理功能：

```nginx
server {
    listen 80;
    server_name example.com;
    
    location / {
        proxy_pass http://backend_server;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 3. 负载均衡

Nginx 内置负载均衡功能：

```nginx
upstream backend {
    server backend1.example.com;
    server backend2.example.com;
    server backend3.example.com;
}

server {
    location / {
        proxy_pass http://backend;
    }
}
```

### 4. 静态文件服务

高效处理静态文件：

```nginx
server {
    listen 80;
    server_name static.example.com;
    root /var/www/static;
    
    # 开启缓存
    expires 7d;
    add_header Cache-Control "public, no-transform";
    
    # 启用 gzip 压缩
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;
}
```

### 5. 虚拟主机

支持配置多个虚拟主机：

```nginx
# 虚拟主机 1
server {
    listen 80;
    server_name site1.com;
    root /var/www/site1;
}

# 虚拟主机 2
server {
    listen 80;
    server_name site2.com;
    root /var/www/site2;
}
```

## Nginx 的应用场景

### 1. Web 服务器

作为静态文件服务器：

```nginx
server {
    listen 80;
    server_name example.com;
    root /var/www/html;
    index index.html index.htm;
    
    location / {
        try_files $uri $uri/ =404;
    }
}
```

### 2. 反向代理

代理后端应用服务器：

```nginx
server {
    listen 80;
    server_name api.example.com;
    
    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### 3. 负载均衡器

分发流量到多台服务器：

```nginx
upstream myapp {
    least_conn;  # 最少连接数
    server app1.example.com:8080 weight=3;
    server app2.example.com:8080;
    server app3.example.com:8080 backup;
}

server {
    location / {
        proxy_pass http://myapp;
    }
}
```

### 4. SSL/TLS 终端

处理 HTTPS 加密：

```nginx
server {
    listen 443 ssl http2;
    server_name example.com;
    
    ssl_certificate /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;
    
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    location / {
        proxy_pass http://backend;
    }
}
```

### 5. API 网关

构建 API 网关：

```nginx
server {
    listen 80;
    server_name api.example.com;
    
    # 限流
    limit_req zone=api_limit burst=20 nodelay;
    
    # 路由
    location /api/v1/users {
        proxy_pass http://user_service;
    }
    
    location /api/v1/products {
        proxy_pass http://product_service;
    }
}
```

## Nginx 的版本历史

| 版本 | 发布年份 | 主要特性 |
|------|----------|----------|
| Nginx 0.1 | 2004 | 初始版本 |
| Nginx 0.7 | 2009 | 代理支持 |
| Nginx 1.0 | 2011 | 稳定版发布 |
| Nginx 1.8 | 2015 | 改进负载均衡 |
| Nginx 1.16 | 2019 | TLS 1.3 支持 |
| Nginx 1.20 | 2021 | HTTP/2 优化 |
| Nginx 1.24 | 2023 | 改进热更新 |

## Nginx 与其他服务器对比

### Nginx vs Apache

| 特性 | Nginx | Apache |
|------|-------|--------|
| 架构 | 事件驱动 | 进程/线程 |
| 内存占用 | 低 | 较高 |
| 并发能力 | 高 | 一般 |
| 静态文件 | 快 | 快 |
| 动态语言 | 需要插件 | 内置支持 |
| 配置风格 | 目录式 | .htaccess |

### Nginx vs IIS

| 特性 | Nginx | IIS |
|------|-------|-----|
| 跨平台 | 支持 | 仅 Windows |
| 性能 | 高 | 一般 |
| 配置 | 文本 | GUI/文本 |

## Nginx 的统计数据

- **市场份额**：全球约 30% 的网站
- **GitHub 星标**：12,000+ ⭐
- **企业用户**：Netflix、Airbnb、GitHub、WordPress 等

## 为什么选择 Nginx？

1. **高性能**：事件驱动架构，高并发处理能力强
2. **低内存占用**：资源利用率高
3. **配置简洁**：配置文件简洁易读
4. **功能丰富**：反向代理、负载均衡、缓存、SSL
5. **热更新**：支持不中断服务更新配置
6. **社区活跃**：丰富的模块和文档
7. **应用广泛**：Web 服务器、API 网关、微服务入口

## 相关资源

- 官方网站：https://nginx.org
- 中文文档：https://nginx.org/en/docs/
- 中文社区：https://www.nginx.cn

Nginx 是现代 Web 架构的核心组件，无论是作为静态服务器、反向代理还是负载均衡器，都能提供出色的性能。
