# Guía de Instalación de GitLab

> Guía completa para instalar y configurar GitLab

---

## Requisitos del Sistema

| Recurso | Mínimo | Recomendado |
|---------|--------|-------------|
| CPU | 2 núcleos | 4+ núcleos |
| Memoria | 4 GB | 8+ GB |
| Almacenamiento | 10 GB | 50+ GB |
| SO | Ubuntu, Debian, CentOS, RHEL, Kubernetes | - |

---

## Métodos de Instalación

### Paquete Omnibus (Linux Recomendado)

#### Ubuntu/Debian

```bash
# Instalar dependencias
sudo apt-get update
sudo apt-get install -y curl openssh-server ca-certificates tzdata perl

# Añadir repositorio GitLab
curl -fsSL https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.deb.sh | sudo bash

# Instalar GitLab
sudo EXTERNAL_URL="https://gitlab.example.com" apt-get install gitlab-ee
```

#### CentOS/RHEL

```bash
# Instalar dependencias
sudo yum install -y curl policycoreutils openssh-server

# Añadir repositorio GitLab
curl -fsSL https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash

# Instalar GitLab
sudo EXTERNAL_URL="https://gitlab.example.com" yum install -y gitlab-ee
```

### Instalación con Docker

```bash
# Descargar imagen Docker de GitLab
docker run --detach \
  --hostname gitlab.example.com \
  --publish 443:443 --publish 80:80 --publish 22:22 \
  --name gitlab \
  --restart always \
  --volume /srv/gitlab/config:/etc/gitlab \
  --volume /srv/gitlab/logs:/var/log/gitlab \
  --volume /srv/gitlab/data:/var/opt/gitlab \
  gitlab/gitlab-ee:latest
```

### Instalación en Kubernetes

```bash
# Usando Helm chart
helm repo add gitlab https://charts.gitlab.io
helm install gitlab gitlab/gitlab \
  --set externalUrl="https://gitlab.example.com" \
  --set certmanager-issuer.email="admin@example.com"
```

---

## Configuración Inicial

### Configurar URL Externa

```bash
# Editar archivo de configuración de GitLab
sudo vim /etc/gitlab/gitlab.rb

# Establecer URL externa
external_url 'https://gitlab.example.com'

# Reconfigurar GitLab
sudo gitlab-ctl reconfigure
```

### Configurar SMTP (Correo)

```bash
# Configurar SMTP en /etc/gitlab/gitlab.rb
gitlab_rails['smtp_enable'] = true
gitlab_rails['smtp_address'] = "smtp.example.com"
gitlab_rails['smtp_port'] = 587
gitlab_rails['smtp_user_name'] = "smtp_user"
gitlab_rails['smtp_password'] = "smtp_password"
gitlab_rails['smtp_domain'] = "example.com"

# Aplicar cambios
sudo gitlab-ctl reconfigure
```

### Habilitar HTTPS con Let's Encrypt

```bash
# En /etc/gitlab/gitlab.rb
letsencrypt['enable'] = true
letsencrypt['contact_emails'] = ['admin@example.com']

# Reconfigurar
sudo gitlab-ctl reconfigure
---

## Inicio de Sesión Inicial

1. Accede a GitLab en tu URL externa
2. Inicia sesión con el usuario: `root`
3. Establece una contraseña en tu primera visita
4. Crea tu primer proyecto

---

## Comandos Comunes

```bash
# Verificar estado
sudo gitlab-ctl status

# Iniciar servicios
sudo gitlab-ctl start

# Detener servicios
sudo gitlab-ctl stop

# Reiniciar servicios
sudo gitlab-ctl restart

# Ver registros
sudo gitlab-ctl tail

# Verificar configuración
sudo gitlab-rake gitlab:env:info
```

---

## Solución de Problemas

### ¿La instalación falla?

- Verificar requisitos del sistema
- Asegurarse de que todas las dependencias estén instaladas
- Revisar configuración de firewall y SELinux
- Revisar registros de instalación

### ¿GitLab no inicia?

```bash
# Verificar conflictos de puertos
sudo netstat -tulpn | grep -E ':(80|443|22)\s'

# Verificar espacio en disco
df -h

# Revisar registros
sudo gitlab-ctl tail
```

### ¿Rendimiento lento?

- Aumentar recursos del servidor
- Habilitar métricas de Prometheus
- Configurar espacio de intercambio adecuado
- Usar ajuste de PostgreSQL

---

## Recursos

- Documentación Oficial de Instalación: https://docs.gitlab.com/ee/install/
- Requisitos de Hardware: https://docs.gitlab.com/ee/install/requirements.html
- Foro de la Comunidad: https://forum.gitlab.com/
