# PyTorch Installation Guide

This guide provides detailed instructions for installing PyTorch on all major platforms.

---

## Table of Contents

- [Installation Methods](#installation-methods)
- [pip Installation](#pip-installation)
- [Conda Installation](#conda-installation)
- [Docker Installation](#docker-installation)
- [GPU Support (CUDA)](#gpu-support-cuda)
- [Verify Installation](#verify-installation)
- [System Requirements](#system-requirements)
- [Uninstall PyTorch](#uninstall-pytorch)

---

## Installation Methods

| Method | Description | Best For |
|--------|-------------|----------|
| **pip** | Python package manager | Most users |
| **Conda** | Anaconda package manager | Data science |
| **Docker** | Containerized runtime | Production |
| **Build from Source** | Compile manually | Custom optimizations |

---

## pip Installation

### Prerequisites

- Python 3.8 - 3.12
- pip >= 19.0

### Install PyTorch (CPU Only)

```bash
# Upgrade pip
pip install --upgrade pip

# Install PyTorch CPU version
pip install torch torchvision torchaudio
```

### Install Specific Version

```bash
# Install specific version
pip install torch==2.2.0 torchvision==0.17.0 torchaudio==2.2.0

# Install nightly version
pip install --pre torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/cpu
```

---

## Conda Installation

### Install Anaconda/Miniconda

```bash
# Download Miniconda
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash Miniconda3-latest-Linux-x86_64.sh
```

### Create Environment

```bash
# Create new conda environment
conda create -n pytorch python=3.11
conda activate pytorch

# Install PyTorch
conda install pytorch torchvision torchaudio cpuonly -c pytorch
conda install pytorch==2.2.0 torchvision==0.17.0 torchaudio==2.2.0 -c pytorch

# Install with CUDA 12.1
conda install pytorch torchvision torchaudio pytorch-cuda=12.1 -c pytorch -c nvidia
```

---

## Docker Installation

### Pull Image

```bash
# Pull latest PyTorch (CPU)
docker pull pytorch/pytorch:latest

# Pull with CUDA
docker pull pytorch/pytorch:latest-cuda12.1-cudnn8-runtime

# Pull Jupyter image
docker pull pytorch/pytorch:latest-jupyter
```

### Run Container

```bash
# Run CPU container
docker run -it --rm pytorch/pytorch:latest python

# Run with CUDA
docker run --gpus all -it --rm pytorch/pytorch:latest-cuda12.1-cudnn8-runtime python

# Run Jupyter
docker run -it -p 8888:8888 pytorch/pytorch:latest-jupyter
```

### Docker Compose

```yaml
# docker-compose.yml
version: '3.8'

services:
  pytorch:
    image: pytorch/pytorch:latest-jupyter
    ports:
      - "8888:8888"
    volumes:
      - ./notebooks:/workspace
    environment:
      - JUPYTER_ENABLE_LAB=yes
```

---

## GPU Support (CUDA)

### NVIDIA Requirements

| Component | Minimum | Recommended |
|-----------|---------|-------------|
| GPU | GTX 1050+ | RTX 3060+ |
| CUDA | 11.8 | 12.1+ |
| cuDNN | 8.x | 8.9+ |
| RAM | 8GB | 16GB+ |

### Install CUDA

```bash
# Download from NVIDIA website
# https://developer.nvidia.com/cuda-downloads

# Or use conda
conda install cuda-toolkit=12.1
```

### Verify GPU Installation

```python
import torch
print(f"CUDA available: {torch.cuda.is_available()}")
print(f"CUDA version: {torch.version.cuda}")
print(f"GPU count: {torch.cuda.device_count()}")
print(f"GPU name: {torch.cuda.get_device_name(0)}")
```

---

## Verify Installation

### Basic Test

```python
import torch

# Check version
print(f"PyTorch version: {torch.__version__}")

# Check CUDA
print(f"CUDA available: {torch.cuda.is_available()}")

# Simple tensor
x = torch.randn(3, 3)
print(f"Tensor:\n{x}")

# Matrix multiplication
a = torch.randn(3, 4)
b = torch.randn(4, 5)
c = torch.matmul(a, b)
print(f"Matrix multiplication result shape: {c.shape}")
```

### GPU Test

```python
import torch

# Check GPU
if torch.cuda.is_available():
    device = torch.device('cuda')
    print(f"Using GPU: {torch.cuda.get_device_name(0)}")
    
    # Move tensor to GPU
    x = torch.randn(1000, 1000).to(device)
    y = torch.randn(1000, 1000).to(device)
    z = torch.matmul(x, y)
    print(f"GPU computation successful!")
else:
    print("CUDA not available")
```

### Training Test

```python
import torch
import torch.nn as nn
import torch.optim as optim

# Simple neural network
class SimpleNet(nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = nn.Linear(10, 5)
        self.fc2 = nn.Linear(5, 2)
    
    def forward(self, x):
        x = torch.relu(self.fc1(x))
        x = self.fc2(x)
        return x

# Create model
model = SimpleNet()

# Sample data
x = torch.randn(100, 10)
y = torch.randint(0, 2, (100,))

# Training
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)

for epoch in range(10):
    optimizer.zero_grad()
    outputs = model(x)
    loss = criterion(outputs, y)
    loss.backward()
    optimizer.step()
    print(f"Epoch {epoch+1}, Loss: {loss.item():.4f}")

print("Training completed!")
```

---

## System Requirements

### CPU Requirements

| Requirement | Minimum | Recommended |
|-------------|---------|-------------|
| CPU | Intel/AMD x86_64 | Modern multi-core |
| RAM | 4GB | 8GB+ |
| Storage | 5GB | 10GB+ |

### GPU Requirements

| Component | Minimum | Recommended |
|-----------|---------|-------------|
| GPU | GTX 1050, 4GB VRAM | RTX 3060+, 8GB+ VRAM |
| CUDA | 11.8 | 12.1+ |

### Python Version Support

| PyTorch Version | Python Version |
|-----------------|----------------|
| 2.2.x | 3.8 - 3.11 |
| 2.1.x | 3.8 - 3.11 |
| 2.0.x | 3.8 - 3.11 |
| 1.13.x | 3.7 - 3.10 |

---

## Virtual Environments

### Using venv

```bash
# Create virtual environment
python -m venv pytorch-env

# Activate (Linux/macOS)
source pytorch-env/bin/activate

# Activate (Windows)
pytorch-env\Scripts\activate

# Install PyTorch
pip install torch torchvision torchaudio

# Deactivate
deactivate
```

---

## Uninstall PyTorch

### pip Uninstall

```bash
pip uninstall torch torchvision torchaudio
pip uninstall pytorch
```

### Conda Uninstall

```bash
conda remove pytorch torchvision torchaudio
conda remove -n pytorch pytorch torchvision torchaudio
conda env remove -n pytorch
```

### Docker Remove

```bash
docker rmi pytorch/pytorch
```

---

## Version Information

### Current Stable Version

- **PyTorch 2.2.0** (Latest stable)
- Python 3.8 - 3.11 support
- CUDA 11.8+ support

### Version History

| Version | Release Date | Key Features |
|---------|-------------|--------------|
| 2.2.x | 2024 | torch.compile, better GPU |
| 2.1.x | 2023 | DTensor, improved inference |
| 2.0.x | 2023 | torch.compile, attention |
| 1.13.x | 2022 | Better mobile support |

---

## Next Steps

- [Usage Guide](./2.使用指南.md)
- [PyTorch Official Documentation](https://pytorch.org/docs/)
- [PyTorch Tutorials](https://pytorch.org/tutorials/)
