# Docker User Manual

This manual covers Docker usage from basics to advanced topics.

---

## Table of Contents

1. [Basic Concepts](#basic-concepts)
2. [Docker Commands](#docker-commands)
3. [Working with Images](#working-with-images)
4. [Working with Containers](#working-with-containers)
5. [Networking](#networking)
6. [Data Management](#data-management)
7. [Dockerfile Guide](#dockerfile-guide)
8. [Docker Compose](#docker-compose)
9. [Best Practices](#best-practices)
10. [Troubleshooting](#troubleshooting)

---

## Basic Concepts

### Images

Images are read-only templates for creating containers.

```bash
# List local images
docker images

# Pull image
docker pull ubuntu:20.04

# Remove image
docker rmi ubuntu:20.04
```

### Containers

Containers are running instances of images.

```bash
# Run container
docker run ubuntu:20.04

# List containers
docker ps
docker ps -a

# Stop container
docker stop <container_id>
```

---

## Docker Commands

### Image Commands

```bash
docker images
docker pull nginx:latest
docker build -t myapp:1.0 .
docker rmi nginx:latest
docker image prune -a
```

### Container Commands

```bash
# Run container
docker run -it ubuntu /bin/bash
docker run -d nginx
docker run -p 8080:80 nginx
docker run -v /host:/container nginx

# List containers
docker ps
docker ps -a

# Start/Stop/Restart
docker start <container>
docker stop <container>
docker restart <container>

# Execute command
docker exec -it <container> /bin/bash

# View logs
docker logs <container>
docker logs -f <container>

# Remove container
docker rm <container>
```

### System Commands

```bash
docker info
docker system df
docker system prune -a
```

---

## Working with Images

### Pull Images

```bash
docker pull ubuntu
docker pull ubuntu:20.04
```

### Build Images

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
CMD ["node", "server.js"]
```

```bash
docker build -t myapp:1.0 .
```

### Multi-stage Build

```dockerfile
FROM node:18-alpine AS builder
WORKDIR /app
RUN npm install && npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
```

---

## Working with Containers

### Run Container

```bash
docker run -it ubuntu /bin/bash
docker run -d nginx
docker run -p 8080:80 -v /my/data:/data mysql
docker run -e MYSQL_ROOT_PASSWORD=secret mysql
```

### Container Lifecycle

```bash
docker create nginx
docker start <container>
docker stop <container>
docker restart <container>
docker pause <container>
docker unpause <container>
docker rm <container>
```

---

## Networking

### Port Mapping

```bash
docker run -p 8080:80 nginx
```

### Networks

```bash
docker network ls
docker network create mynetwork
docker network connect mynetwork <container>
```

---

## Data Management

### Volumes

```bash
docker volume create mydata
docker run -v mydata:/data mysql
docker run -v /host/path:/container/path nginx
```

---

## Dockerfile Guide

```dockerfile
FROM python:3.9-slim
LABEL maintainer="email@example.com"
ENV APP_ENV=production
WORKDIR /app
COPY requirements.txt ./
RUN pip install -r requirements.txt
COPY . .
EXPOSE 8000
CMD ["python", "app.py"]
```

### Best Practices

1. Use specific version tags
2. Use multi-stage builds
3. Use .dockerignore
4. Run as non-root user
5. Order instructions for caching

---

## Docker Compose

```yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "8080:80"
    depends_on:
      - db

  db:
    image: postgres:14
    volumes:
      - db-data:/var/lib/postgresql/data

volumes:
  db-data:
```

### Commands

```bash
docker-compose up
docker-compose up -d
docker-compose down
docker-compose logs -f
docker-compose build
```

---

## Best Practices

1. Use lightweight base images (alpine)
2. Use multi-stage builds
3. Don't run as root
4. Limit container resources
5. Use health checks

---

## Troubleshooting

### Container won't start

```bash
docker logs <container>
docker inspect <container>
```

### Network issues

```bash
docker network inspect bridge
docker exec <container> ping <another>
```

### Disk space

```bash
docker system prune -a
docker volume prune
```

---

## Resources

- Docker Docs: https://docs.docker.com/
- Docker Hub: https://hub.docker.com/
- Best Practices: https://docs.docker.com/develop/develop-images/dockerfile_best-practices/

---

*Last Updated: 2024*
