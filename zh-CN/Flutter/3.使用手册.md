# Flutter 使用手册

Flutter 核心概念和常用开发示例。

## 项目创建

### 创建新项目

```bash
# 创建新项目
flutter create my_app
cd my_app

# 运行项目
flutter run
```

### 项目结构

```
my_app/
├── lib/
│   └── main.dart        # 入口文件
├── test/                 # 测试文件
├── pubspec.yaml         # 配置文件
├── android/             # Android 配置
├── ios/                 # iOS 配置
├── web/                 # Web 配置
└── README.md
```

## 基础 Widget

### 文本组件

```dart
import 'package:flutter/material.dart';

Text(
  'Hello Flutter',
  style: TextStyle(
    fontSize: 24,
    color: Colors.blue,
  ),
)
```

### 按钮

```dart
// 普通按钮
ElevatedButton(
  onPressed: () {},
  child: Text('点击'),
)

// 图标按钮
IconButton(
  icon: Icon(Icons.add),
  onPressed: () {},
)

// 文本按钮
TextButton(
  onPressed: () {},
  child: Text('文本按钮'),
)
```

### 图片

```dart
// 本地图片
Image.asset('assets/image.png')

// 网络图片
Image.network('https://example.com/image.png')

// 图标
Icon(Icons.home, size: 48)
```

## 布局组件

### 线性布局

```dart
// 水平布局
Row(
  children: [
    Text('A'),
    Text('B'),
    Text('C'),
  ],
)

// 垂直布局
Column(
  children: [
    Text('A'),
    Text('B'),
    Text('C'),
  ],
)
```

### 弹性布局

```dart
// 灵活分配空间
Row(
  children: [
    Expanded(
      flex: 1,
      child: Container(color: Colors.red),
    ),
    Expanded(
      flex: 2,
      child: Container(color: Colors.blue),
    ),
  ],
)
```

### 堆叠布局

```dart
Stack(
  children: [
    Container(color: Colors.red),
    Positioned(
      left: 10,
      top: 10,
      child: Text('覆盖'),
    ),
  ],
)
```

## 状态管理

### StatefulWidget

```dart
class Counter extends StatefulWidget {
  @override
  _CounterState createState() => _CounterState();
}

class _CounterState extends State<Counter> {
  int _count = 0;

  void _increment() {
    setState(() {
      _count++;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        Text('计数: $_count'),
        ElevatedButton(
          onPressed: _increment,
          child: Text('增加'),
        ),
      ],
    );
  }
}
```

### Provider 状态管理

```dart
// 创建 Provider
class Counter extends ChangeNotifier {
  int _count = 0;
  int get count => _count;

  void increment() {
    _count++;
    notifyListeners();
  }
}

// 使用 Provider
Consumer<Counter>(
  builder: (context, counter, child) {
    return Text('${counter.count}');
  },
)
```

## 导航

### 基本导航

```dart
// 跳转到新页面
Navigator.push(
  context,
  MaterialPageRoute(builder: (context) => SecondScreen()),
);

// 返回
Navigator.pop(context);
```

### 路由配置

```dart
// 定义路由
MaterialApp(
  routes: {
    '/': (context) => HomePage(),
    '/detail': (context) => DetailPage(),
  },
)

// 跳转
Navigator.pushNamed(context, '/detail');
```

## 网络请求

### HTTP 请求

```dart
import 'package:http/http.dart' as http;

Future<void> fetchData() async {
  final response = await http.get(Uri.parse('https://api.example.com/data'));
  if (response.statusCode == 200) {
    print(response.body);
  }
}
```

### Dio 请求

```dart
import 'package:dio/dio.dart';

final dio = Dio();
Response response = await dio.get('https://api.example.com/data');
```

## 本地存储

### SharedPreferences

```dart
import 'package:shared_preferences/shared_preferences.dart';

// 保存
Future<void> saveData() async {
  final prefs = await SharedPreferences.getInstance();
  await prefs.setString('name', 'Flutter');
}

// 读取
Future<void> loadData() async {
  final prefs = await SharedPreferences.getInstance();
  String name = prefs.getString('name') ?? '';
}
```

## 常见组件

### 列表

```dart
ListView.builder(
  itemCount: items.length,
  itemBuilder: (context, index) {
    return ListTile(
      title: Text(items[index].title),
    );
  },
)
```

### 表单

```dart
TextFormField(
  decoration: InputDecoration(
    labelText: '用户名',
    hintText: '请输入用户名',
  ),
  validator: (value) {
    if (value.isEmpty) {
      return '请输入用户名';
    }
    return null;
  },
)
```

### 对话框

```dart
showDialog(
  context: context,
  builder: (context) => AlertDialog(
    title: Text('提示'),
    content: Text('确定要删除吗？'),
    actions: [
      TextButton(
        onPressed: () => Navigator.pop(context),
        child: Text('取消'),
      ),
      TextButton(
        onPressed: () => Navigator.pop(context),
        child: Text('确定'),
      ),
    ],
  ),
);
```

## 打包发布

### Android APK

```bash
# Debug 版本
flutter build apk --debug

# Release 版本
flutter build apk --release
```

### iOS

```bash
# 模拟器
flutter build ios --simulator --no-codesign

# 真机
flutter build ios --release
```

### Web

```bash
flutter build web
```

## 最佳实践

1. **使用 const**：减少不必要的重建
2. **提取 Widget**：复用 UI 代码
3. **合理布局**：使用合适的布局组件
4. **状态管理**：选择合适的状态管理方案
5. **错误处理**：做好异常捕获

## 后续学习

- 常见问题：参见 4.常见问题.md
