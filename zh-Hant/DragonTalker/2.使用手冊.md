# DragonTalker 使用手冊

> 詳細說明 DragonTalker 的功能使用方法和開發指南
> 
> 更新日期：2026年2月

---

## 一、功能概述

DragonTalker 是一款基於深度學習的說話頭像生成系統，其核心功能是將一張靜態人物圖像與一段音頻文件相結合，生成人物說話動作的動態影片。該技術基於先進的3D面部重建和圖像合成演算法，能夠保持原始人物的面部特徵，同時實現自然的唇形同步和表情變化。

### 1.1 支援的應用場景

- **虛擬主播**：為虛擬形象配置真實的聲音和表情
- **數字人客服**：生成擬人化的互動影片
- **教育培訓**：將課程內容以動態影片形式呈現
- **影視配音**：為角色快速生成配音動畫

---

## 二、快速開始

### 2.1 基本用法

```bash
# 啟動虛擬環境
source venv/bin/activate  # Linux/macOS
# 或
venv\Scripts\activate     # Windows

# 執行推理腳本
python inference.py \
  --source_image examples/source_image.jpg \
  --driven_audio examples/driven_audio.wav \
  --result_dir ./results
```

### 2.2 參數說明

| 參數 | 說明 | 預設值 |
|------|------|----------|
| --source_image | 輸入的源人物圖像路徑 | 必需 |
| --driven_audio | 輸入的驅動音頻路徑 | 必需 |
| --result_dir | 輸出影片保存目錄 | ./results |
| --enhancer | 面部增強演算法 | gfpgan |
| --outputfps | 輸出影片幀率 | 25 |

---

## 三、輸入輸出規格

### 3.1 源圖像要求

**檔案格式**：支援 JPG、PNG

**解析度要求**：
- 最低：256×256 像素
- 推薦：512×512 像素或更高

**圖像內容**：
- 人臉應占據畫面主體區域
- 推薦使用正面免冠照片
- 面部特徵清晰，無大面積遮擋
- 光照均勻

### 3.2 驅動音頻要求

**檔案格式**：支援 WAV、MP3

**音頻特性**：
- 取樣率：推薦 16kHz 或 44.1kHz
- 時長：1秒至60秒為宜
- 內容：清晰的人聲語音

### 3.3 輸出影片規格

| 參數 | 可選值 | 預設值 |
|------|--------|----------|
| 影片格式 | MP4 (H.264) | MP4 |
| 解析度 | 256×256, 512×512 | 256×256 |
| 幀率 | 25, 30, 60 | 25 |

---

## 四、Web 介面使用

DragonTalker 提供 Web 圖形介面，方便非技術使用者使用。

### 4.1 啟動 Web 服務

```bash
# 啟動 Web 服務，預設連接埠 7860
python app.py

# 指定連接埠
python app.py --port 8080
```

打開瀏覽器訪問 `http://localhost:7860`

---

## 五、Python API 使用

DragonTalker 提供完整的 Python API，支援程式化調用和二次開發。

### 5.1 基本調用流程

```python
from dragon_talker import DragonTalker

# 初始化模型
model = DragonTalker(
    device='cuda',
    faceid_weight=0.5,
    enhancer='gfpgan'
)

# 載入圖像和音頻
model.load_source('source.jpg')
model.load_audio('audio.wav')

# 生成影片
result_path = model.generate(
    output_path='result.mp4',
    preprocess='full',
    fps=25
)

print(f"影片已保存至: {result_path}")
```

---

## 六、常見問題解答

### 6.1 影片質量類

**問題：生成的面部模糊不清晰**

解決方案：啟用面部增強功能

```bash
python inference.py --enhancer gfpGAN ...
```

---

**問題：唇形與音頻不同步**

可能原因：音頻質量差或語速過快

解決方案：
1. 預處理音頻，提高取樣率
2. 使用更清晰的音頻源

---

## 七、相關資源

- 官方演示：https://huggingface.co/spaces/dragon-talker
- GitHub 倉庫：https://github.com/your-repo/DragonTalker
- 問題回報：https://github.com/your-repo/DragonTalker/issues
