# Mockito 使用手冊

詳細的 Mockito 使用指南。

## 基礎

### 建立模擬

```java
// 模擬介面
List<String> mockList = mock(List.class);

// 模擬類別
MyService myService = mock(MyService.class);
```

### Stubbing

```java
// 簡單的 Stubbing
when(mockList.get(0)).thenReturn("first");
when(mockList.size()).thenReturn(10);

// 拋出異常
when(mockList.get(0)).thenThrow(new IndexOutOfBoundsException());
```

### 驗證

```java
// 驗證方法是否被調用
verify(mockList).add("one");

// 驗證調用次數
verify(mockList, times(1)).add("one");
verify(mockList, never()).clear();
```

## 高級概念

### 參數匹配器

```java
// 任意參數
when(mockList.get(anyInt())).thenReturn("element");

// 特定匹配器
when(mockList.contains(argThat(s -> s.startsWith("test")))).thenReturn(true);
```

### Spy

```java
List<String> spyList = spy(new ArrayList<>());

// 部分真實行為
doReturn("real").when(spyList).get(0);
```

## 最佳實踐

1. **模擬介面** - 始終模擬介面，而不是具體類別
2. **不要使用真實物件** - 不要將真實物件轉換為模擬
3. **命名** - 為模擬使用有意義的名稱

## 常見場景

### 資料庫模擬

```java
@Mock
private UserRepository userRepository;

@Test
void testUserCreation() {
    User user = new User("test@test.com");
    when(userRepository.save(any(User.class))).thenReturn(user);
    
    User result = userService.createUser("test@test.com");
    
    assertNotNull(result);
    verify(userRepository).save(any(User.class));
}
```

## 資源

- 網站: https://site.mockito.org
- GitHub: https://github.com/mockito/mockito

## 許可證

MIT License
