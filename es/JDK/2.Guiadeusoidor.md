# Guía de uso de JDK

Esta guía cubre cómo usar JDK eficazmente para el desarrollo en Java.

## Comandos básicos

### Compilar Java

```bash
# Compilar un solo archivo
javac HelloWorld.java

# Compilar con classpath personalizado
javac -cp "lib/*" MyApp.java

# Compilar a un directorio específico
javac -d ./build MyApp.java

# Habilitar todas las advertencias
javac -Xlint:all MyApp.java
```

### Ejecutar Java

```bash
# Ejecutar clase compilada
java HelloWorld

# Ejecutar con classpath personalizado
java -cp "lib/*:." MyApp

# Ejecutar con más memoria
java -Xmx512m -Xms256m MyApp

# Ejecutar con propiedades del sistema
java -Dapp.name=MyApp -Denv=prod MyApp
```

### Comandos Jar

```bash
# Crear JAR
jar cf myapp.jar -C out .

# Crear JAR ejecutable
jar cfe myapp.jar com.example.Main -C out .

# Listar contenido del JAR
jar tf myapp.jar

# Extraer JAR
jar xf myapp.jar
```

## Opciones de JVM

### Opciones de memoria

```bash
# Tamaño del heap
-Xms256m          # Tamaño inicial del heap
-Xmx1024m         # Tamaño máximo del heap
-Xmn128m          # Tamaño de la generación joven

# Metaspace (Java 8+)
-XX:MetaspaceSize=128m
-XX:MaxMetaspaceSize=256m
```

### Recolección de basura

```bash
# G1GC (predeterminado desde Java 9)
-XX:+UseG1GC

# ZGC (baja latencia)
-XX:+UseZGC

# Parallel GC (rendimiento)
-XX:+UseParallelGC

# Registrar GC
-Xlog:gc*:file=gc.log
```

### Rendimiento

```bash
# Compilación JIT
-XX:+TieredCompilation

# Deduplicación de cadenas (Java 8u20+)
-XX:+UseStringDeduplication

# Compartir datos de clases
-Xshare:on
```

## Herramientas de compilación

### Maven

```bash
# Crear proyecto
mvn archetype:generate

# Compilar
mvn compile

# Ejecutar pruebas
mvn test

# Empaquetar
mvn package

# Ejecutar
mvn spring-boot:run
```

### Gradle

```bash
# Crear proyecto
gradle init

# Compilar
gradle compileJava

# Ejecutar pruebas
gradle test

# Construir
gradle build

# Ejecutar
gradle bootRun
```

## Sistema de módulos (Java 9+)

### Declaración de módulo

```java
// module-info.java
module com.example.myapp {
    requires com.example.utils;
    exports com.example.api;
}
```

### Ejecutar con módulos

```bash
# Listar módulos
java --list-modules

# Mostrar resolución de módulos
java --show-module-resolution

# Agregar ruta de módulos
java --module-path lib -m com.example.myapp
```

## Seguridad

### Comandos Keytool

```bash
# Generar keystore
keytool -genkeypair -alias myapp -keyalg RSA -keysize 2048 -validity 365 -keystore keystore.jks

# Listar certificados
keytool -list -keystore keystore.jks

# Exportar certificado
keytool -exportcert -alias myapp -file myapp.crt -keystore keystore.jks
```

### Política de seguridad

```bash
# Establecer política de seguridad
java -Djava.security.manager -Djava.security.policy=app.policy MyApp

# Deshabilitar administrador de seguridad (Java 17+)
java --add-opens java.base/java.lang=ALL-UNNAMED MyApp
```

## Herramientas de diagnóstico

### jcmd

```bash
# Listar procesos Java
jcmd -l

# Imprimir información de VM
jcmd <pid> VM.flags

# Imprimir propiedades del sistema
jcmd <pid> VM.system_properties
```

### jstack

```bash
# Imprimir volcado de hilos
jstack <pid>

# Imprimir volcado de hilos con bloqueos
jstack -l <pid>
```

### jmap / jhsdb

```bash
# Volcado de heap
jmap -dump:format=b,file=heap.bin <pid>

# Resumen de heap
jmap -heap <pid>

# Histograma de clases
jmap -histo <pid>
```

## Docker

### Dockerfile

```dockerfile
# Imagen de compilación
FROM eclipse-temurin:21-jdk-alpine AS build
WORKDIR /app
COPY . .
RUN ./mvnw package -DskipTests

# Imagen de ejecución
FROM eclipse-temurin:21-jre-alpine
WORKDIR /app
COPY --from=build /app/target/*.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
```

### Compilar y ejecutar

```bash
docker build -t myapp .
docker run -p 8080:8080 myapp
```

## Mejores prácticas

1. **Usar versiones LTS** - JDK 21 o JDK 17 para producción
2. **Establecer tamaño de heap apropiado** - Monitorear y ajustar según las necesidades de la aplicación
3. **Habilitar registro de GC** - Para solucionar problemas de rendimiento
4. **Usar JDK modular** - Reducir tamaño de imagen de contenedor con jlink
5. **Mantener actualizado** - Aplicar parches de seguridad regularmente

## Enlaces relacionados

- [Documentación oficial de Java](https://docs.oracle.com/en/java/javase/)
- [Referencia de opciones de JVM](https://docs.oracle.com/en/java/javase/21/tools/java.html)
- [Maven Central](https://maven.apache.org/)
- [Gradle](https://gradle.org/)
