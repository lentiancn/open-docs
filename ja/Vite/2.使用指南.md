# Vite 使用ガイド

このガイドでは、Viteを使用して最新のWebアプリケーションを構築する方法を説明します。

## クイックスタート

### プロジェクトの作成

```bash
npm create vite@latest my-app -- --template vue
cd my-app
npm install
npm run dev
```

### プロジェクト構造

```
my-app/
├── public/
│   └── favicon.ico
├── src/
│   ├── assets/
│   │   └── logo.png
│   ├── components/
│   │   └── HelloWorld.vue
│   ├── App.vue
│   ├── main.js
│   └── style.css
├── index.html
├── package.json
└── vite.config.js
```

### エントリーファイル

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import './style.css'

createApp(App).mount('#app')
```

```html
<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
```

## コアコンセプト

### ネイティブESM

ViteはブラウザのネイティブESモジュールサポートを活用し、バンドリングが不要です：

```javascript
// 直接モジュールをインポート
import { add } from './math.js'

console.log(add(2, 3))
```

### ホットモジュール置換

Viteは超高速なHMRを提供します：

```javascript
// モジュールは自動的に更新されます
import { hot } from 'vite/hmr'

if (hot) {
  hot.accept()
}
```

### オンデマンドコンパイル

Viteは実際に必要なファイルのみをコンパイルします：

```bash
# 初回起動時
VITE v4.0.0 ready in 300 ms

# ファイル変更時
VITE 4.0.0 hot updated in 1 ms
```

## 一般的な機能

### CSSのインポート

```javascript
import './style.css'
import './variables.scss'
```

### 画像のインポート

```javascript
import imgUrl from './img.png'

document.getElementById('app').innerHTML = `<img src="${imgUrl}">`
```

### JSONのインポート

```javascript
import data from './data.json'
console.log(data)
```

### 動的インポート

```javascript
const module = await import('./module.js')
module.default()
```

## Vueサポート

### Vueコンポーネント

```vue
<template>
  <button @click="count++">Count: {{ count }}</button>
</template>

<script setup>
import { ref } from 'vue'

const count = ref(0)
</script>
```

### Vueプラグイン

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],
})
```

## Reactサポート

### Reactコンポーネント

```jsx
import { useState } from 'react'

function App() {
  const [count, setCount] = useState(0)
  return <button onClick={() => setCount(count + 1)}>{count}</button>
}
```

### Reactプラグイン

```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
})
```

## 環境変数

### 変数の定義

```
# .env
VITE_APP_TITLE=My App
VITE_API_BASE_URL=https://api.example.com
```

### 変数の使用

```javascript
console.log(import.meta.env.VITE_APP_TITLE)
console.log(import.meta.env.VITE_API_BASE_URL)
```

### 環境別の変数

```
# .env.development
VITE_API_URL=http://localhost:3000

# .env.production
VITE_API_URL=https://api.example.com
```

## ビルドの最適化

### コード分割

```javascript
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router'],
        },
      },
    },
  },
})
```

### 圧縮

```javascript
export default defineConfig({
  build: {
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
      },
    },
  },
})
```

## よくある質問

### エイリアスを設定するには？

```javascript
import path from 'path'

export default defineConfig({
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
})
```

### 画像を処理するには？

```javascript
export default defineConfig({
  assetsInclude: ['**/*.hdr'],
})
```

### グローバル変数を使用するには？

```javascript
export default defineConfig({
  define: {
    __APP_VERSION__: JSON.stringify('1.0.0'),
  },
})
```

## 関連リソース

- [Vite 公式ドキュメント](https://vitejs.dev/)
- [Vite 日本語ドキュメント](https://ja.vitejs.dev/)
- [Vue 3 ドキュメント](https://vuejs.org/)
