# frp 安裝指南

frp 是一個高性能的反向代理工具，用於內網穿透。本指南涵蓋在各種環境中的安裝方法。

## 版本資訊

| 版本 | 狀態 | 說明 |
|------|------|------|
| frp 0.51.x | ✅ 目前 | 最新穩定版 |

## 系統要求

### 硬體要求

| 要求 | 配置 |
|------|------|
| CPU | 1+ 核心 |
| 記憶體 | 64+ MB |
| 磁碟 | 10+ MB |

### 軟體要求

| 軟體 | 版本 |
|------|------|
| Go | 1.18+ (原始碼編譯) |

## 安裝方法

### 方法一：Linux/macOS

#### 1. 下載

```bash
# 下載最新版本
wget https://github.com/fatedier/frp/releases/download/v0.51.0/frp_0.51.0_linux_amd64.tar.gz

# 解壓
tar -xzf frp_0.51.0_linux_amd64.tar.gz
cd frp_0.51.0_linux_amd64
```

#### 2. 目錄結構

```
frp_0.51.0_linux_amd64/
├── frpc          # 用戶端
├── frpc.ini      # 用戶端配置
├── frps          # 服務端
├── frps.ini      # 服務端配置
└── systemd/      # systemd 服務檔案
```

### 方法二：Windows

#### 1. 下載

1. 訪問 https://github.com/fatedier/frp/releases
2. 下載 Windows 版本
3. 解壓到指定目錄

#### 2. 執行

```powershell
# 服務端
.\frps.exe -c frps.ini

# 用戶端
.\frpc.exe -c frpc.ini
```

### 方法三：Docker

```bash
# 服務端
docker run --network host -d -v ./frps.ini:/etc/frp/frps.ini --name frps fatedier/frps:v0.51.0

# 用戶端
docker run -d -v ./frpc.ini:/etc/frp/frpc.ini --name frpc fatedier/frpc:v0.51.0
```

### 方法四：原始碼編譯

```bash
# 複製儲存庫
git clone https://github.com/fatedier/frp.git

# 編譯
cd frp
make

# 輸出在 bin/ 目錄
```

## 服務端配置

### 基礎配置 (frps.ini)

```ini
[common]
bind_port = 7000
dashboard_port = 7500
token = your_token_here
dashboard_user = admin
dashboard_pwd = admin

# 日誌
log_file = ./frps.log
log_level = info
```

### 進階配置

```ini
[common]
# 連接埠
bind_port = 7000
vhost_http_port = 80
vhost_https_port = 443

# 認證
token = your_token_here

# 連線池
max_pool_count = 5
max_ports_per_client = 0

# 心跳
heartbeat_timeout = 90

# 允許的用戶端連接埠
allow_ports = 2000-3000,3001,3003,4000-50000
```

### systemd 服務

```ini
# /etc/systemd/system/frps.service
[Unit]
Description=frp server
After=network.target

[Service]
Type=simple
User=root
ExecStart=/path/to/frps -c /path/to/frps.ini

[Install]
WantedBy=multi-user.target
```

```bash
# 啟動服務
sudo systemctl start frps
sudo systemctl enable frps
```

## 用戶端配置

### 基礎配置 (frpc.ini)

```ini
[common]
server_addr = your_server_ip
server_port = 7000
token = your_token_here

[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 6000
```

### HTTP 服務

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[web]
type = http
local_port = 8080
custom_domains = yourdomain.com
```

### TCP 連接埠映射

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[mysql]
type = tcp
local_ip = 127.0.0.1
local_port = 3306
remote_port = 13306
```

### STCP (安全 TCP)

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[secret_ssh]
type = stcp
sk = your_secret_key
local_ip = 127.0.0.1
local_port = 22
```

## 常見問題

### 連線失敗？

1. 檢查服務端是否執行中
2. 檢查防火牆連接埠
3. 驗證 token 是否匹配

### 連接埠被佔用？

修改 remote_port 或使用範圍連接埠。

### 效能問題？

調整連線池大小和逾時設定。

## 相關連結

- [frp GitHub](https://github.com/fatedier/frp)
- [frp 文件](https://gofrp.org/docs/)
