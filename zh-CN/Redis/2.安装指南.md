# Redis 安装指南

本指南将帮助你在各种操作系统上安装 Redis。

## 环境要求

| 软件 | 要求 |
|------|------|
| 操作系统 | Windows/macOS/Linux |
| 内存 | 最低 512MB，推荐 2GB+ |
| 磁盘 | 至少 1GB 可用空间 |

## Windows 安装

### 方法一：WSL（推荐）

在 Windows 上使用 WSL 运行 Redis：

```powershell
# 启用 WSL
wsl --install

# 在 Ubuntu 中安装 Redis
sudo apt update
sudo apt install redis-server
```

### 方法二：Redis Windows 移植版

微软维护的 Windows 移植版本：

1. 下载：https://github.com/tporadowski/redis/releases
2. 解压到目录
3. 运行 redis-server.exe

### 方法三：Docker

```powershell
# 运行 Redis 容器
docker run -d -p 6379:6379 --name myredis redis

# 连接 Redis
docker exec -it myredis redis-cli
```

## macOS 安装

### 方法一：Homebrew（推荐）

```bash
# 安装 Homebrew（如果未安装）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 Redis
brew install redis

# 启动 Redis
brew services start redis

# 或手动启动
redis-server

# 连接测试
redis-cli
```

### 方法二：Docker

```bash
docker run -d -p 6379:6379 --name myredis redis
docker exec -it myredis redis-cli
```

## Linux 安装

### Ubuntu/Debian

```bash
# 更新软件源
sudo apt update

# 安装 Redis
sudo apt install redis-server

# 启动服务
sudo systemctl start redis

# 设置开机自启
sudo systemctl enable redis

# 检查状态
sudo systemctl status redis
```

### CentOS/RHEL

```bash
# 添加 EPEL 仓库
sudo yum install epel-release

# 安装 Redis
sudo yum install redis

# 启动服务
sudo systemctl start redis

# 设置开机自启
sudo systemctl enable redis
```

### 源码编译安装

```bash
# 安装编译依赖
sudo apt install build-essential tcl

# 下载 Redis
wget https://github.com/redis/redis/archive/7.2.4.tar.gz
tar xzf 7.2.4.tar.gz
cd redis-7.2.4

# 编译
make

# 安装
sudo make install

# 启动
./src/redis-server
```

## 配置

### 配置文件位置

```bash
# Ubuntu/Debian
/etc/redis/redis.conf

# 源码编译
redis-7.2.4/redis.conf
```

### 常用配置

```conf
# 绑定地址
bind 127.0.0.1

# 端口
port 6379

# 密码认证
requirepass yourpassword

# 数据库数量
databases 16

# RDB 快照
save 900 1
save 300 10
save 60 10000

# AOF 持久化
appendonly yes
appendfsync everysec

# 最大内存
maxmemory 2gb

# 内存策略
maxmemory-policy allkeys-lru
```

### 远程连接配置

```conf
# 允许远程连接
bind 0.0.0.0

# 设置密码
requirepass yourpassword
```

## 验证安装

```bash
# 启动 Redis
redis-server

# 启动客户端
redis-cli

# 测试连接
PING

# 应返回 PONG
```

## 常用命令

```bash
# 启动 Redis
redis-server

# 启动并指定配置
redis-server /path/to/redis.conf

# 启动客户端
redis-cli

# 指定主机和端口
redis-cli -h 192.168.1.100 -p 6379

# 密码认证
redis-cli -a yourpassword

# 关闭 Redis
redis-cli shutdown

# 关闭并保存数据
redis-cli shutdown save

# 不保存关闭
redis-cli shutdown nosave
```

## Docker 部署

### 基本使用

```bash
# 运行 Redis
docker run -d -p 6379:6379 --name myredis redis

# 运行并持久化
docker run -d -p 6379:6379 -v /myredis/data:/data --name myredis redis redis-server --appendonly yes

# 使用自定义配置
docker run -d -p 6379:6379 -v /myredis/redis.conf:/usr/local/etc/redis/redis.conf --name myredis redis redis-server /usr/local/etc/redis/redis.conf
```

### Docker Compose

```yaml
# docker-compose.yml
version: '3.8'

services:
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
    command: redis-server --appendonly yes

volumes:
  redis-data:
```

```bash
# 启动
docker-compose up -d

# 停止
docker-compose down
```

## 客户端工具

### 命令行客户端

```bash
# 基本操作
redis-cli SET key value
redis-cli GET key
redis-cli KEYS "*"

# 批量操作
redis-cli MSET key1 value1 key2 value2
redis-cli MGET key1 key2
```

### GUI 工具

- **Redis Insight**：官方 GUI 工具
- **Another Redis Desktop Manager**：免费跨平台工具
- **Redis Commander**：Web 端工具

## 常见问题

### Q1: 启动失败

**解决方案：**
```bash
# 查看错误日志
tail -f /var/log/redis/redis.log

# 检查端口占用
netstat -tlnp | grep 6379

# 检查配置文件语法
redis-server --test-memory 4096
```

### Q2: 内存不足

**解决方案：**
在 redis.conf 中设置 maxmemory：
```conf
maxmemory 1gb
maxmemory-policy allkeys-lru
```

### Q3: 远程连接失败

**解决方案：**
1. 检查 bind 配置
2. 检查防火墙
3. 配置密码认证

## 下一步

- [Redis 使用手册](./3.使用手册.md) - 学习 Redis 数据操作
- [Redis 常见问题](./4.常见问题.md) - 解答常见问题
- 官方文档：https://redis.io/docs/
