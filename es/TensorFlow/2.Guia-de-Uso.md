# TensorFlow Guía de Uso

Esta guía proporciona información detallada sobre cómo usar TensorFlow para aprendizaje automático.

## Conceptos Básicos

### Tensores

```python
import tensorflow as tf

# Escalar
escalar = tf.constant(5)

# Vector
vector = tf.constant([1, 2, 3])

# Matriz
matriz = tf.constant([[1, 2], [3, 4]])

# Tensor 3D
tensor_3d = tf.constant([[[1, 2], [3, 4]], [[5, 6], [7, 8]]])
```

### Operaciones

```python
# Operaciones básicas
a = tf.constant([[1, 2], [3, 4]])
b = tf.constant([[5, 6], [7, 8]])

# Suma
c = tf.add(a, b)

# Multiplicación matricial
d = tf.matmul(a, b)
```

## Redes Neuronales con Keras

### Construir un Modelo

```python
from tensorflow import keras
from tensorflow.keras import layers

model = keras.Sequential([
    layers.Dense(128, activation='relu', input_shape=(784,)),
    layers.Dropout(0.2),
    layers.Dense(10, activation='softmax')
])
```

### Compilar Modelo

```python
model.compile(
    optimizer='adam',
    loss='sparse_categorical_crossentropy',
    metrics=['accuracy']
)
```

### Entrenar Modelo

```python
model.fit(x_train, y_train, epochs=5, validation_split=0.1)
```

### Evaluar

```python
test_loss, test_acc = model.evaluate(x_test, y_test)
print(f'Accuracy: {test_acc}')
```

### Predicciones

```python
predictions = model.predict(x_test)
```

## Capas Personalizadas

```python
class CapaPersonalizada(layers.Layer):
    def __init__(self, units, **kwargs):
        super().__init__(**kwargs)
        self.units = units
    
    def build(self, input_shape):
        self.kernel = self.add_weight(
            name='kernel',
            shape=(input_shape[-1], self.units),
            initializer='glorot_uniform',
            trainable=True
        )
    
    def call(self, inputs):
        return tf.matmul(inputs, self.kernel)
```

## Data Pipeline

### tf.data API

```python
# Crear dataset
dataset = tf.data.Dataset.from_tensor_slices((x_train, y_train))

# Shuffle
dataset = dataset.shuffle(buffer_size=10000)

# Batch
dataset = dataset.batch(32)

# Prefetch
dataset = dataset.prefetch(tf.data.AUTOTUNE)
```

### Aumentación de Datos

```python
data_augmentation = keras.Sequential([
    layers.RandomFlip("horizontal"),
    layers.RandomRotation(0.1),
    layers.RandomZoom(0.1),
])
```

## Callbacks

```python
# Early stopping
early_stop = keras.callbacks.EarlyStopping(
    monitor='val_loss',
    patience=5
)

# Model checkpoint
checkpoint = keras.callbacks.ModelCheckpoint(
    'best_model.keras',
    monitor='val_accuracy',
    save_best_only=True
)

# TensorBoard
tensorboard = keras.callbacks.TensorBoard(
    log_dir='./logs'
)

# Entrenar con callbacks
model.fit(x_train, y_train, 
          epochs=10, 
          callbacks=[early_stop, checkpoint, tensorboard])
```

## Guardar y Cargar Modelos

### Guardar Modelo Completo

```python
model.save('mi_modelo.keras')
model = keras.models.load_model('mi_modelo.keras')
```

### Guardar Pesos

```python
model.save_weights('mis_pesos.weights.h5')
model.load_weights('mis_pesos.weights.h5')
```

### SavedModel

```python
# Exportar
model.export('mi_modelo/')

# Cargar
loaded = keras.models.load_model('mi_modelo/')
```

## Transfer Learning

```python
# Usar modelo pre-entrenado
base_model = keras.applications.VGG16(
    weights='imagenet',
    include_top=False,
    input_shape=(224, 224, 3)
)

# Congelar capas base
base_model.trainable = False

# Agregar nuevas capas
model = keras.Sequential([
    base_model,
    layers.GlobalAveragePooling2D(),
    layers.Dense(10)
])
```

## Mejores Prácticas

1. Usa Keras para la mayoría de tareas de deep learning
2. Habilita GPU cuando esté disponible
3. Usa TensorBoard para visualización
4. Guarda checkpoints durante entrenamiento
5. Usa augmentación de datos
6. Implementa validación apropiada
