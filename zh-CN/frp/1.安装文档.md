# frp 安装指南

frp 是一个高性能的反向代理工具，用于内网穿透。本指南涵盖在各种环境中的安装方法。

## 版本信息

| 版本 | 状态 | 说明 |
|------|------|------|
| frp 0.51.x | ✅ 当前 | 最新稳定版 |

## 系统要求

### 硬件要求

| 要求 | 配置 |
|------|------|
| CPU | 1+ 核 |
| 内存 | 64+ MB |
| 磁盘 | 10+ MB |

### 软件要求

| 软件 | 版本 |
|------|------|
| Go | 1.18+ (源码编译) |

## 安装方法

### 方法一：Linux/macOS

#### 1. 下载

```bash
# 下载最新版本
wget https://github.com/fatedier/frp/releases/download/v0.51.0/frp_0.51.0_linux_amd64.tar.gz

# 解压
tar -xzf frp_0.51.0_linux_amd64.tar.gz
cd frp_0.51.0_linux_amd64
```

#### 2. 目录结构

```
frp_0.51.0_linux_amd64/
├── frpc          # 客户端
├── frpc.ini      # 客户端配置
├── frps          # 服务端
├── frps.ini      # 服务端配置
└── systemd/      # systemd 服务文件
```

### 方法二：Windows

#### 1. 下载

1. 访问 https://github.com/fatedier/frp/releases
2. 下载 Windows 版本
3. 解压到指定目录

#### 2. 运行

```powershell
# 服务端
.\frps.exe -c frps.ini

# 客户端
.\frpc.exe -c frpc.ini
```

### 方法三：Docker

```bash
# 服务端
docker run --network host -d -v ./frps.ini:/etc/frp/frps.ini --name frps fatedier/frps:v0.51.0

# 客户端
docker run -d -v ./frpc.ini:/etc/frp/frpc.ini --name frpc fatedier/frpc:v0.51.0
```

### 方法四：源码编译

```bash
# 克隆仓库
git clone https://github.com/fatedier/frp.git

# 编译
cd frp
make

# 输出在 bin/ 目录
```

## 服务端配置

### 基础配置 (frps.ini)

```ini
[common]
bind_port = 7000
dashboard_port = 7500
token = your_token_here
dashboard_user = admin
dashboard_pwd = admin

# 日志
log_file = ./frps.log
log_level = info
```

### 高级配置

```ini
[common]
# 端口
bind_port = 7000
vhost_http_port = 80
vhost_https_port = 443

# 认证
token = your_token_here

# 连接池
max_pool_count = 5
max_ports_per_client = 0

# 心跳
heartbeat_timeout = 90

# 允许的客户端端口
allow_ports = 2000-3000,3001,3003,4000-50000
```

### systemd 服务

```ini
# /etc/systemd/system/frps.service
[Unit]
Description=frp server
After=network.target

[Service]
Type=simple
User=root
ExecStart=/path/to/frps -c /path/to/frps.ini

[Install]
WantedBy=multi-user.target
```

```bash
# 启动服务
sudo systemctl start frps
sudo systemctl enable frps
```

## 客户端配置

### 基础配置 (frpc.ini)

```ini
[common]
server_addr = your_server_ip
server_port = 7000
token = your_token_here

[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 6000
```

### HTTP 服务

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[web]
type = http
local_port = 8080
custom_domains = yourdomain.com
```

### TCP 端口映射

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[mysql]
type = tcp
local_ip = 127.0.0.1
local_port = 3306
remote_port = 13306
```

### STCP (安全 TCP)

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[secret_ssh]
type = stcp
sk = your_secret_key
local_ip = 127.0.0.1
local_port = 22
```

## 常见问题

### 连接失败？

1. 检查服务端是否运行
2. 检查防火墙端口
3. 验证 token 是否匹配

### 端口被占用？

修改 remote_port 或使用范围端口。

### 性能问题？

调整连接池大小和超时设置。

## 相关链接

- [frp GitHub](https://github.com/fatedier/frp)
- [frp 文档](https://gofrp.org/docs/)
