# Vue.js 使用手册

本手册介绍 Vue.js 的核心概念和实际使用方法。

## 基础语法

### 模板语法

```vue
<template>
  <!-- 文本插值 -->
  <h1>{{ title }}</h1>
  
  <!-- HTML 渲染 -->
  <div v-html="htmlContent"></div>
  
  <!-- 属性绑定 -->
  <img :src="imageUrl" :alt="imageAlt">
  
  <!-- 事件绑定 -->
  <button @click="handleClick">点击</button>
  
  <!-- 条件渲染 -->
  <div v-if="isShow">显示</div>
  <div v-else>隐藏</div>
  
  <!-- 列表渲染 -->
  <ul>
    <li v-for="item in items" :key="item.id">
      {{ item.name }}
    </li>
  </ul>
  
  <!-- 双向绑定 -->
  <input v-model="username">
  <textarea v-model="content"></textarea>
  <select v-model="selected">
    <option value="a">A</option>
    <option value="b">B</option>
  </select>
</template>

<script setup>
import { ref, reactive } from 'vue'

// 响应式状态
const title = ref('Hello Vue')
const htmlContent = ref('<strong>粗体</strong>')
const imageUrl = ref('/logo.png')
const imageAlt = ref('图片')
const isShow = ref(true)
const username = ref('')
const content = ref('')
const selected = ref('a')

// 数组
const items = ref([
  { id: 1, name: '苹果' },
  { id: 2, name: '香蕉' },
  { id: 3, name: '橙子' }
])

// 方法
function handleClick() {
  console.log('点击了')
}
</script>

<style scoped>
h1 {
  color: #42b883;
}
</style>
```

## 组件开发

### 定义组件

```vue
<!-- MyButton.vue -->
<template>
  <button 
    :class="['btn', `btn-${type}`]"
    :disabled="disabled"
    @click="handleClick"
  >
    <slot></slot>
  </button>
</template>

<script setup>
defineProps({
  type: {
    type: String,
    default: 'primary'
  },
  disabled: {
    type: Boolean,
    default: false
  }
})

const emit = defineEmits(['click'])

function handleClick(event) {
  emit('click', event)
}
</script>

<style scoped>
.btn {
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
.btn-primary {
  background: #42b883;
  color: white;
}
.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
</style>
```

### 使用组件

```vue
<template>
  <MyButton type="primary" @click="handleClick">
    提交
  </MyButton>
</template>

<script setup>
import MyButton from './components/MyButton.vue'

function handleClick() {
  console.log('提交')
}
</script>
```

### Props 验证

```javascript
defineProps({
  // 基础类型
  title: String,
  count: Number,
  isActive: Boolean,
  
  // 多个类型
  value: [String, Number],
  
  // 带默认值
  size: {
    type: String,
    default: 'medium'
  },
  
  // 必填
  id: {
    type: Number,
    required: true
  },
  
  // 自定义验证
  age: {
    type: Number,
    validator(value) {
      return value >= 0
    }
  },
  
  // 对象默认值
  user: {
    type: Object,
    default() {
      return { name: 'Tom' }
    }
  }
})
```

## 响应式系统

### ref 和 reactive

```javascript
import { ref, reactive, readonly, isRef, isReactive } from 'vue'

// ref - 基础类型
const count = ref(0)
const name = ref('Tom')

// 访问值
count.value++

// reactive - 对象
const state = reactive({
  user: { name: 'Tom' },
  items: [1, 2, 3]
})

state.user.name = 'Jerry'

// readonly - 只读
const original = reactive({ a: 1 })
const copy = readonly(original)

// 响应式判断
console.log(isRef(count))      // true
console.log(isReactive(state)) // true
```

### computed

```javascript
import { ref, computed } from 'vue'

const firstName = ref('Tom')
const lastName = ref('Jerry')

// 计算属性
const fullName = computed(() => {
  return firstName.value + ' ' + lastName.value
})

// getter 和 setter
const count = ref(0)
const doubled = computed({
  get() {
    return count.value * 2
  },
  set(val) {
    count.value = val / 2
  }
})
```

### watch

```javascript
import { ref, watch, watchEffect } from 'vue'

const count = ref(0)
const user = ref({ name: 'Tom' })

// 监听单个 ref
watch(count, (newVal, oldVal) => {
  console.log(`count 从 ${oldVal} 变为 ${newVal}`)
})

// 监听对象
watch(user, (newVal, oldVal) => {
  console.log('user 变化了')
}, { deep: true })

// 监听多个源
watch([count, user], ([newCount, newUser], [oldCount, oldUser]) => {
  console.log('变化了')
})

// watchEffect - 自动收集依赖
watchEffect(() => {
  console.log('count:', count.value)
})
```

## 生命周期

### 组件生命周期

```vue
<script setup>
import { onMounted, onUpdated, onUnmounted } from 'vue'

// 组件挂载后
onMounted(() => {
  console.log('组件挂载完成')
})

// 组件更新后
onUpdated(() => {
  console.log('组件更新完成')
})

// 组件销毁前
onUnmounted(() => {
  console.log('组件销毁')
})
</script>
```

### 完整生命周期

| 钩子 | 说明 |
|------|------|
| onMounted | 挂载后 |
| onUpdated | 更新后 |
| onUnmounted | 卸载后 |
| onBeforeMount | 挂载前 |
| onBeforeUpdate | 更新前 |
| onBeforeUnmount | 卸载前 |
| onErrorCaptured | 错误捕获 |
| onRenderTracked | 渲染追踪 |
| onRenderTriggered | 渲染触发 |

## 路由使用

### 基本配置

```javascript
// router/index.js
import { createRouter, createWebHistory } from 'vue-router'
import Home from '../views/Home.vue'
import About from '../views/About.vue'

const routes = [
  { path: '/', name: 'Home', component: Home },
  { path: '/about', name: 'About', component: About },
  { path: '/user/:id', name: 'User', component: User }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

export default router
```

### 路由导航

```vue
<template>
  <!-- 声明式导航 -->
  <router-link to="/">首页</router-link>
  <router-link :to="{ name: 'User', params: { id: 1 }}">用户</router-link>
  
  <!-- 编程式导航 -->
  <button @click="goHome">首页</button>
  <button @click="goUser(1)">用户</button>
  <button @click="goBack">返回</button>
</template>

<script setup>
import { useRouter } from 'vue-router'

const router = useRouter()

function goHome() {
  router.push('/')
}

function goUser(id) {
  router.push({ name: 'User', params: { id } })
}

function goBack() {
  router.back()
}
</script>
```

### 路由守卫

```javascript
// 全局守卫
router.beforeEach((to, from, next) => {
  // 检查登录
  const isLoggedIn = localStorage.getItem('token')
  
  if (to.meta.requiresAuth && !isLoggedIn) {
    next('/login')
  } else {
    next()
  }
})
```

## 状态管理（Pinia）

### 创建 Store

```javascript
// stores/user.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

export const useUserStore = defineStore('user', () => {
  // 状态
  const name = ref('Tom')
  const age = ref(25)
  
  // 计算属性
  const isAdult = computed(() => age.value >= 18)
  
  // 方法
  function setName(newName) {
    name.value = newName
  }
  
  function incrementAge() {
    age.value++
  }
  
  return {
    name,
    age,
    isAdult,
    setName,
    incrementAge
  }
})
```

### 使用 Store

```vue
<script setup>
import { useUserStore } from '../stores/user'

const userStore = useUserStore()

// 访问状态
console.log(userStore.name)

// 修改状态
userStore.setName('Jerry')
userStore.incrementAge()
</script>

<template>
  <div>
    <p>姓名: {{ userStore.name }}</p>
    <p>年龄: {{ userStore.age }}</p>
    <p>成年: {{ userStore.isAdult ? '是' : '否' }}</p>
  </div>
</template>
```

## HTTP 请求

### 使用 axios

```javascript
import axios from 'axios'

const api = axios.create({
  baseURL: '/api',
  timeout: 5000
})

// 请求拦截器
api.interceptors.request.use(
  config => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  error => Promise.reject(error)
)

// 响应拦截器
api.interceptors.response.use(
  response => response.data,
  error => {
    if (error.response?.status === 401) {
      // 处理未授权
    }
    return Promise.reject(error)
  }
)

// 使用
const { data } = await api.get('/users')
const { data } = await api.post('/users', { name: 'Tom' })
```

### 组件中使用

```vue
<script setup>
import { ref, onMounted } from 'vue'
import api from '../api'

const users = ref([])
const loading = ref(false)

async function fetchUsers() {
  loading.value = true
  try {
    users.value = await api.get('/users')
  } catch (error) {
    console.error(error)
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  fetchUsers()
})
</script>

<template>
  <div>
    <div v-if="loading">加载中...</div>
    <ul v-else>
      <li v-for="user in users" :key="user.id">
        {{ user.name }}
      </li>
    </ul>
  </div>
</template>
```

## 表单处理

### 基本表单

```vue
<template>
  <form @submit.prevent="handleSubmit">
    <div>
      <label>用户名</label>
      <input v-model="form.username" type="text">
    </div>
    
    <div>
      <label>邮箱</label>
      <input v-model="form.email" type="email">
    </div>
    
    <div>
      <label>简介</label>
      <textarea v-model="form.bio"></textarea>
    </div>
    
    <div>
      <label>
        <input v-model="form.agree" type="checkbox">
        同意协议
      </label>
    </div>
    
    <button type="submit">提交</button>
  </form>
</template>

<script setup>
import { reactive } from 'vue'

const form = reactive({
  username: '',
  email: '',
  bio: '',
  agree: false
})

function handleSubmit() {
  console.log('提交:', form)
}
</script>
```

## 组件通信

### 父子组件通信

```vue
<!-- 父组件 -->
<template>
  <Child 
    :title="title"
    @update="handleUpdate"
  />
</template>

<script setup>
import { ref } from 'vue'
import Child from './Child.vue'

const title = ref('Hello')

function handleUpdate(value) {
  console.log('收到:', value)
}
</script>

<!-- 子组件 -->
<script setup>
defineProps(['title'])
const emit = defineEmits(['update'])

function send() {
  emit('update', 'new value')
}
</script>
```

### 依赖注入

```vue
<!-- 父组件 -->
<script setup>
import { provide } from 'vue'

provide('message', 'Hello')
</script>

<!-- 子组件 -->
<script setup>
import { inject } from 'vue'

const message = inject('message')
</script>
```

## 总结

本手册涵盖了 Vue.js 开发的核心知识点：

- **模板语法**：插值、指令、条件渲染、列表渲染
- **组件开发**：定义、使用、Props、事件
- **响应式**：ref、reactive、computed、watch
- **生命周期**：挂载、更新、卸载
- **路由**：配置、导航、守卫
- **状态管理**：Pinia 创建和使用
- **HTTP**：axios 配置和请求
- **表单**：v-model 和表单提交
- **通信**：父子组件、依赖注入

掌握这些内容后，你就可以开始 Vue.js 项目开发了。
