# JMeter 使用指南

本指南介绍如何使用 JMeter 进行性能测试。

## 快速开始

### 创建测试计划

1. 打开 JMeter
2. 创建测试计划
3. 添加线程组
4. 添加采样器
5. 添加监听器
6. 运行测试

## 线程组

### 配置线程组

```
线程数：10
 Ramp-Up 时间：5秒
 循环次数：1
```

### 线程属性

- 线程数：并发用户数
- Ramp-Up 时间：启动时间
- 循环次数：每个用户执行次数

## 采样器

### HTTP 请求

```
协议：http
服务器名称：www.example.com
路径：/api/users
方法：GET
```

### 参数

- 查询参数
- POST/GET 参数
- 文件上传

## 监听器

### 查看结果树

```markdown
- 查看请求和响应
- 调试测试脚本
```

### 聚合报告

```markdown
- 平均响应时间
- 中位数
- 90% 百分位
- 吞吐量
```

### 图形结果

```markdown
- 可视化响应时间
- 实时监控
```

## 控制器

### 逻辑控制器

- 如果控制器
- 循环控制器
- 随机控制器
- 事务控制器

### 控制器使用

```bash
# 循环 5 次
Loop Controller: 5

# 随机选择
Random Controller
```

## 断言

### 响应断言

```bash
# 检查响应包含
Response Assertion
Pattern: "success"

# 检查响应码
Response Code: 200
```

### JSON 断言

```bash
# 检查 JSON 值
JSON Path: $.status
Expected Value: success
```

## 参数化

### CSV 数据文件

```bash
# 创建 CSV 文件
username,password
user1,pass1
user2,pass2
```

### 配置

```
CSV Data Set Config
Filename: users.csv
Variable Names: username,password
```

### 函数

- __Random
- __time
- __counter

## 相关性

### 正则表达式提取

```
正则表达式：token="(.+?)"
模板：$1$
匹配数字：1
```

### JSON 提取

```
JSON Path: $.data.token
```

## 分布式测试

### 配置主从

```bash
# 从机配置
remote_hosts=192.168.1.2,192.168.1.3

# 启动
jmeter -R 192.168.1.2
```

### 运行

```bash
# 分布式运行
jmeter -n -t test.jmx -R server1,server2
```

## 命令行运行

### 基本命令

```bash
# 运行测试
jmeter -n -t test.jmx -l result.jtl

# 生成报告
jmeter -g result.jtl -o report
```

### 参数

```bash
-n 非 GUI 模式
-t 测试计划文件
-l 结果文件
-r 分布式运行
```

## 性能优化

### 1. 使用断言

```bash
# 只添加必要断言
Response Assertion
```

### 2. 监听器优化

```bash
# 生产环境减少监听器
# 使用 Simple Data Writer
```

### 3. 预热

```bash
# 先预热再正式测试
```

## 报告生成

### HTML 报告

```bash
jmeter -g result.jtl -o /path/to/report
```

### Dashboard

```bash
# 完整报告
jmeter -n -t test.jmx -l result.jtl -e -o report
```

## 最佳实践

### 1. 测试设计

```bash
# 真实模拟用户行为
# 参数化测试数据
```

### 2. 结果分析

```bash
# 关注响应时间
# 分析错误率
```

## 相关资源

- [JMeter 官方文档](https://jmeter.apache.org/usermanual/)
- [JMeter 插件](https://jmeter-plugins.org/)
