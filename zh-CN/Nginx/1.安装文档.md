# Nginx 安装文档

在所有主流平台上安装 Nginx 的完整指南。

---

## 目录

- [Linux](#linux)
  - [Ubuntu/Debian](#ubuntudebian)
  - [CentOS/RHEL](#centosrhel)
  - [Fedora](#fedora)
  - [Arch Linux](#arch-linux)
  - [openSUSE](#opensuse)
- [macOS](#macos)
  - [Homebrew](#homebrew)
  - [MacPorts](#macports)
  - [源码编译](#源码编译)
- [Windows](#windows)
  - [二进制包](#二进制包)
  - [Docker](#docker)
- [FreeBSD](#freebsd)
- [验证安装](#验证安装)
- [配置](#配置)
- [卸载](#卸载)

---

## Linux

### Ubuntu / Debian

#### 方法一：APT（推荐）

```bash
# 更新软件包索引
sudo apt update

# 安装 Nginx
sudo apt install nginx

# 启动 Nginx
sudo systemctl start nginx

# 开机自启
sudo systemctl enable nginx
```

#### 方法二：源码编译

```bash
# 安装依赖
sudo apt install build-essential libpcre3 libpcre3-dev zlib1g-dev libssl-dev

# 下载 Nginx
cd /tmp
wget http://nginx.org/download/nginx-1.24.0.tar.gz
tar -zxvf nginx-1.24.0.tar.gz
cd nginx-1.24.0

# 编译安装
./configure --prefix=/usr/local/nginx --with-http_ssl_module
make
sudo make install
```

### CentOS / RHEL

#### 使用 YUM

```bash
# 安装 EPEL 仓库
sudo yum install epel-release

# 安装 Nginx
sudo yum install nginx

# 启动 Nginx
sudo systemctl start nginx

# 开机自启
sudo systemctl enable nginx
```

#### 使用 DNF

```bash
sudo dnf install nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

### Fedora

```bash
# 安装 Nginx
sudo dnf install nginx

# 启动 Nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

### Arch Linux

```bash
# 安装 Nginx
sudo pacman -S nginx

# 启动 Nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

### openSUSE

```bash
sudo zypper install nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

---

## macOS

### Homebrew（推荐）

```bash
# 安装 Homebrew（如需要）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 Nginx
brew install nginx

# 启动 Nginx
brew services start nginx

# 或手动运行
nginx
```

### MacPorts

```bash
sudo port install nginx
sudo port load nginx
```

### 源码编译

```bash
# 安装依赖
brew install pcre openssl

# 下载并编译
cd /tmp
curl -O http://nginx.org/download/nginx-1.24.0.tar.gz
tar -zxvf nginx-1.24.0.tar.gz
cd nginx-1.24.0

./configure --prefix=/usr/local/nginx --with-http_ssl_module
make
sudo make install
```

---

## Windows

### 二进制包

1. 从 [nginx.org](http://nginx.org/en/download.html) 下载
2. 选择 `nginx-x.x.x.zip`
3. 解压到 `C:\nginx`

#### 命令

```powershell
# 启动 Nginx
cd C:\nginx
start nginx

# 停止 Nginx
nginx -s stop

# 重新加载配置
nginx -s reload

# 查看版本
nginx -v
```

### Docker

```bash
# 运行 Nginx 容器
docker run -d -p 80:80 --name nginx nginx:latest

# 自定义配置
docker run -d -p 80:80 -v /path/to/nginx.conf:/etc/nginx/nginx.conf --name nginx nginx:latest

# 带 HTML 文件
docker run -d -p 80:80 -v /path/to/html:/usr/share/nginx/html --name nginx nginx:latest
```

---

## FreeBSD

```bash
# 通过 pkg 安装
sudo pkg install nginx

# 或通过 ports
cd /usr/ports/www/nginx
sudo make install

# 启动 Nginx
sudo sysrc nginx_enable=yes
sudo service nginx start
```

---

## 验证安装

```bash
# 检查 Nginx 版本
nginx -v

# 检查配置语法
nginx -t

# 检查 Nginx 状态
sudo systemctl status nginx

# 测试访问
curl http://localhost

# 检查监听端口
sudo netstat -tulpn | grep nginx
```

---

## 配置

### 主配置文件位置

| 操作系统 | 路径 |
|---------|------|
| Ubuntu/Debian | `/etc/nginx/nginx.conf` |
| CentOS/RHEL | `/etc/nginx/nginx.conf` |
| Fedora | `/etc/nginx/nginx.conf` |
| Arch Linux | `/etc/nginx/nginx.conf` |
| macOS (Homebrew) | `/usr/local/etc/nginx/nginx.conf` |
| Windows | `C:\nginx\conf\nginx.conf` |

### 关键目录

| 目录 | 用途 |
|------|------|
| `/etc/nginx/sites-available/` | 可用站点配置 |
| `/etc/nginx/sites-enabled/` | 启用的站点配置 |
| `/var/log/nginx/` | 日志文件 |
| `/var/www/html/` | 默认文档根目录 |
| `/usr/share/nginx/html/` | 默认 HTML 文件 |

### 基础配置示例

```nginx
worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen 80;
        server_name example.com www.example.com;

        root /var/www/example.com;
        index index.html index.htm;

        location / {
            try_files $uri $uri/ =404;
        }

        location /api {
            proxy_pass http://localhost:3000;
        }

        error_page 404 /404.html;
    }
}
```

### 常用命令

```bash
# 测试配置
nginx -t

# 重新加载配置
sudo systemctl reload nginx

# 重启 Nginx
sudo systemctl restart nginx

# 停止 Nginx
sudo systemctl stop nginx

# 启动 Nginx
sudo systemctl start nginx
```

---

## 卸载

### Ubuntu/Debian

```bash
sudo apt remove nginx nginx-common nginx-core
sudo apt autoremove
```

### CentOS/RHEL

```bash
sudo yum remove nginx
```

### Fedora

```bash
sudo dnf remove nginx
```

### Arch Linux

```bash
sudo pacman -R nginx
```

### macOS (Homebrew)

```bash
brew uninstall nginx
```

### Windows

```powershell
# 先停止 Nginx
nginx -s stop

# 删除 nginx 文件夹
Remove-Item -Recurse C:\nginx
```

---

## 下一步

- [使用指南](./2.使用指南.md)
- 阅读 [官方 Nginx 文档](https://nginx.org/en/docs/)
