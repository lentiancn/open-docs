# Nacos Installation Guide

This guide provides detailed instructions for installing Nacos on all major platforms.

---

## Table of Contents

- [What is Nacos?](#what-is-nacos)
- [Installation Methods](#installation-methods)
- [Standalone Installation](#standalone-installation)
- [Docker Installation](#docker-installation)
- [Cluster Installation](#cluster-installation)
- [Configuration](#configuration)
- [Start Nacos](#start-nacos)
- [Verify Installation](#verify-installation)
- [Uninstall Nacos](#uninstall-nacos)

---

## What is Nacos?

Nacos (Dynamic Naming and Configuration Service) is an easy-to-use platform for building cloud-native applications. It provides:

- **Service Discovery**: Register and discover services
- **Configuration Management**: Dynamic configuration
- **Service Management**: Health monitoring, traffic management

---

## Installation Methods

| Method | Description | Best For |
|--------|-------------|----------|
| **Standalone** | Single server | Development, testing |
| **Docker** | Containerized | Quick deployment |
| **Cluster** | Multiple servers | Production |

---

## Standalone Installation

### Prerequisites

- Java 8 or higher
- 2GB+ RAM
- 64-bit Linux/Unix/Mac/Windows

### Download Nacos

```bash
# Download latest stable version (2.3.0)
wget https://github.com/alibaba/nacos/releases/download/v2.3.0/nacos-server-2.3.0.tar.gz

# Or use curl
curl -L -o nacos-server-2.3.0.tar.gz https://github.com/alibaba/nacos/releases/download/v2.3.0/nacos-server-2.3.0.tar.gz

# Extract
tar -xzf nacos-server-2.3.0.tar.gz

# Move to /opt
sudo mv nacos /opt/nacos
```

### Directory Structure

```
nacos/
├── bin/          # Startup scripts
├── conf/         # Configuration files
├── data/         # Data directory
├── logs/         # Log files
└── target/       # Executable files
```

---

## Docker Installation

### Quick Start

```bash
# Run Nacos in standalone mode
docker run -d \
  --name nacos \
  -p 8848:8848 \
  -p 9848:9848 \
  -e MODE=standalone \
  nacos/nacos-server:v2.3.0
```

### With MySQL Persistence

```bash
# Create MySQL container first
docker run -d \
  --name mysql \
  -e MYSQL_ROOT_PASSWORD=nacos \
  -e MYSQL_DATABASE=nacos_config \
  -p 3306:3306 \
  mysql:8

# Run Nacos with MySQL
docker run -d \
  --name nacos \
  -p 8848:8848 \
  -p 9848:9848 \
  -e MODE=standalone \
  -e SPRING_DATASOURCE_PLATFORM=mysql \
  -e MYSQL_SERVICE_HOST=mysql \
  -e MYSQL_SERVICE_DB_NAME=nacos_config \
  -e MYSQL_SERVICE_PORT=3306 \
  -e MYSQL_SERVICE_USER=root \
  -e MYSQL_SERVICE_PASSWORD=nacos \
  --link mysql \
  nacos/nacos-server:v2.3.0
```

### Docker Compose

```yaml
version: '3.8'

services:
  mysql:
    image: mysql:8
    container_name: nacos-mysql
    environment:
      MYSQL_ROOT_PASSWORD: nacos
      MYSQL_DATABASE: nacos_config
    volumes:
      - mysql-data:/var/lib/mysql
    networks:
      - nacos-network

  nacos:
    image: nacos/nacos-server:v2.3.0
    container_name: nacos-standalone
    environment:
      MODE: standalone
      SPRING_DATASOURCE_PLATFORM: mysql
      MYSQL_SERVICE_HOST: mysql
      MYSQL_SERVICE_DB_NAME: nacos_config
      MYSQL_SERVICE_PORT: 3306
      MYSQL_SERVICE_USER: root
      MYSQL_SERVICE_PASSWORD: nacos
    ports:
      - "8848:8848"
      - "9848:9848"
    depends_on:
      - mysql
    networks:
      - nacos-network

volumes:
  mysql-data:

networks:
  nacos-network:
    driver: bridge
```

---

## Cluster Installation

### Architecture

```
Nacos Server 1 (Leader)
      |
      +-- Nacos Server 2 (Follower)
      +-- Nacos Server 3 (Follower)
```

### Configuration

Edit `conf/cluster.conf`:

```properties
# IP addresses of cluster nodes
192.168.1.101:8848
192.168.1.102:8848
192.168.1.103:8848
```

### MySQL Configuration

Create database and tables:

```bash
# Connect to MySQL
mysql -u root -p

# Create database
CREATE DATABASE nacos_config;

# Import tables
use nacos_config;
source /opt/nacos/conf/nacos-mysql.sql;
```

### Configure MySQL Connection

Edit `conf/application.properties`:

```properties
# MySQL configuration
spring.datasource.platform=mysql
db.num=1
db.url.0=jdbc:mysql://localhost:3306/nacos_config?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true
db.user=root
db.password=nacos
```

### Start Cluster

```bash
# Start on each node
/opt/nacos/bin/startup.sh

# Or use cluster mode
/opt/nacos/bin/startup.sh -m cluster
```

---

## Configuration

### Basic Configuration

Edit `conf/application.properties`:

```properties
# Server port
server.port=8848

# Authentication
nacos.core.auth.enabled=false
nacos.core.auth.server.identity.key=
nacos.core.auth.server.identity.value=

# Database (MySQL)
spring.datasource.platform=mysql
db.num=1
db.url.0=jdbc:mysql://localhost:3306/nacos_config?characterEncoding=utf8
db.user=root
db.password=your_password
```

### Memory Configuration

Edit `bin/startup.sh`:

```bash
# For standalone mode
export JVM_OPTS="-Xms512m -Xmx512m -Xmn256m"

# For production
export JVM_OPTS="-Xms2g -Xmx2g -Xmn1g"
```

### Security Configuration

```properties
# Enable authentication
nacos.core.auth.enabled=true

# Token settings
nacos.core.auth.token.secret.key=SecretKey012345678901234567890123456789012345678901234567890123456789
nacos.core.auth.token.expire.seconds=18000

# Service identity
nacos.core.auth.server.identity.key=serverIdentity
nacos.core.auth.server.identity.value=security
```

---

## Start Nacos

### Linux/Unix/Mac

```bash
# Standalone mode
cd /opt/nacos/bin
./startup.sh -m standalone

# Cluster mode
./startup.sh -m cluster
```

### Windows

```cmd
cd C:\nacos\bin
startup.cmd -m standalone
```

---

## Verify Installation

### Check Process

```bash
# Check if running
ps aux | grep nacos

# Or use jps
jps | grep nacos
```

### Access Web UI

- URL: http://localhost:8848/nacos
- Default username: nacos
- Default password: nacos

### Check Logs

```bash
# View logs
tail -f /opt/nacos/logs/start.out

# Or
cat /opt/nacos/logs/nacos.log
```

### API Verification

```bash
# Check server health
curl http://localhost:8848/nacos/v1/console/health/readiness

# Get cluster members
curl http://localhost:8848/nacos/v1/cluster/nodes
```

---

## System Requirements

| Resource | Minimum | Recommended |
|----------|---------|-------------|
| CPU | 2 cores | 4+ cores |
| RAM | 2GB | 4GB+ |
| Disk | 10GB | 50GB+ |

---

## Version Information

### Current Stable Version

- **Nacos 2.3.0** (Latest stable)
- Requires Java 8+

### Version History

| Version | Release | Key Features |
|---------|---------|--------------|
| 2.3.x | 2024 | Latest stable |
| 2.2.x | 2023 | Performance improvements |
| 2.1.x | 2022 | Stability fixes |
| 1.4.x | 2021 | Legacy stable |

---

## Next Steps

- [Usage Guide](./2.使用指南.md)
- [Nacos Official Documentation](https://nacos.io/en-us/docs/quick-start.html)
