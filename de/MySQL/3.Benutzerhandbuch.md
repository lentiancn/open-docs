# MySQL Benutzerhandbuch

Dieses Handbuch bietet umfassende Anweisungen zur effektiven Nutzung von MySQL.

---

## Datenbankoperationen

### Datenbank erstellen

```sql
-- Neue Datenbank erstellen
CREATE DATABASE meineapp;

-- Datenbank mit Zeichensatz erstellen
CREATE DATABASE meineapp CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- Datenbanken anzeigen
SHOW DATABASES;

-- Datenbank auswählen
USE meineapp;

-- Datenbank löschen
DROP DATABASE meineapp;
```

### Tabellen erstellen

```sql
-- Grundlegende Tabellenerstellung
CREATE TABLE benutzer (
    id INT AUTO_INCREMENT PRIMARY KEY,
    benutzername VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    passwort VARCHAR(255) NOT NULL,
    erstellt_am TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabelle mit Fremdschlüsseln
CREATE TABLE bestellungen (
    id INT AUTO_INCREMENT PRIMARY KEY,
    benutzer_id INT NOT NULL,
    gesamt DECIMAL(10, 2) NOT NULL,
    status ENUM('ausstehend', 'in_bearbeitung', 'versandt', 'geliefert') DEFAULT 'ausstehend',
    FOREIGN KEY (benutzer_id) REFERENCES benutzer(id) ON DELETE CASCADE
);
```

---

## Daten bearbeiten

### Daten einfügen

```sql
-- Einzelne Zeile einfügen
INSERT INTO benutzer (benutzername, email, passwort)
VALUES ('max', 'max@beispiel.de', 'gehash_passwort');

-- Mehrere Zeilen einfügen
INSERT INTO benutzer (benutzername, email, passwort) VALUES
    ('alice', 'alice@beispiel.de', 'pass1'),
    ('bob', 'bob@beispiel.de', 'pass2');
```

### Daten aktualisieren

```sql
-- Einzelne Zeile aktualisieren
UPDATE benutzer SET passwort = 'neuer_hash' WHERE id = 1;

-- Mehrere Zeilen aktualisieren
UPDATE benutzer SET status = 'aktiv' WHERE last_login > '2024-01-01';
```

### Daten löschen

```sql
-- Einzelne Zeile löschen
DELETE FROM benutzer WHERE id = 1;

-- Alle Zeilen löschen (truncat ist schneller)
TRUNCATE TABLE benutzer;
```

---

## Daten abfragen

### Grundlegendes SELECT

```sql
-- Alle Spalten auswählen
SELECT * FROM benutzer;

-- Bestimmte Spalten auswählen
SELECT benutzername, email FROM benutzer;

-- Mit WHERE-Klausel
SELECT * FROM benutzer WHERE status = 'aktiv';

-- Mit ORDER BY
SELECT * FROM benutzer ORDER BY erstellt_am DESC;

-- Mit LIMIT
SELECT * FROM benutzer LIMIT 10;
```

### JOIN-Operationen

```sql
-- INNER JOIN
SELECT b.id, b.benutzername, b.gesamt
FROM bestellungen b
INNER JOIN benutzer u ON b.benutzer_id = u.id;

-- LEFT JOIN
SELECT u.benutzername, b.id
FROM benutzer u
LEFT JOIN bestellungen b ON u.id = b.benutzer_id;
```

### Aggregatfunktionen

```sql
-- COUNT
SELECT COUNT(*) FROM benutzer;

-- SUM, AVG, MIN, MAX
SELECT SUM(betrag) FROM bestellungen;
SELECT AVG(preis) FROM produkte;

-- GROUP BY
SELECT land, COUNT(*) as anzahl
FROM benutzer
GROUP BY land
HAVING anzahl > 10;
```

---

## Benutzerverwaltung

### Benutzer erstellen

```sql
-- Benutzer erstellen
CREATE USER 'max'@'localhost' IDENTIFIED BY 'passwort123';

-- Benutzer mit spezifischen Rechten erstellen
CREATE USER 'app_benutzer'@'%' IDENTIFIED BY 'passwort123';
GRANT SELECT, INSERT, UPDATE, DELETE ON meineapp.* TO 'app_benutzer'@'%';
```

### Rechte verwalten

```sql
-- Rechte gewähren
GRANT SELECT, INSERT ON meineapp.* TO 'benutzer'@'localhost';

-- Rechte entziehen
REVOKE INSERT ON meineapp.* FROM 'benutzer'@'localhost';

-- Rechte anzeigen
SHOW GRANTS FOR 'benutzer'@'localhost';

-- Rechte neu laden
FLUSH PRIVILEGES;
```

---

## Backup und Wiederherstellung

### Backup

```bash
# Einzelne Datenbank sichern
mysqldump -u root -p meineapp > meineapp_backup.sql

# Alle Datenbanken sichern
mysqldump -u root -p --all-databases >vollbackup.sql
```

### Wiederherstellung

```bash
# Aus Backup wiederherstellen
mysql -u root -p meineapp < meineapp_backup.sql
```

---

## Indizes

### Indizes erstellen

```sql
-- Einzelne Spalte indizieren
CREATE INDEX idx_email ON benutzer(email);

-- Zusammengesetzten Index erstellen
CREATE INDEX idx_name_datum ON benutzer(name, vorname, erstellt_am);

-- Einzigartigen Index erstellen
CREATE UNIQUE INDEX idx_benutzername ON benutzer(benutzername);
```

### Abfrage optimieren

```sql
-- EXPLAIN - Abfrage analysieren
EXPLAIN SELECT * FROM benutzer WHERE email = 'max@beispiel.de';

-- Tabelle optimieren
OPTIMIZE TABLE benutzer;
```

---

## Replikation

### Master-Slave-Replikation

**Master-Konfiguration (my.cnf):**
```ini
[mysqld]
server-id=1
log-bin=mysql-bin
binlog-do-db=meineapp
```

**Slave-Konfiguration (my.cnf):**
```ini
[mysqld]
server-id=2
relay-log=relay-bin
read-only=1
```
