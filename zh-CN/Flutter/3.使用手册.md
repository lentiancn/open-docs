# Flutter 使用手册

本文档介绍 Flutter 开发的核心知识，包括组件、布局、状态管理、网络请求等。

---

## 快速开始

### 创建项目

```bash
flutter create hello_world
cd hello_world
flutter run
```

### 最小代码结构

```dart
import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: '我的应用',
      home: Scaffold(
        appBar: AppBar(title: const Text('首页')),
        body: const Center(
          child: Text('Hello Flutter!'),
        ),
      ),
    );
  }
}
```

---

## 常用组件

### 文本

```dart
Text('普通文本')

Text(
  '大号加粗',
  style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
)
```

### 图片

```dart
// 网络图片
Image.network('https://example.com/logo.png')

// 本地图片（需要先在 pubspec.yaml 声明）
Image.asset('assets/logo.png')
```

### 按钮

```dart
// 普通按钮
ElevatedButton(
  onPressed: () => print('点击了'),
  child: const Text('点我'),
)

// 图标按钮
IconButton(
  icon: const Icon(Icons.star),
  onPressed: () {},
)
```

### 输入框

```dart
TextField(
  decoration: const InputDecoration(
    hintText: '请输入内容',
    border: OutlineInputBorder(),
  ),
  onChanged: (value) => print(value),
)
```

---

## 布局

Flutter 的布局核心原则：**约束向下传，尺寸向上传，父组件决定位置**。

### Row（水平排列）

```dart
Row(
  mainAxisAlignment: MainAxisAlignment.spaceEvenly,  // 水平对齐方式
  children: const [
    Icon(Icons.home),
    Icon(Icons.search),
    Icon(Icons.settings),
  ],
)
```

### Column（垂直排列）

```dart
Column(
  crossAxisAlignment: CrossAxisAlignment.center,  // 垂直对齐方式
  children: const [
    Text('第一行'),
    Text('第二行'),
  ],
)
```

### Stack（层叠布局）

```dart
Stack(
  children: [
    Container(color: Colors.blue, width: 200, height: 200),
    Positioned(
      right: 10,
      bottom: 10,
      child: Icon(Icons.check, color: Colors.white),
    ),
  ],
)
```

### ListView（列表）

```dart
ListView.builder(
  itemCount: 100,
  itemBuilder: (context, index) {
    return ListTile(
      leading: CircleAvatar(child: Text('$index')),
      title: Text('第 $index 项'),
    );
  },
)
```

### 间距

```dart
// 水平间距
SizedBox(width: 16)

// 垂直间距
SizedBox(height: 8)

// 内边距
Padding(
  padding: EdgeInsets.all(16),
  child: Text('内容'),
)
```

---

## 状态管理

### setState（基础）

适用于简单的局部状态：

```dart
class Counter extends StatefulWidget {
  const Counter({super.key});
  @override
  State<Counter> createState() => _CounterState();
}

class _CounterState extends State<Counter> {
  int count = 0;

  void _add() {
    setState(() => count++);  // 必须调用 setState
  }

  @override
  Widget build(BuildContext context) {
    return ElevatedButton(
      onPressed: _add,
      child: Text('计数：$count'),
    );
  }
}
```

### Provider（推荐）

适合中大型应用：

**1. 添加依赖**

```yaml
dependencies:
  provider: ^6.1.0
```

**2. 创建状态类**

```dart
import 'package:flutter/foundation.dart';

class CounterModel extends ChangeNotifier {
  int _count = 0;
  int get count => _count;

  void increment() {
    _count++;
    notifyListeners();  // 通知界面更新
  }
}
```

**3. 注入状态**

```dart
ChangeNotifierProvider(
  create: (_) => CounterModel(),
  child: const MyApp(),
)
```

**4. 使用**

```dart
// 读取并监听变化
int count = context.watch<CounterModel>().count;

// 触发更新
context.read<CounterModel>().increment();
```

---

## 路由导航

### 基本跳转

```dart
// 跳转到新页面
Navigator.push(
  context,
  MaterialPageRoute(builder: (_) => const DetailPage()),
);

// 返回上一页
Navigator.pop(context);
```

### 命名路由

```dart
MaterialApp(
  routes: {
    '/': (_) => const HomePage(),
    '/detail': (_) => const DetailPage(),
  },
)

// 跳转
Navigator.pushNamed(context, '/detail');
```

---

## 网络请求

推荐使用 Dio 库：

```yaml
dependencies:
  dio: ^5.3.0
```

```dart
import 'package:dio/dio.dart';

final dio = Dio();

// GET 请求
Future<void> fetchData() async {
  final response = await dio.get('https://api.example.com/data');
  print(response.data);
}

// POST 请求
Future<void> postData() async {
  await dio.post(
    'https://api.example.com/create',
    data: {'name': 'Flutter', 'version': '3.0'},
  );
}
```

### 解析 JSON

```dart
final data = json.decode(response.body);
final name = data['name'] as String;
final list = data['items'] as List;
```

---

## 调试技巧

### 热重载

运行应用后，修改代码按 `S` 键或点击命令行中的 "S" 即可热重载。

### 日志打印

```dart
print('调试信息：$variable');
```

### 检查 Widget

使用 Flutter DevTools 可以查看界面上的 Widget 树结构，帮助定位问题。

---

## 常用命令

```bash
# 创建项目
flutter create my_app

# 运行
flutter run

# 构建安装包
flutter build apk      # Android
flutter build ios      # iOS
flutter build web      # 网页

# 清理缓存
flutter clean

# 获取依赖
flutter pub get

# 代码检查
flutter analyze
```

---

## 下一步

- [常见问题](./4.常见问题.md) - 解决开发中遇到的问题
