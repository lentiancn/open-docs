# FantasyTalking - Benutzerhandbuch

Detaillierte Verwendung und Beispiele.

## Grundlegende Verwendung

### Video generieren

```bash
python inference.py \
  --source_image face.jpg \
  --audio speech.wav \
  --output output.mp4
```

### Parameter

| Parameter | Kurz | Beschreibung | Standardwert |
|-----------|------|--------------|--------------|
| --source_image | -s | Eingabebildpfad | Erforderlich |
| --audio | -a | Eingabe-Audiodatei | Erforderlich |
| --output | -o | Ausgabevideopfad | output.mp4 |
| --face_enhancer | -f | Gesichtserweiterungsmodell | None |
| --max_frames | -m | Maximale Frames | 300 |
| --fps | -fps | Ausgabeframerate | 25 |

### Vollständiges Beispiel

```bash
python inference.py \
  --source_image photos/person1.jpg \
  --audio audio/speech.wav \
  --output results/video1.mp4 \
  --face_enhancer realusf \
  --fps 30
```

## Erweiterte Verwendung

### Python API

```python
from fantasytalking import FantasyTalking

# Modell initialisieren
ft = FantasyTalking(
    checkpoint_path="./models/checkpoint.pth",
    face_enhancer="realusf"
)

# Video generieren
ft.generate(
    source_image="face.jpg",
    audio="speech.wav",
    output="output.mp4"
)
```

### Stapelverarbeitung

```python
import os
from fantasytalking import FantasyTalking

ft = FantasyTalking()

images_dir = "./images"
audio_dir = "./audio"
output_dir = "./output"

for image_file in os.listdir(images_dir):
    for audio_file in os.listdir(audio_dir):
        output_name = f"{image_file}_{audio_file}.mp4"
        ft.generate(
            source_image=os.path.join(images_dir, image_file),
            audio=os.path.join(audio_dir, audio_file),
            output=os.path.join(output_dir, output_name)
        )
```

### Web API Service

```bash
# API-Service starten
python api.py --port 8080
```

Beispielaufruf:

```bash
curl -X POST http://localhost:8080/generate \
  -F "image=@face.jpg" \
  -F "audio=@speech.wav" \
  -o output.mp4
```

## Eingabeanforderungen

### Bildformat

- **Unterstützte Formate**: JPG, PNG, BMP
- **Empfohlene Auflösung**: 512x512 oder höher
- **Gesichtsanforderungen**:
  - Frontales Gesicht ohne Bedeckung funktioniert am besten
  - Gesicht sollte mehr als 50% des Bildes einnehmen
  - Gute Beleuchtung, natürlicher Gesichtsausdruck

### Audioformat

- **Unterstützte Formate**: WAV, MP3, FLAC
- **Abtastrate**: 16000 Hz oder 44100 Hz
- **Dauer**: 1-60 Sekunden empfohlen
- **Sprache**: Automatische Erkennung mehrerer Sprachen

## Ausgabeeinstellungen

### Auflösung

```bash
# Ausgabeauflösung einstellen
python inference.py --source_image face.jpg --audio speech.wav --output output.mp4 --size 512
```

Unterstützte Auflösungen: 256, 512, 768, 1024

### Framerate

```bash
# Framerate einstellen
python inference.py --source_image face.jpg --audio speech.wav --output output.mp4 --fps 30
```

### Videoformat

Unterstützte Ausgabeformate: MP4 (H.264), AVI, MOV

## Leistungsoptimierung

### GPU-Beschleunigung

Stellen Sie sicher, dass Sie CUDA verwenden:

```python
ft = FantasyTalking(device="cuda")
```

### Stapelverarbeitung

Verwenden Sie Stapelverarbeitung für mehrere Dateien:

```python
ft.batch_generate(image_list, audio_list, output_dir)
```

### Gemischte Präzision

FP16-Beschleunigung aktivieren:

```python
ft = FantasyTalking(precision="fp16")
```

## Häufige Probleme

### Video-Generierung fehlgeschlagen?

1. Überprüfen Sie, ob das Eingabebild ein Gesicht enthält
2. Bestätigen Sie, dass das Audioformat korrekt ist
3. Stellen Sie sicher, dass genügend VRAM vorhanden ist

### Gesicht verformt?

1. Verwenden Sie klarere Eingabebilder
2. Passen Sie die Parameter für Gesichtspunkte an

### Lippensynchronisation nicht synchron?

1. Überprüfen Sie, ob das Audio klar ist
2. Passen Sie die Synchronisationsparameter an

## Best Practices

1. **Geeignete Bilder auswählen**: Frontale, hochauflösende, gleichmäßige Beleuchtung
2. **Klares Audio vorbereiten**: Ohne Rauschen, mäßige Sprechgeschwindigkeit
3. **Parameter vernünftig einstellen**: Auflösung und Framerate nach Bedarf anpassen
4. **Gesichtserweiterung verwenden**: Verbessert die Bildqualität

## Nächste Stufe

- FAQ: Siehe 4.FAQ.md
