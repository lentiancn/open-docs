# JDK 使用手冊

本指南介紹如何使用 JDK 進行 Java 開發。

## 快速開始

### 編譯和執行

```bash
# 編譯
javac HelloWorld.java

# 執行
java HelloWorld
```

### 單檔案執行（JDK 11+）

```bash
# 直接執行
java HelloWorld.java
```

## 基本指令

### javac - Java 編譯器

```bash
# 編譯單個檔案
javac MyClass.java

# 編譯多個檔案
javac *.java

# 使用特定編碼編譯
javac -encoding UTF-8 MyClass.java

# 編譯到指定目錄
javac -d bin MyClass.java

# 顯示所有警告
javac -Xlint MyClass.java
```

### java - Java 啟動器

```bash
# 執行類別
java MyClass

# 帶參數執行
java MyClass arg1 arg2

# 設定類別路徑
java -classpath "lib/*:." MyClass

# 設定記憶體
java -Xmx2g -Xms512m MyClass
```

### jar - Java 歸檔工具

```bash
# 建立 JAR
jar cf myapp.jar -C bin .

# 帶清單檔案建立 JAR
jar cfm myapp.jar manifest.txt -C bin .

# 解壓縮 JAR
jar xf myapp.jar

# 列出 JAR 內容
jar tf myapp.jar
```

### javadoc - 文件產生器

```bash
# 產生文件
javadoc -d docs -sourcepath src *.java

# 帶自訂標題產生文件
javadoc -d docs -header "My App" *.java
```

### jdb - Java 偵錯器

```bash
# 啟動偵錯器
jdb MyClass

# 設定中斷點
stop at MyClass:10

# 執行
run

# 單步執行
next
step
```

## JVM 選項

### 記憶體選項

```bash
# 堆積大小
-Xmx2g        # 最大堆
-Xms512m      # 初始堆
-Xss256k      # 堆疊大小

# 垃圾回收
-XX:+UseG1GC  # G1 垃圾收集器
-XX:+UseParallelGC # 平行 GC
```

### 效能選項

```bash
# JIT 編譯器
-XX:+TieredCompilation

# 類別資料共享
-Xshare:on

# 字串去重
-XX:+UseStringDeduplication
```

## IDE 整合

### IntelliJ IDEA

1. File → Project Structure → SDKs
2. 新增 JDK 安裝路徑
3. 設定 Project SDK

### VS Code

1. 安裝 "Extension Pack for Java"
2. 在設定中配置 JAVA_HOME

### Eclipse

1. Window → Preferences → Java → Installed JREs
2. 新增 Standard VM
3. 設為預設

## 建置工具

### Maven

```xml
<properties>
    <maven.compiler.source>21</maven.compiler.source>
    <maven.compiler.target>21</maven.compiler.target>
</properties>
```

### Gradle

```groovy
sourceCompatibility = '21'
targetCompatibility = '21'
```

## 模組系統（Java 9+）

### 列出模組

```bash
java --list-modules
```

### 模組選項

```bash
# 匯出套件
--export-module java.base/java.lang

# 開放模組
--open-module java.base
```

## 安全

### Keytool

```bash
# 產生金鑰對
keytool -genkeypair -alias mykey -keyalg RSA -keystore keystore.jks

# 列出憑證
keytool -list -keystore keystore.jks

# 匯出憑證
keytool -export -alias mykey -file cert.crt -keystore keystore.jks
```

## 效能分析

### jcmd

```bash
# 列出執行中的 Java 程式
jcmd

# 取得程式資訊
jcmd <pid> VM.flags

# 觸發 GC
jcmd <pid> GC.run
```

### jvisualvm

```bash
# 啟動視覺化 VM
jvisualvm
```

## 最佳實踐

### 1. 生產環境使用 LTS

```bash
# 推薦：生產環境使用 JDK 17 或 21
```

### 2. 設定適當的記憶體

```bash
# Web 應用程式
java -Xmx4g -Xms2g -XX:+UseG1GC MyApp
```

### 3. 啟用 GC 日誌

```bash
# 啟用 GC 日誌記錄
-Xlog:gc*:file=gc.log:time,uptime,level,tags
```

## 相關資源

- [Oracle Java 文件](https://docs.oracle.com/en/java/)
- [JDK API 文件](https://docs.oracle.com/en/java/javase/21/docs/api/)
