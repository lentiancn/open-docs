# Flutter 常见问题

这里收集了开发者经常遇到的问题和解决方案。

---

## 基础问题

### Flutter 到底是什么？

Flutter 是 Google 开发的**跨平台 UI 框架**。用 Dart 语言写一套代码，就能同时跑在 iOS、Android、Web、Windows、macOS、Linux 上。

### Flutter 和 React Native 有什么区别？

| 对比项 | Flutter | React Native |
|--------|---------|--------------|
| 开发语言 | Dart | JavaScript |
| 渲染方式 | 自己绘制 UI | 调用原生组件 |
| 性能 | 更快 | 还可以 |
| 上手难度 | 较低 | 较低 |

### 为什么要用 Dart 语言？

Dart 有两个关键优势：
1. **JIT 编译** - 开发时支持热重载，改代码立刻能看到效果
2. **AOT 编译** - 发布时编译成原生机器码，运行快

### 学 Flutter 需要什么基础？

只需要懂一点编程（知道变量、函数、类是什么就行）。Dart 语言本身比较简单易学。

---

## 安装问题

### flutter doctor 提示 Android SDK 缺失？

1. 安装 Android Studio（推荐）
2. 或者手动下载 Android SDK command-line tools
3. 设置 ANDROID_HOME 环境变量

### 下载 Flutter SDK 太慢？

使用国内镜像：

```bash
# Windows
[Environment]::SetEnvironmentVariable("FLUTTER_STORAGE_BASE_URL", "https://storage.flutter-io.cn")

# macOS / Linux
export FLUTTER_STORAGE_BASE_URL="https://storage.flutter-io.cn"
```

### macOS 提示权限问题？

运行：

```bash
sudo xcodebuild -runFirstLaunch
```

---

## 开发问题

### 界面不显示？

常见原因：
1. 没有设置宽高（Row/Column 需要明确子元素尺寸）
2. 使用了未包裹的 Center 但父容器没有约束
3. ListView 的子元素没有确定高度

### setState 为什么不生效？

检查是否在 setState 回调中修改了数据：

```dart
// ✅ 正确
setState(() {
  count++;
});

// ❌ 错误 - 没有调用 setState
count++;
```

### 网络请求失败？

1. 检查网络
2. 检查 URL
3. Android 需要添加权限：

```xml
<uses-permission android:name="android.permission.INTERNET"/>
```

### 图片加载不出来？

1. 确认网络正常
2. 检查 URL 是否正确
3. 添加 Internet 权限
4. 本地图片要在 pubspec.yaml 中声明 assets 目录

### 状态管理用哪个好？

| 场景 | 推荐 |
|------|------|
| 学习练手 | setState |
| 小项目 | Provider |
| 大项目 | Riverpod / BLoC |
| 快速开发 | GetX |

---

## 构建问题

### APK 构建失败？

```bash
flutter clean
flutter pub get
flutter build apk --debug
```

### iOS 构建失败？

1. 打开 `ios/Runner.xcworkspace` 检查签名配置
2. 确保 Xcode 版本够新
3. 运行 `flutter build ios --release --no-codesign`

### 网页端刷新 404？

需要配置服务器重定向：

```nginx
# nginx 配置
location / {
  try_files $uri $uri/ /index.html;
}
```

---

## 性能问题

### 应用卡顿？

1. 避免在 build() 中创建新对象
2. ListView 用 builder 代替 children
3. 多用 const 构造

```dart
// ✅ 高性能
ListView.builder(...)

// ❌ 低性能
ListView(children: items.map(...).toList())
```

### 首屏加载慢？

- 减少首屏依赖
- 使用延迟加载
- 优化图片资源

---

## 更多帮助

- 英文官网：https://docs.flutter.dev
- 中文社区：https://flutter.cn
- 问题反馈：https://github.com/flutter/flutter/issues

---

## 下一步

- [返回首页](./README.md)
