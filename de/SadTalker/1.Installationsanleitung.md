# SadTalker Installationsanleitung

SadTalker ist ein KI-Projekt zur Generierung realistischer Talking-Head-Videos aus einem einzelnen Bild und Audio-Input.

## Systemanforderungen

### Hardwareanforderungen

| Komponente | Minimum | Empfohlen |
|------------|---------|-----------|
| GPU | NVIDIA 6GB VRAM | NVIDIA 16GB VRAM |
| RAM | 8GB | 32GB |
| Speicher | 20GB frei | 50GB frei |
| OS | Ubuntu 18.04+, Windows 10+, macOS 11+ | Ubuntu 20.04+ |

### Softwareanforderungen

| Software | Version | Hinweise |
|----------|---------|----------|
| Python | 3.8 - 3.10 | 3.9 empfohlen |
| CUDA | 11.7+ | Für GPU-Beschleunigung |
| cuDNN | 8.5+ | Erforderlich für CUDA |
| ffmpeg | Neueste Version | Für Videoverarbeitung |

## Installation unter Linux/Ubuntu

### Schritt 1: Systemabhängigkeiten installieren

```bash
# System aktualisieren
sudo apt update && sudo apt upgrade -y

# Python und Entwicklungstools installieren
sudo apt install python3.9 python3-pip python3-venv git wget curl

# Systembibliotheken installieren
sudo apt install libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev libgomp1

# ffmpeg installieren
sudo apt install ffmpeg

# NVIDIA-Treiber installieren (falls nicht vorhanden)
sudo apt install nvidia-driver-525
```

### Schritt 2: CUDA installieren (falls erforderlich)

```bash
# CUDA 11.8 herunterladen und installieren
wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run
sudo sh cuda_11.8.0_520.61.05_linux.run
```

### Schritt 3: Repository klonen

```bash
git clone https://github.com/OpenTalker/SadTalker.git
cd SadTalker
```

### Schritt 4: Virtuelle Umgebung erstellen

```bash
python3.9 -m venv venv
source venv/bin/activate

# Python-Version überprüfen
python --version
```

### Schritt 5: PyTorch installieren

```bash
# Für CUDA 11.8
pip install torch==2.0.1 torchvision==0.15.2 --index-url https://download.pytorch.org/whl/cu118

# Installation überprüfen
python -c "import torch; print(torch.cuda.is_available())"
```

### Schritt 6: Abhängigkeiten installieren

```bash
pip install -r requirements.txt

# Zusätzliche Abhängigkeiten installieren
pip install numpy opencv-python librosa soundfile
```

### Schritt 7: Modelle herunterladen

```bash
# Modelverzeichnis erstellen
mkdir -p checkpoints

# Modelle herunterladen (automatisch)
bash scripts/download_models.sh

# Oder manuell von Releases herunterladen
# Modelle in checkpoints/ Verzeichnis ablegen
```

## Installation unter Windows

### Schritt 1: Python installieren

1. Python 3.9 von python.org herunterladen
2. Während der Installation "Add Python to PATH" aktivieren
3. Überprüfen: `python --version`

### Schritt 2: CUDA installieren

1. CUDA 11.8 von der NVIDIA-Website herunterladen
2. Mit Standardeinstellungen installieren
3. cuDNN 8.9 herunterladen und installieren

### Schritt 3: Klonen und Einrichten

```powershell
git clone https://github.com/OpenTalker/SadTalker.git
cd SadTalker

python -m venv venv
venv\Scripts\activate
```

### Schritt 4: Abhängigkeiten installieren

```powershell
# PyTorch mit CUDA-Unterstützung installieren
pip install torch==2.0.1 torchvision==0.15.2 --index-url https://download.pytorch.org/whl/cu118

pip install -r requirements.txt
```

### Schritt 5: Modelle herunterladen

Modelle von der GitHub-Releases-Seite herunterladen und im `checkpoints/`-Ordner ablegen.

## Installation unter macOS

### Schritt 1: Abhängigkeiten installieren

```bash
# Homebrew installieren (falls nicht vorhanden)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# Python und ffmpeg installieren
brew install python@3.9 ffmpeg git
```

### Schritt 2: Einrichten

```bash
git clone https://github.com/OpenTalker/SadTalker.git
cd SadTalker

python3.9 -m venv venv
source venv/bin/activate

# PyTorch installieren (nur CPU für macOS)
pip install torch==2.0.1 torchvision==0.15.2

pip install -r requirements.txt
```

Hinweis: macOS läuft im Nur-CPU-Modus. GPU-Beschleunigung ist nicht verfügbar.

## Docker-Installation

### Docker verwenden

```bash
# Image herunterladen
docker pull ghcr.io/opentalker/sadtalker:latest

# Mit GPU-Unterstützung ausführen
docker run --gpus all -v $(pwd):/workspace -p 8888:8888 ghcr.io/opentalker/sadtalker:latest
```

### Docker Compose verwenden

```yaml
version: '3.8'
services:
  sadtalker:
    image: ghcr.io/opentalker/sadtalker:latest
    volumes:
      - ./workspace:/workspace
    ports:
      - "8888:8888"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
```

## Installation überprüfen

```bash
# Grundfunktionalität testen
python inference.py --help

# Sollte alle verfügbaren Optionen anzeigen
```

## Häufige Probleme

### CUDA Out of Memory

**Lösung:**
- Batch-Größe reduzieren: `--batch_size 1`
- Niedrigere Auflösung verwenden: `--size 256`
- Modell-Offloading aktivieren
- Andere GPU-Anwendungen schließen

### Fehlende Bibliotheken (Windows)

**Lösung:**
- Visual C++ Redistributable 2015-2022 installieren
- CUDA zum System-PATH hinzufügen

### Modell-Download-Fehler

**Lösung:**
- VPN oder Proxy verwenden
- Manuell von GitHub-Releases herunterladen
- Netzwerkverbindung überprüfen

### ffmpeg nicht gefunden

**Lösung:**
- Linux: `sudo apt install ffmpeg`
- Windows: ffmpeg zum PATH hinzufügen
- macOS: `brew install ffmpeg`

## Verwandte Links

- [GitHub-Repository](https://github.com/OpenTalker/SadTalker)
- [HuggingFace Demo](https://huggingface.co/spaces/fffilo/SadTalker)
- [Paper](https://arxiv.org/abs/2303.17550)
- [Modelle herunterladen](https://github.com/OpenTalker/SadTalker/releases)
