# Jenkins Benutzerhandbuch

Diese Anleitung erklärt, wie Sie Jenkins für Continuous Integration und Continuous Deployment verwenden.

## Schnellstart

### Ersten Job erstellen

1. Auf "Neues Item" klicken
2. Job-Namen eingeben
3. "Freistil-Projekt" auswählen
4. Quellcodeverwaltung (Git) konfigurieren
5. Build-Trigger konfigurieren
6. Build-Schritte konfigurieren
7. Speichern und bauen

## Job-Typen

### Freistil-Projekt

```groovy
// Build-Schritt-Beispiel
pipeline {
    agent any
    
    stages {
        stage('Checkout') {
            steps {
                git 'https://github.com/example/repo.git'
            }
        }
        stage('Build') {
            steps {
                sh 'npm install'
                sh 'npm test'
            }
        }
        stage('Deploy') {
            steps {
                sh 'npm run deploy'
            }
        }
    }
}
```

### Pipeline-Projekt

```groovy
// Jenkinsfile
pipeline {
    agent any
    
    environment {
        APP_NAME = 'my-app'
    }
    
    stages {
        stage('Build') {
            steps {
                echo 'Building...'
                sh 'npm install'
            }
        }
        
        stage('Test') {
            steps {
                echo 'Testing...'
                sh 'npm test'
            }
        }
        
        stage('Deploy') {
            when {
                branch 'main'
            }
            steps {
                echo 'Deploying...'
            }
        }
    }
    
    post {
        always {
            echo 'Cleaning up...'
        }
        success {
            echo 'Build succeeded!'
        }
        failure {
            echo 'Build failed!'
        }
    }
}
```

## Häufige Plugins

### Git-Plugin

```groovy
git branch: 'main',
    credentialsId: 'github-credentials',
    url: 'https://github.com/example/repo.git'
```

### Docker-Plugin

```groovy
docker.build('my-app:latest')
```

### Maven-Plugin

```groovy
mvn clean package
```

## Build-Trigger

### Geplanter Build

```groovy
# Stündlich bauen
cron('H * * * *')

# Täglich um Mitternacht bauen
cron('H 0 * * *')
```

### SCM-Abfrage

```groovy
pollScm('H * * * *')
```

### Webhook-Trigger

1. "Generic Webhook Trigger" Plugin installieren
2. Job-Trigger konfigurieren
3. Webhook in GitHub/GitLab konfigurieren

## Umgebungsvariablen

### Integrierte Variablen

```groovy
echo "Aktueller Build: ${BUILD_NUMBER}"
echo "Arbeitsverzeichnis: ${WORKSPACE}"
echo "GIT_BRANCH: ${GIT_BRANCH}"
```

### Benutzerdefinierte Variablen

```groovy
environment {
    APP_VERSION = '1.0.0'
    DEPLOY_ENV = 'production'
}
```

## Anmeldedatenverwaltung

### Anmeldedaten hinzufügen

1. Zu "Manage Jenkins" → "Manage Credentials" gehen
2. Anmeldedaten hinzufügen:
   - Username with password
   - SSH Username with private key
   - Secret file

### Anmeldedaten verwenden

```groovy
withCredentials([usernamePassword(credentialsId: 'my-creds', usernameVariable: 'USER', passwordVariable: 'PASS')]) {
    sh 'echo $USER:$PASS'
}
```

## Verteilte Builds

### Agent-Knoten konfigurieren

1. Zu "Manage Jenkins" → "Manage Nodes" gehen
2. Neuen Knoten hinzufügen
3. Verbindungsinformationen konfigurieren

### Labels verwenden

```groovy
pipeline {
    agent {
        label 'docker'
    }
    // Build-Schritte
}
```

## Benachrichtigungen

### E-Mail-Benachrichtigung

```groovy
emailext (
    subject: "Build-Benachrichtigung: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
    body: "Build-Status: ${currentBuild.result}",
    to: 'team@example.com'
)
```

### Slack-Benachrichtigung

1. "Slack Notification" Plugin installieren
2. Workspace konfigurieren
3. Benachrichtigungsschritt hinzufügen

## Sicherung und Wiederherstellung

### Sicherung

```bash
# JENKINS_HOME sichern
tar -czvf jenkins-backup.tar.gz $JENKINS_HOME
```

### Wiederherstellung

```bash
# Jenkins stoppen
# Sicherung entpacken
tar -xzvf jenkins-backup.tar.gz -C $JENKINS_HOME
# Jenkins neu starten
```

## Best Practices

### 1. Pipeline verwenden

```groovy
// Deklarative Pipeline wird empfohlen
pipeline {
    // Gesamtprozess definieren
}
```

### 2. Parametrisierter Build

```groovy
parameters {
    choice(name: 'ENV', choices: ['dev', 'staging', 'prod'], description: 'Deploy-Umgebung')
    string(name: 'VERSION', defaultValue: '', description: 'Versionsnummer')
}
```

### 3. Workspace bereinigen

```groovy
post {
    always {
        cleanWs()
    }
}
```

## Verwandte Ressourcen

- [Jenkins Offizielle Dokumentation](https://www.jenkins.io/doc/)
- [Pipeline-Syntax](https://www.jenkins.io/doc/book/pipeline/syntax/)
