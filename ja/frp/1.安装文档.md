# frp インストールガイド

frpは高性能なリバースプロキシツールであり、内網穿透に使用されます。このガイドでは、様々な環境でのインストール方法を説明します。

## バージョン情報

| バージョン | 状態 | 説明 |
|------------|------|------|
| frp 0.51.x | ✅ 現行 | 最新安定版 |

## システム要件

### ハードウェア要件

| 要件 | 構成 |
|------|------|
| CPU | 1コア以上 |
| メモリ | 64MB以上 |
| ディスク | 10MB以上 |

### ソフトウェア要件

| ソフトウェア | バージョン |
|--------------|------------|
| Go | 1.18+ (ソースコードビルド) |

## インストール方法

### 方法1：Linux/macOS

#### 1. ダウンロード

```bash
# 最新バージョンをダウンロード
wget https://github.com/fatedier/frp/releases/download/v0.51.0/frp_0.51.0_linux_amd64.tar.gz

# 解凍
tar -xzf frp_0.51.0_linux_amd64.tar.gz
cd frp_0.51.0_linux_amd64
```

#### 2. ディレクトリ構造

```
frp_0.51.0_linux_amd64/
├── frpc          # クライアント
├── frpc.ini      # クライアント設定
├── frps          # サーバー
├── frps.ini      # サーバー設定
└── systemd/      # systemdサービスファイル
```

### 方法2：Windows

#### 1. ダウンロード

1. https://github.com/fatedier/frp/releases にアクセス
2. Windows版をダウンロード
3. 指定ディレクトリに解凍

#### 2. 実行

```powershell
# サーバー
.\frps.exe -c frps.ini

# クライアント
.\frpc.exe -c frpc.ini
```

### 方法3：Docker

```bash
# サーバー
docker run --network host -d -v ./frps.ini:/etc/frp/frps.ini --name frps fatedier/frps:v0.51.0

# クライアント
docker run -d -v ./frpc.ini:/etc/frp/frpc.ini --name frpc fatedier/frpc:v0.51.0
```

### 方法4：ソースコードビルド

```bash
# リポジトリをクローン
git clone https://github.com/fatedier/frp.git

# ビルド
cd frp
make

# 出力はbin/ディレクトリ
```

## サーバー設定

### 基本設定 (frps.ini)

```ini
[common]
bind_port = 7000
dashboard_port = 7500
token = your_token_here
dashboard_user = admin
dashboard_pwd = admin

# ログ
log_file = ./frps.log
log_level = info
```

### 上級設定

```ini
[common]
# ポート
bind_port = 7000
vhost_http_port = 80
vhost_https_port = 443

# 認証
token = your_token_here

# 接続プール
max_pool_count = 5
max_ports_per_client = 0

# ハートビート
heartbeat_timeout = 90

# 許可するクライアントポート
allow_ports = 2000-3000,3001,3003,4000-50000
```

### systemdサービス

```ini
# /etc/systemd/system/frps.service
[Unit]
Description=frp server
After=network.target

[Service]
Type=simple
User=root
ExecStart=/path/to/frps -c /path/to/frps.ini

[Install]
WantedBy=multi-user.target
```

```bash
# サービスを開始
sudo systemctl start frps
sudo systemctl enable frps
```

## クライアント設定

### 基本設定 (frpc.ini)

```ini
[common]
server_addr = your_server_ip
server_port = 7000
token = your_token_here

[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 6000
```

### HTTPサービス

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[web]
type = http
local_port = 8080
custom_domains = yourdomain.com
```

### TCPポートマッピング

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[mysql]
type = tcp
local_ip = 127.0.0.1
local_port = 3306
remote_port = 13306
```

### STCP（セキュアTCP）

```ini
[common]
server_addr = your_server_ip
server_port = 7000

[secret_ssh]
type = stcp
sk = your_secret_key
local_ip = 127.0.0.1
local_port = 22
```

## よくある質問

### 接続に失敗する？

1. サーバーが実行されているか確認
2. ファイアウォールのポートを確認
3. tokenが一致しているか検証

### ポートが使用中？

remote_portを変更するか範囲ポートを使用。

### パフォーマンス問題？

接続プールサイズとタイムアウト設定を調整。

## 関連リンク

- [frp GitHub](https://github.com/fatedier/frp)
- [frp ドキュメント](https://gofrp.org/docs/)
