# MySQL  FAQ

このページでは、MySQLに関するよくある質問にお答えします。

---

## インストール

### どのバージョンのMySQLを使用すべきですか？

本番環境では、MySQL 8.0.xまたは8.4.xをお勧めします。

### WindowsにMySQLをインストールするには？

1. https://dev.mysql.com/downloads/installer/ からMySQL Installerをダウンロード
2. インストーラーを実行
3. 「Full」または「Custom」インストールを選択
4. ウィザードに従う

### DockerでMySQLをインストールするには？

```bash
docker run -d --name mysql \
  -e MYSQL_ROOT_PASSWORD=あなたのパスワード \
  -v mysql-data:/var/lib/mysql \
  -p 3306:3306 \
  mysql:8
```

---

## 接続

### コマンドラインからMySQLに接続するには？

```bash
mysql -u root -p
```

### MySQLのrootパスワードを忘れた場合

**Linux:**
1. MySQLを停止: `sudo systemctl stop mysql`
2. セーフモードで起動: `sudo mysqld_safe --skip-grant-tables`
3. 接続: `mysql -u root`
4. パスワードをリセット:
```sql
FLUSH PRIVILEGES;
ALTER USER 'root'@'localhost' IDENTIFIED BY '新しいパスワード';
```
5. MySQLを再起動

---

## データベースとテーブル

### データベースを作成するには？

```sql
CREATE DATABASE myapp;
```

### テーブルを作成するには？

```sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE
);
```

### すべてのテーブルを表示するには？

```sql
SHOW TABLES;
```

---

## データ操作

### データを挿入するには？

```sql
INSERT INTO users (username, email) VALUES ('tanaka', 'tanaka@example.jp');
```

### データを更新するには？

```sql
UPDATE users SET email = 'new@example.jp' WHERE id = 1;
```

### データを削除するには？

```sql
DELETE FROM users WHERE id = 1;
```

---

## クエリ

### テーブルを結合するには？

```sql
SELECT * FROM orders 
INNER JOIN users ON orders.user_id = users.id;
```

### LIMITとOFFSETを使用するには？

```sql
SELECT * FROM users LIMIT 10 OFFSET 20;
```

### 行をカウントするには？

```sql
SELECT COUNT(*) FROM users;
```

---

## インデックス

### インデックスを作成するには？

```sql
CREATE INDEX idx_email ON users(email);
```

### インデックスはいつ使用すべきですか？

- WHERE句の列
- JOIN条件の列
- ORDER BYの列
- 高いカーディナリティを持つ列

---

## パフォーマンス

### MySQLが遅い場合

1. 低速クエリを確認: `SHOW FULL PROCESSLIST;`
2. クエリを分析: `EXPLAIN SELECT ...`
3. 頻繁に使用される列にインデックスを追加
4. 設定を最適化

### スロークエリログを有効にするには？

my.cnfで:
```ini
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2
```

---

## バックアップと復元

### データベースをバックアップするには？

```bash
mysqldump -u root -p myapp > backup.sql
```

### データベースを復元するには？

```bash
mysql -u root -p myapp < backup.sql
```

---

## ユーザー管理

### 新しいユーザーを作成するには？

```sql
CREATE USER 'username'@'localhost' IDENTIFIED BY 'password';
```

### 権限を付与するには？

```sql
GRANT SELECT, INSERT, UPDATE ON myapp.* TO 'username'@'localhost';
```

---

## エラーとトラブルシューティング

### "Too many connections"の場合

my.cnfでmax_connectionsを増加:
```ini
max_connections = 300
```

### "Table is full"の場合

- ディスク容量を確認
- InnoDBのテーブルスペースサイズを増加

### "Out of memory"の場合

- バッファプールサイズを増加
- クエリを最適化
- RAMを追加

---

## リソース

- 公式ドキュメント: https://dev.mysql.com/doc/
- MySQLフォーラム: https://forums.mysql.com/
