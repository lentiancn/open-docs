# Docker 사용자 매뉴얼

핵심 개념, 기본 사용법 및 개발 가이드.

## 이미지 작업

### 이미지 가져오기

```
docker pull nginx
docker pull ubuntu:22.04
```

### 이미지 빌드

```
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

```
docker build -t my-app:tag .
```

### 이미지 관리

```
docker images
docker rmi nginx
```

## 컨테이너 작업

### 컨테이너 생성 및 시작

```
# 대화형 컨테이너
docker run -it ubuntu /bin/bash

# 분리된 컨테이너
docker run -d nginx

# 포트 매핑
docker run -d -p 8080:80 nginx

# 환경 변수
docker run -e MYSQL_ROOT_PASSWORD=123456 mysql
```

### 컨테이너 관리

```
docker ps              # 실행 중인 컨테이너
docker ps -a          # 모든 컨테이너
docker start container_id
docker stop container_id
docker rm container_id
```

### 컨테이너 들어가기

```
docker exec -it container_id /bin/bash
```

### 로그 보기

```
docker logs container_id
docker logs -f container_id
```

## Dockerfile 작성

### 기본 명령

```
FROM node:18-alpine
WORKDIR /app
COPY . .
RUN npm install
EXPOSE 3000
CMD ["npm", "start"]
```

### 다단계 빌드

```
# 빌드 단계
FROM node:18 AS builder
WORKDIR /app
COPY . .
RUN npm run build

# 프로덕션 단계
FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
```

## Docker Compose

### docker-compose.yml

```
version: '3.8'

services:
  web:
    build: .
    ports:
      - "3000:3000"
  db:
    image: postgres:15
    environment:
      POSTGRES_PASSWORD: secret
```

### 일반적인 명령

```
docker-compose up -d
docker-compose down
docker-compose logs -f
```

## 네트워크 관리

### 포트 매핑

```
docker run -p 8080:80 nginx
```

### 사용자 정의 네트워크

```
docker network create my-network
docker run --network my-network nginx
```

## 데이터 관리

### 볼륨

```
docker volume create my-data
docker run -v my-data:/data nginx
```

### 바인드 마운트

```
docker run -v /host/path:/container/path nginx
```

## 리소스 제한

```
# 메모리 제한
docker run -m 512m nginx

# CPU 제한
docker run --cpus=0.5 nginx
```

## 모니터링 및 디버깅

```
docker stats
docker inspect container_id
docker logs container_id
```

## 정리

```
docker system prune -a
docker volume prune
```
