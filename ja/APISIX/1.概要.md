# Apache APISIX 概要

## Apache APISIX とは

Apache APISIXは、API7.aiによって開発されApache Software Foundationに寄贈された**クラウドネイティブAPIゲートウェイ**であり、**AIゲートウェイ**でもあります。Apache Software Foundationのトップレベルプロジェクトとなっています。

APISIXはクライアントとバックエンドサービスの間の「トラフィックマネージャー」と考えると 이해できます。クライアントからのすべてのリクエストを受け取り、事前定義されたルールに基づいてどのように処理するかを決定します—バックエンドサービスに直接転送するか、負荷分散を行うか、認証後に転送するかなどです。

## コアコンセプト

- **従来のAPIゲートウェイ**: 南北トラフィック（外部から内部ネットワークへのトラフィック）の処理
- **サービスメッシュ**: 東西トラフィック（サービス間の内部トラフィック）の処理
- **Kubernetes Ingressコントローラー**: Kubernetesクラスターのエントリーポイント
- **AIゲートウェイ**: LLMプロキシ、負荷分散、リトライフォールバック、トークンレート制限などのAIシナリオをサポート

## 主な機能

### 1. 完全なダイナミック機能

APISIXの最大の特徴は、**再起動せずに設定を動的に更新できる**ことです。ルート、アップストリーム、プラグインなどの設定をいつでも追加、変更、削除できます。変更はすぐに有効になり、処理中のリクエストに影響しません。

- **動的ルート**: リクエストパラメータ、ヘッダー、Cookieなどに基づいて柔軟にマッチ
- **動的アップストリーム**: 再起動せずにバックエンドサービスノードを切り替え
- **動的証明書**: HTTPS証明書のホットリロードをサポート
- **ホットプラグイン**: ゲートウェイを再起動せずにプラグインを有効または無効に

### 2. 豊富なトラフィック管理機能

- **負荷分散**: ラウンドロビン、加重、ランダムハッシュなどをサポート
- **カナリアリリース**: 旧バージョンから新バージョンへのトラフィックを安全に移行
- **A/Bテスト**: 条件に基づいてユーザーを異なるサービスバージョンに割り当て
- **トラフィック分割**: サービス間のトラフィック比率を正確に制御
- **サーキットブレーカー**: 故障したアップストリームサービスを自動的に検出・分離

### 3. 包括的なセキュリティ

APISIXは複数の認証とアクセス制御プラグインを提供します：

- Key Authentication（APIキー認証）
- JWT Authentication（JSON Web Token）
- Basic Authentication（基本認証）
- OAuth 2.0
- HMAC認証
- LDAP認証
- IPホワイトリスト/ブラックリスト
- Referer防盗チェーン
- CSRF保護
- レート制限（limit-count、limit-req、limit-concurrency）

### 4. 可観測性

APISIXは完全なモニタリングとトレーシング機能を内蔵：

- **Prometheusメトリクス**: リアルタイムのゲートウェイパフォーマンス監視
- **分散トレーシング**: ZipkinとSkyWalkingをサポート
- **ログ管理**: アクセスログをKafka、Elasticsearch、Splunkなどに送信
- **モニタリングアラート**: 複数のアラート通知をサポート

### 5. マルチプロトコルサポート

APISIXは従来のHTTP/HTTPSだけでなく、以下をサポートします：

- TCP/UDPプロキシ
- gRPCおよびgRPC Web
- Dubbo
- MQTT
- WebSocket
- HTTP/3 (QUIC)

### 6. マルチ言語プラグイン開発

APISIXは複数の言語でカスタムプラグインを作成をサポート：

- Lua（ネイティブサポート）
- Java（Java Plugin Runner経由）
- Go（Go Plugin Runner経由）
- Python（Python Plugin Runner経由）
- Wasm（WebAssembly）

## 技術アーキテクチャ

APISIXのアーキテクチャは非常にシンプル：

- **データプレーン**: Nginx + Luaを使用した高性能リクエスト処理
- **コントロールプレーン**: etcdを使用した設定存储とクラスター同期
- **管理プレーン**: REST Admin APIとDashboard UIを提供

APISIXノードはステートレスで、簡単な水平スケーリングが可能です。複数のetcdアドレスを設定することで可用性を実現。

## ユースケース

- マイクロサービスアーキテクチャのAPIゲートウェイを構築
- Kubernetesクラスターのイングレスゲートウェイ
- 内部APIサービスの認証とアクセス制御を保護
- API保護のためのレート制限・サーキットブレーカーを実装
- 従来のサービスを外部APIとして公開
- AIアプリケーションのゲートウェイとしてLLMリクエストを管理
- ブル-green展開とカナリアリリースを実装

## まとめ

Apache APISIXは、強力で高性能、スケーラブルなクラウドネイティブAPIゲートウェイです。動的・リアルタイム・高性能特性を兼ね備え、認証、レート制限、モニタリングなどのエンタープライズ機能を 쉽게 管理できます。スタートアップ企業でも大企業でも、APISIXはあなたのAPIゲートウェイニーズを満たすことができます。
