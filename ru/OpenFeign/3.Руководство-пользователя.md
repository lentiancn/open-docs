# OpenFeign Руководство пользователя

## Базовое использование

### Создание Feign-клиента

Определите интерфейс с аннотацией `@FeignClient`:

```java
@FeignClient(name = "user-service", url = "https://api.users.com")
public interface UserClient {
    
    @RequestMapping(method = RequestMethod.GET, value = "/users/{id}")
    User getUserById(@PathVariable("id") Long id);
    
    @RequestMapping(method = RequestMethod.POST, value = "/users")
    User createUser(@RequestBody User user);
}
```

### Использование клиента

Внедрите и используйте клиент в вашем сервисе:

```java
@Service
public class UserService {
    
    @Autowired
    private UserClient userClient;
    
    public User getUser(Long id) {
        return userClient.getUserById(id);
    }
}
```

---

## Продвинутые функции

### Перехватчики запросов/ответов

```java
@Component
public class AuthInterceptor implements RequestInterceptor {
    
    @Override
    public void apply(RequestTemplate template) {
        template.header("Authorization", "Bearer " + getToken());
    }
}
```

### Обработка ошибок

```java
@Component
public class ErrorDecoder implements ErrorDecoder {
    
    @Override
    public Exception decode(String methodKey, Response response) {
        if (response.status() == 404) {
            return new NotFoundException("Resource not found");
        }
        return new RuntimeException("Unknown error: " + response.status());
    }
}
```

### Механизм Fallback

```java
@FeignClient(name = "user-service", fallback = UserClientFallback.class)
public interface UserClient {
    @RequestMapping(method = RequestMethod.GET, value = "/users/{id}")
    User getUser(@PathVariable("id") Long id);
}

@Component
public class UserClientFallback implements UserClient {
    
    @Override
    public User getUser(Long id) {
        return new User();
    }
}
```

---

## Конфигурация

```yaml
feign:
  client:
    config:
      default:
        connectTimeout: 5000
        readTimeout: 5000
        loggerLevel: basic
```
