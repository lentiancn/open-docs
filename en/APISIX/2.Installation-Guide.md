# APISIX Installation Guide

APISIX multiple installation methods explained in detail.

## Environment Requirements

### Hardware Requirements

- CPU: 2 cores and above
- Memory: 4GB and above
- Disk: 40GB and above

### Software Requirements

- Operating System: Linux (Ubuntu 20.04+, CentOS 7+ recommended)
- Nginx or OpenResty
- Lua 5.1+
- etcd 3.4+

## Docker Installation (Recommended)

### Quick Start

```bash
# Start etcd
docker run -d --name etcd \
  -p 2379:2379 \
  -e ETCD_ADVERTISE_CLIENT_URLS=http://127.0.0.1:2379 \
  -m 512M \
  apache/apisix:latest \
  etcd

# Start APISIX
docker run -d --name apisix \
  -p 9080:9080 \
  -p 9090:9090 \
  -v ./config.yaml:/usr/local/apisix/conf/config.yaml \
  apache/apisix:latest
```

### docker-compose Method

Create docker-compose.yaml:

```yaml
version: '3'

services:
  etcd:
    image: apache/apisix:3.5.0-etcd
    ports:
      - "2379:2379"
    environment:
      - ETCD_NAME=etcd
      - ETCD_ADVERTISE_CLIENT_URLS=http://127.0.0.1:2379
    volumes:
      - etcd-data:/etcd

  apisix:
    image: apache/apisix:3.5.0
    ports:
      - "9080:9080"
      - "9090:9090"
      - "9443:9443"
    depends_on:
      - etcd
    volumes:
      - ./config.yaml:/usr/local/apisix/conf/config.yaml

volumes:
  etcd-data:
```

Start services:

```bash
docker-compose up -d
```

## Helm Installation (Kubernetes)

### Add Repository

```bash
helm repo add apisix https://apache.github.io/apisix-helm-chart
helm repo update
```

### Install APISIX

```bash
# Install APISIX
helm install apisix apisix/apisix \
  --set gateway.type=LoadBalancer \
  --set admin.allow.ipList="0.0.0.0/0"

# Check status
helm status apisix
```

### Uninstall

```bash
helm uninstall apisix
```

## Source Installation

### Install Dependencies

**Ubuntu/Debian:**

```bash
# Install OpenResty
wget -qO - https://openresty.org/package/pubkey.gpg | sudo apt-key add -
sudo apt-get update
sudo apt-get install -y openresty

# Install etcd
sudo apt-get install -y etcd

# Install Lua dependencies
sudo apt-get install -y lua5.1 luarocks
```

**CentOS/RHEL:**

```bash
# Install OpenResty
sudo yum install -y openresty

# Install etcd
sudo yum install -y etcd
```

### Clone Source

```bash
git clone https://github.com/apache/apisix.git
cd apisix
git checkout 3.5.0
```

### Install Dependencies

```bash
# Install APISIX dependencies
make deps

# Initialize configuration
make init
```

### Start Services

```bash
# Start APISIX
make run

# Or run in background
nohup make run &
```

### Verify Installation

```bash
# Check process
ps aux | grep apisix

# Test API
curl http://127.0.0.1:9080
```

## Configuration

### Main Configuration File

Main config file at `conf/config.yaml`:

```yaml
apisix:
  node_listen: 9080           # API listening port
  enable_admin: true          # Enable Admin API
  admin_key:
    - name: admin
      key: 123456              # Change in production
      role: admin
  
  enable_cache: true          # Enable cache
  cache:
    cache_local: true
    redis:
      host: 127.0.0.1
      port: 6379
      password: ""
      database: 0

etcd:
  host:
    - "http://127.0.0.1:2379"
  prefix: /apisix
  timeout: 30

deployment:
  role: traditional
  role_traditional:
    config_provider: etcd
```

### Environment Variables

You can also configure via environment variables:

```bash
APISIX_DASHBOARD_PORT=9090 APISIX_LISTEN_PORT=9080 apisix start
```

## Admin API Configuration

### Enable Admin API

```yaml
apisix:
  enable_admin: true
  admin_key:
    - name: admin
      key: your-secret-key    # Change to strong key
      role: admin
```

### Access Control

```yaml
apisix:
  admin_api_mtls:
    enabled: true
    cert: /path/to/cert.pem
    key: /path/to/key.pem
```

## Common Issues

### Port Already in Use

```bash
# Check port usage
netstat -tlnp | grep 9080

# Change port
apisix:
  node_listen: 9081
```

### etcd Connection Failed

```bash
# Check etcd status
etcdctl endpoint health

# Start etcd
etcd --data-dir=/var/lib/etcd
```

### Permission Issues

```bash
# Grant directory permissions
sudo chown -R nobody:nobody /usr/local/apisix/logs
```

## Uninstall

### Docker Uninstall

```bash
docker stop apisix etcd
docker rm apisix etcd
```

### Source Install Uninstall

```bash
cd apisix
make stop
make uninstall
```

## Next Steps

- Configure your first route: See "User Manual"
- Configure plugins for authentication
- Configure load balancing
