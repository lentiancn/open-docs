# Node.js 安装指南

Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行时。本指南涵盖在所有环境中的安装方法。

## 版本信息

| 版本 | 状态 | 说明 |
|------|------|------|
| Node.js 22.x | ✅ 当前 | 最新 LTS 版本 |
| Node.js 20.x | ✅ LTS | 长期支持版本 |
| Node.js 18.x | ✅ LTS | 长期支持版本 |
| Node.js 16.x | ⚠️ 维护 | 仅安全更新 |
| Node.js 14.x | ❌ 旧版 | 已停止维护 |

> **重要提示**：本指南主要针对 **Node.js 20.x LTS**。建议新项目使用 LTS 版本。

## 安装方法

### 方法一：Windows 安装

#### 1. 使用安装程序（推荐）

1. 下载 Node.js 安装程序：https://nodejs.org/
2. 运行 .msi 安装程序
3. 按照安装向导完成安装

#### 2. 使用 Chocolatey

```powershell
# 安装 Node.js
choco install nodejs

# 安装特定版本
choco install nodejs --version=20.10.0
```

#### 3. 使用 winget

```powershell
# 安装 Node.js LTS
winget install OpenJS.NodeJS.LTS

# 安装特定版本
winget install OpenJS.NodeJS --version=20.10.0
```

### 方法二：macOS 安装

#### 1. 使用 Homebrew（推荐）

```bash
# 安装 Node.js LTS
brew install node@20

# 启动服务
brew services start node@20
```

#### 2. 使用 nvm

```bash
# 安装 nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# 安装 Node.js
nvm install 20
nvm use 20
nvm alias default 20
```

#### 3. 使用安装程序

下载 macOS 安装程序：https://nodejs.org/

### 方法三：Linux 安装

#### 1. 使用包管理器

**Ubuntu/Debian:**

```bash
# 添加 Node.js 仓库
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -

# 安装 Node.js
sudo apt-get install -y nodejs
```

**CentOS/RHEL:**

```bash
# 添加 Node.js 仓库
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -

# 安装 Node.js
sudo yum install -y nodejs
```

**Fedora:**

```bash
# 添加 Node.js 仓库
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -

# 安装 Node.js
sudo dnf install -y nodejs
```

#### 2. 使用 nvm（推荐）

```bash
# 安装 nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# 安装 Node.js
nvm install 20
nvm use 20
```

### 方法四：使用 fnm（快速节点版本管理器）

```bash
# 安装 fnm
curl -fsSL https://fnm.vercel.app/install | bash

# 安装 Node.js
fnm install 20
fnm use 20
fnm default 20
```

### 方法五：Docker

```bash
# 使用 Node.js 官方镜像
docker pull node:20

# 运行容器
docker run -it node:20 node --version
```

#### Dockerfile 示例

```dockerfile
FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

EXPOSE 3000
CMD ["node", "server.js"]
```

## 验证安装

### 检查版本

```bash
# 检查 Node.js 版本
node --version

# 检查 npm 版本
npm --version
```

### 升级 npm

```bash
# 升级 npm 到最新版本
npm install -g npm
```

## 包管理

### npm 常用命令

```bash
# 初始化项目
npm init

# 安装依赖
npm install

# 安装生产依赖
npm install <package>

# 安装开发依赖
npm install <package> --save-dev

# 全局安装
npm install -g <package>

# 更新依赖
npm update

# 删除依赖
npm uninstall <package>
```

### 使用 yarn

```bash
# 安装 yarn
npm install -g yarn

# 安装依赖
yarn install

# 添加依赖
yarn add <package>

# 全局安装
yarn global add <package>
```

### 使用 pnpm

```bash
# 安装 pnpm
npm install -g pnpm

# 安装依赖
pnpm install

# 添加依赖
pnpm add <package>
```

## 环境配置

### 使用 nvm 管理多版本

```bash
# 查看已安装版本
nvm list

# 安装新版本
nvm install 21

# 切换版本
nvm use 21

# 设置默认版本
nvm alias default 20
```

### 设置镜像源

```bash
# 设置 npm 镜像
npm config set registry https://registry.npmmirror.com

# 设置 yarn 镜像
yarn config set registry https://registry.npmmirror.com
```

## 常见问题

### Node.js 和 npm 版本不匹配？

使用 nvm 统一管理版本：

```bash
nvm use 20
```

### 安装失败（权限问题）？

```bash
# Linux/macOS 使用 sudo
sudo npm install -g <package>

# 或者修复 npm 权限
mkdir ~/.npm-global
npm config set prefix '~/.npm-global'
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc
source ~/.bashrc
```

### 构建失败？

清理缓存：

```bash
npm cache clean --force
```

## 相关链接

- [Node.js 官方网站](https://nodejs.org/)
- [Node.js 中文文档](https://nodejs.cn/)
- [npm 官方文档](https://docs.npmjs.com/)
- [nvm GitHub](https://github.com/nvm-sh/nvm)
