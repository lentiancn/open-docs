# GitLab 설치 가이드

> GitLab 설치 및 구성을 위한 완전한 가이드

---

## 시스템 요구사항

| 리소스 | 최소 | 권장 |
|--------|------|------|
| CPU | 2코어 | 4+코어 |
| 메모리 | 4GB | 8+GB |
| 저장소 | 10GB | 50+GB |
| OS | Ubuntu, Debian, CentOS, RHEL, Kubernetes | - |

---

## 설치 방법

### Omnibus 패키지 (Linux 권장)

#### Ubuntu/Debian

```bash
# 의존성 설치
sudo apt-get update
sudo apt-get install -y curl openssh-server ca-certificates tzdata perl

# GitLab 저장소 추가
curl -fsSL https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.deb.sh | sudo bash

# GitLab 설치
sudo EXTERNAL_URL="https://gitlab.example.com" apt-get install gitlab-ee
```

#### CentOS/RHEL

```bash
# 의존성 설치
sudo yum install -y curl policycoreutils openssh-server

# GitLab 저장소 추가
curl -fsSL https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash

# GitLab 설치
sudo EXTERNAL_URL="https://gitlab.example.com" yum install -y gitlab-ee
```

### Docker 설치

```bash
# GitLab Docker 이미지 풀
docker run --detach \
  --hostname gitlab.example.com \
  --publish 443:443 --publish 80:80 --publish 22:22 \
  --name gitlab \
  --restart always \
  --volume /srv/gitlab/config:/etc/gitlab \
  --volume /srv/gitlab/logs:/var/log/gitlab \
  --volume /srv/gitlab/data:/var/opt/gitlab \
  gitlab/gitlab-ee:latest
```

### Kubernetes 설치

```bash
# Helm 차트 사용
helm repo add gitlab https://charts.gitlab.io
helm install gitlab gitlab/gitlab \
  --set externalUrl="https://gitlab.example.com" \
  --set certmanager-issuer.email="admin@example.com"
```

---

## 초기 구성

### 외부 URL 구성

```bash
# GitLab 구성 파일 편집
sudo vim /etc/gitlab/gitlab.rb

# 외부 URL 설정
external_url 'https://gitlab.example.com'

# GitLab 재구성
sudo gitlab-ctl reconfigure
```

### SMTP 구성 (이메일)

```bash
# /etc/gitlab/gitlab.rb에서 SMTP 구성
gitlab_rails['smtp_enable'] = true
gitlab_rails['smtp_address'] = "smtp.example.com"
gitlab_rails['smtp_port'] = 587
gitlab_rails['smtp_user_name'] = "smtp_user"
gitlab_rails['smtp_password'] = "smtp_password"
gitlab_rails['smtp_domain'] = "example.com"

# 변경 사항 적용
sudo gitlab-ctl reconfigure
```

### Let's Encrypt로 HTTPS 활성화

```bash
# /etc/gitlab/gitlab.rb에서 구성
letsencrypt['enable'] = true
letsencrypt['contact_emails'] = ['admin@example.com']

# 재구성
sudo gitlab-ctl reconfigure
```

---

## 첫 번째 로그인

1. 외부 URL에서 GitLab에 액세스
2. 사용자 이름으로 로그인: `root`
3. 첫 방문 시 비밀번호 설정
4. 첫 번째 프로젝트 만들기

---

## 일반적인 명령

```bash
# 상태 확인
sudo gitlab-ctl status

# 서비스 시작
sudo gitlab-ctl start

# 서비스 중지
sudo gitlab-ctl stop

# 서비스 재시작
sudo gitlab-ctl restart

# 로그 보기
sudo gitlab-ctl tail

# 구성 확인
sudo gitlab-rake gitlab:env:info
```

---

## 문제 해결

### 설치 실패?

- 시스템 요구사항 확인
- 모든 의존성이 설치되었는지 확인
- 방화벽 및 SELinux 설정 확인
- 설치 로그 검토

### GitLab이 시작되지 않음?

```bash
# 포트 충돌 확인
sudo netstat -tulpn | grep -E ':(80|443|22)\s'

# 디스크 공간 확인
df -h

# 로그 검토
sudo gitlab-ctl tail
```

### 성능이 느림?

- 서버 리소스 증가
- Prometheus 메트릭 활성화
- 적절한 스왑 공간 구성
- PostgreSQL 튜닝 사용

---

## 자료

- 공식 설치 문서: https://docs.gitlab.com/ee/install/
- 하드웨어 요구사항: https://docs.gitlab.com/ee/install/requirements.html
- 커뮤니티 포럼: https://forum.gitlab.com/
