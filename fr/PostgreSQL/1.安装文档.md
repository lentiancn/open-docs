# Guide d'installation de PostgreSQL

PostgreSQL est un puissant système de base de données objet-relationnel open source. Ce guide couvre les méthodes d'installation dans tous les environnements.

## Informations de version

| Version | Statut | Description |
|---------|--------|--------------|
| PostgreSQL 16.x | ✅ Actuelle | Dernière version stable |
| PostgreSQL 15.x | ✅ Supportée | Version stable |
| PostgreSQL 14.x | ⚠️ Maintenance | Mises à jour de sécurité |
| PostgreSQL 13.x | ⚠️ Maintenance | Support à long terme |
| PostgreSQL 12.x | ❌ Obsolète | Plus supportée |

> **Important**: Ce guide concerne principalement **PostgreSQL 16.x**. Il est recommandé d'utiliser la dernière version pour les nouveaux projets.

## Configuration requise

### Matériel

| Exigence | Minimum | Recommandé |
|----------|---------|------------|
| CPU | 1 cœur | 2+ cœurs |
| Mémoire | 1 Go | 4+ Go |
| Disque | 10 Go | 50+ Go |

### Systèmes d'exploitation supportés

- **Linux**: Ubuntu, Debian, CentOS, RHEL, Fedora, openSUSE
- **Windows**: Windows Server 2016+, Windows 10+
- **macOS**: 10.14+

## Méthodes d'installation

### Méthode 1 : Installation sous Windows

#### 1. Utiliser l'installateur (recommandé)

1. Téléchargez l'installateur PostgreSQL : https://www.postgresql.org/download/windows/
2. Exécutez postgresql-16.x-x-windows-x64.exe
3. Suivez l'assistant d'installation
4. Définissez le mot de passe du superutilisateur postgres

#### 2. Utiliser Chocolatey

```powershell
# Installer PostgreSQL
choco install postgresql

# Installer une version spécifique
choco install postgresql --version=16.0
```

#### 3. Utiliser le ZIP

```powershell
# Télécharger le ZIP
# Extraire dans C:\Program Files\PostgreSQL\16

# Initialiser la base de données
"C:\Program Files\PostgreSQL\16\bin\initdb" -D "C:\Program Files\PostgreSQL\16\data"

# Démarrer le service
"C:\Program Files\PostgreSQL\16\bin\pg_ctl" -D "C:\Program Files\PostgreSQL\16\data" -l logfile start
```

### Méthode 2 : Installation sous macOS

#### 1. Utiliser Homebrew (recommandé)

```bash
# Installer PostgreSQL
brew install postgresql@16

# Démarrer le service
brew services start postgresql@16

# Arrêter le service
brew services stop postgresql@16
```

#### 2. Utiliser PostgreSQL.app

1. Téléchargez PostgreSQL.app : https://postgresapp.com/
2. Glissez dans le dossier Applications
3. Cliquez pour démarrer

#### 3. Utiliser MacPorts

```bash
sudo port install postgresql16
sudo port load postgresql16-server
```

### Méthode 3 : Installation sous Linux

#### Ubuntu/Debian

```bash
# Ajouter le dépôt officiel PostgreSQL
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'

# Importer la clé
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

# Mettre à jour la liste des paquets
sudo apt-get update

# Installer PostgreSQL
sudo apt-get install -y postgresql-16

# Démarrer le service
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

#### CentOS/RHEL

```bash
# Installer le dépôt RPM
sudo yum install -y https://download.postgresql.org/pub/repos/yum/16/redhat/rhel-9-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# Installer PostgreSQL
sudo yum install -y postgresql16-server

# Initialiser la base de données
sudo /usr/pgsql-16/bin/postgresql-16-setup initdb

# Démarrer le service
sudo systemctl start postgresql-16
sudo systemctl enable postgresql-16
```

#### Fedora

```bash
# Installer PostgreSQL
sudo dnf install -y postgresql-server postgresql-contrib

# Initialiser la base de données
sudo postgresql-setup --initdb

# Démarrer le service
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

### Méthode 4 : Installation avec Docker

```bash
# Télécharger l'image
docker pull postgres:16

# Lancer le conteneur
docker run -d \
  --name postgres \
  -e POSTGRES_PASSWORD=mysecretpassword \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_DB=mydb \
  -p 5432:5432 \
  -v postgres_data:/var/lib/postgresql/data \
  postgres:16
```

#### Docker Compose

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:16
    container_name: postgres
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: mysecretpassword
      POSTGRES_DB: mydb
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

Lancer :

```bash
docker-compose up -d
```

## Configuration post-installation

### Se connecter à PostgreSQL

```bash
# Utiliser psql
sudo -u postgres psql

# Ou
psql -U postgres -h localhost -p 5432
```

### Créer une base de données

```sql
CREATE DATABASE mydb;

-- Créer un utilisateur
CREATE USER myuser WITH PASSWORD 'mypassword';

-- Accorder les privilèges
GRANT ALL PRIVILEGES ON DATABASE mydb TO myuser;
```

### Fichiers de configuration

#### postgresql.conf

```properties
# Adresse d'écoute
listen_addresses = '*'

# Port
port = 5432

# Nombre max de connexions
max_connections = 100

# Tampon partagé
shared_buffers = 128MB

# Mémoire de travail
work_mem = 4MB
```

#### pg_hba.conf

```properties
# Autoriser les connexions locales
host    all             all             127.0.0.1/32            trust
host    all             all             ::1/128                 trust

# Autoriser les connexions distantes
host    all             all             0.0.0.0/0              md5
host    all             all             ::/0                    md5
```

### Configuration de connexion distante

```sql
-- Autoriser les connexions distantes
ALTER SYSTEM SET listen_addresses = '*';

-- Recharger la configuration
SELECT pg_reload_conf();
```

## Foire aux questions

### Connexion refusée ?

Vérifiez le pare-feu :

```bash
# Ubuntu
sudo ufw allow 5432/tcp

# CentOS
sudo firewall-cmd --add-port=5432/tcp --permanent
sudo firewall-cmd --reload
```

### Mot de passe postgres oublié ?

```bash
# Arrêter PostgreSQL
sudo systemctl stop postgresql

# Démarrer en mode bypass
sudo -u postgres /usr/lib/postgresql/16/bin/pg_ctl -D /var/lib/postgresql/16/main -m fast stop

# Changer le mot de passe
sudo -u postgres psql -c "ALTER USER postgres PASSWORD 'newpassword';"
```

### La base de données ne démarre pas ?

Vérifiez les logs :

```bash
# Voir les logs
tail -f /var/log/postgresql/postgresql-16-main.log
```

## Liens utiles

- [Site officiel PostgreSQL](https://www.postgresql.org/)
- [Documentation PostgreSQL](https://www.postgresql.org/docs/)
- [Outil pgAdmin](https://www.pgadmin.org/)
