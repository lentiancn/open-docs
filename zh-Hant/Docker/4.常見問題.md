# Docker 常見問題

常見問題解答。

## 安裝問題

### Q: Docker Desktop 在 Windows 上啟動失敗？

**解決方案**：
1. 在 BIOS 中啟用虛擬化
2. 安裝/更新 WSL 2
3. 重啟電腦
4. 檢查是否有衝突軟件（VirtualBox、VMware）

### Q: 出現 "docker: permission denied" 錯誤？

**解決方案**：
```
sudo usermod -aG docker $USER
# 註銷並重新登錄
```

### Q: 如何查看 Docker 版本？

```
docker --version
docker-compose --version
```

## 鏡像問題

### Q: 如何減小 Docker 鏡像大小？

**最佳實踐**：
1. 使用 alpine 基礎鏡像
2. 使用多階段構建
3. 最小化層數
4. 在同一層清理

### Q: 如何不使用緩存構建鏡像？

```
docker build --no-cache -t my-image .
```

### Q: 如何刪除所有未使用的鏡像？

```
docker image prune -a
```

## 容器問題

### Q: 如何保持容器運行？

```
docker run -d nginx tail -f /dev/null
# 或
docker run -d nginx sleep infinity
```

### Q: 容器啟動後立即退出？

**原因**：
1. 沒有前台進程
2. 進程已結束

**解決方案**：
```
docker run -it image_name /bin/bash
docker run -d image_name tail -f /dev/null
```

### Q: 如何進入運行中的容器？

```
docker exec -it container_id /bin/bash
```

### Q: 如何複製文件到/從容器？

```
# 從容器複製到主機
docker cp container_id:/path/file.txt ./

# 從主機複製到容器
docker cp ./file.txt container_id:/path/
```

## 網絡問題

### Q: 如何從主機訪問容器？

使用端口映射：
```
docker run -p 8080:80 nginx
```

### Q: 如何連接容器？

創建網絡：
```
docker network create my-network
docker run --network my-network -d nginx
```

## Volume 問題

### Q: 如何持久化數據？

使用 volume：
```
docker volume create my-data
docker run -v my-data:/data nginx
```

## Docker Compose

### Q: 代碼修改後如何重新構建？

```
docker-compose up -d --build
```

### Q: 如何查看日誌？

```
docker-compose logs -f
```

### Q: 如何擴展服務？

```
docker-compose up -d --scale web=3
```

## 性能問題

### Q: Docker 很慢 / 佔用太多磁盤？

**解決方案**：
```
docker system prune -a
docker system df
docker volume prune
```

### Q: 如何限制容器資源？

```
docker run -m 512m nginx
docker run --cpus=0.5 nginx
```

## 故障排除

### Q: 如何調試失敗的容器？

```
docker logs container_id
docker inspect container_id
```

### Q: 容器網絡不工作？

```
sudo systemctl restart docker
docker network ls
```

## 安全問題

### Q: 如何掃描漏洞？

```
docker scan my-image
```

### Q: 應該以 root 運行嗎？

不應該，創建非 root 用戶：

```
FROM node:18-alpine
RUN addgroup -g 1000 appgroup && \
    adduser -u 1000 -G appgroup -D appuser
USER appuser
```

## Docker vs 虛擬機

### Q: Docker 和虛擬機的區別？

| 方面 | Docker | 虛擬機 |
|------|--------|--------|
| 操作系統 | 共享主機內核 | 獨立操作系統 |
| 大小 | MB 級別 | GB 級別 |
| 啟動 | 秒級 | 分鐘級 |
| 隔離 | 容器級別 | 完全隔離 |

## 學習資源

- 官方文檔：https://docs.docker.com
- 交互式實驗室：https://labs.play-with-docker.com
- Docker 社區：https://www.docker.com/community
