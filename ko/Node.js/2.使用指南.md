# Node.js 사용 가이드

이 가이드에서는 Node.js를 사용하여 백엔드 애플리케이션과 명령줄 도구를 만드는 방법을 설명합니다.

## 빠른 시작

### 첫 번째 애플리케이션 만들기

```javascript
// hello.js
console.log('Hello, Node.js!');

// 실행
node hello.js
```

### HTTP 서버 만들기

```javascript
// server.js
const http = require('http');

const server = http.createServer((req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.end('Hello World!');
});

server.listen(3000, () => {
  console.log('서버가 http://localhost:3000/에서 실행 중');
});
```

실행:

```bash
node server.js
```

## 핵심 모듈

### fs - 파일 시스템

```javascript
const fs = require('fs');

// 파일 읽기
fs.readFile('file.txt', 'utf8', (err, data) => {
  if (err) throw err;
  console.log(data);
});

// 파일 쓰기
fs.writeFile('file.txt', 'Hello!', (err) => {
  if (err) throw err;
  console.log('파일 저장됨');
});

// 동기 읽기
const data = fs.readFileSync('file.txt', 'utf8');
```

### path - 경로

```javascript
const path = require('path');

path.join('/foo', 'bar', 'baz'); // /foo/bar/baz
path.resolve(__dirname, 'file.txt'); // 절대 경로
path.extname('file.txt'); // .txt
path.basename('/foo/bar.txt'); // bar.txt
```

### os - 운영 체제

```javascript
const os = require('os');

os.platform(); // 'win32', 'linux', 'darwin'
os.arch(); // 'x64', 'arm64'
os.cpus(); // CPU 정보
os.freemem(); // 여유 메모리
os.totalmem(); // 전체 메모리
```

### events - 이벤트

```javascript
const EventEmitter = require('events');

class MyEmitter extends EventEmitter {}

const myEmitter = new MyEmitter();

myEmitter.on('event', () => {
  console.log('이벤트 발생!');
});

myEmitter.emit('event');
```

### crypto - 암호화

```javascript
const crypto = require('crypto');

const hash = crypto.createHash('sha256');
hash.update('password');
const password = hash.digest('hex');
```

## NPM 사용

### package.json

```json
{
  "name": "my-app",
  "version": "1.0.0",
  "description": "내 앱",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js",
    "test": "jest"
  },
  "keywords": ["nodejs", "express"],
  "author": "이름",
  "license": "MIT",
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "nodemon": "^3.0.0"
  }
}
```

### 의존성 설치

```bash
# 모든 의존성 설치
npm install

# 프로덕션 의존성 설치
npm install express

# 개발 의존성 설치
npm install nodemon --save-dev

# 전역 설치
npm install -g nodemon
```

## Express 프레임워크

### 설치

```bash
npm install express
```

### 애플리케이션 만들기

```javascript
const express = require('express');
const app = express();

app.get('/', (req, res) => {
  res.send('Hello World!');
});

app.listen(3000, () => {
  console.log('애플리케이션이 http://localhost:3000에서 실행 중');
});
```

### 라우팅

```javascript
// GET 라우트
app.get('/api/users', (req, res) => {
  res.json({ users: [] });
});

// POST 라우트
app.post('/api/users', (req, res) => {
  const user = req.body;
  res.json({ success: true, user });
});

// 파라미터 라우트
app.get('/api/users/:id', (req, res) => {
  const { id } = req.params;
  res.json({ id });
});
```

### 미들웨어

```javascript
// JSON 파싱
app.use(express.json());

// URL 인코딩 데이터 파싱
app.use(express.urlencoded({ extended: true }));

// 로깅 미들웨어
app.use((req, res, next) => {
  console.log(`${req.method} ${req.url}`);
  next();
});

// 에러 처리
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).send('Something broke!');
});
```

## 비동기 프로그래밍

### 콜백

```javascript
fs.readFile('file.txt', 'utf8', (err, data) => {
  if (err) throw err;
  console.log(data);
});
```

### 프로미스

```javascript
const fs = require('fs').promises;

async function read() {
  try {
    const data = await fs.readFile('file.txt', 'utf8');
    console.log(data);
  } catch (err) {
    console.error(err);
  }
}

read();
```

### Async/Await

```javascript
const axios = require('axios');

async function fetchData() {
  try {
    const response = await axios.get('https://api.example.com/data');
    console.log(response.data);
  } catch (error) {
    console.error(error);
  }
}

fetchData();
```

## 모듈 시스템

### 모듈 내보내기

```javascript
// math.js
module.exports = {
  add: (a, b) => a + b,
  subtract: (a, b) => a - b,
};

// 또는 ES6 사용
export const add = (a, b) => a + b;
export default { add };
```

### 모듈 가져오기

```javascript
// CommonJS
const math = require('./math');
console.log(math.add(2, 3));

// ES6
import { add } from './math';
console.log(add(2, 3));
```

## 명령줄 도구

### CLI 애플리케이션 만들기

```javascript
#!/usr/bin/env node

console.log('Hello CLI!');

// commander 사용
const { program } = require('commander');

program
  .name('my-cli')
  .description('CLI to do something')
  .version('1.0.0');

program.parse();
```

### 스크립트 실행 가능하게 만들기

```bash
chmod +x myscript.js
./myscript.js
```

## 디버깅

### nodemon 사용

```bash
# 설치
npm install -g nodemon

# 실행
nodemon server.js

# 특정 파일 감시
nodemon --watch src --ext js server.js
```

### VS Code로 디버깅

```json
// .vscode/launch.json
{
  "type": "node",
  "request": "launch",
  "name": "프로그램 시작",
  "program": "${workspaceFolder}/index.js"
}
```

## 모범 사례

### 1. async/await 사용

```javascript
// 피하기
getData((err, data) => {
  if (err) handleError(err);
  processData(data, (err, result) => {
    if (err) handleError(err);
    saveResult(result);
  });
});

// 권장
async function main() {
  try {
    const data = await getData();
    const result = await processData(data);
    await saveResult(result);
  } catch (err) {
    handleError(err);
  }
}
```

### 2. 에러 처리

```javascript
// 항상 비동기 에러 잡기
async function fetchData() {
  try {
    const response = await fetch(url);
    return await response.json();
  } catch (error) {
    console.error('데이터 가져오기 실패:', error);
    throw error;
  }
}
```

### 3. 환경 변수 사용

```javascript
require('dotenv').config();

const port = process.env.PORT || 3000;
const dbUrl = process.env.DATABASE_URL;
```

## 관련 자료

- [Node.js 공식 문서](https://nodejs.org/docs/)
- [Express 문서](https://expressjs.com/)
- [npm 공식 문서](https://docs.npmjs.com/)
