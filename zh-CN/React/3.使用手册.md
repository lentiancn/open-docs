# React 使用手册

本手册介绍 React 的核心概念和实际使用方法。

## 基础语法

### JSX 基础

```jsx
// 变量和表达式
const name = 'Tom';
const element = <h1>Hello, {name}!</h1>;

// 属性
const img = <img src="/logo.png" alt="Logo" />;

// 子元素
const div = (
  <div>
    <h1>标题</h1>
    <p>内容</p>
  </div>
);

// 样式
const style = {
  color: 'red',
  fontSize: '16px'
};
const styled = <p style={style}>红色文字</p>;
```

### 组件定义

```jsx
// 函数组件（推荐）
function Welcome({ name }) {
  return <h1>Hello, {name}!</h1>;
}

// 箭头函数组件
const Welcome = ({ name }) => <h1>Hello, {name}!</h1>;

// 使用组件
<Welcome name="Tom" />
```

### Props

```jsx
// 组件接收 props
function UserCard({ name, age, email }) {
  return (
    <div className="user-card">
      <h2>{name}</h2>
      <p>年龄: {age}</p>
      <p>邮箱: {email}</p>
    </div>
  );
}

// 使用
<UserCard name="Tom" age={25} email="tom@example.com" />
```

### State

```jsx
import { useState } from 'react';

function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <p>计数: {count}</p>
      <button onClick={() => setCount(count + 1)}>
        增加
      </button>
      <button onClick={() => setCount(count - 1)}>
        减少
      </button>
    </div>
  );
}
```

### 多个 State

```jsx
function Form() {
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  const [age, setAge] = useState(0);
  
  return (
    <form>
      <input 
        value={name} 
        onChange={e => setName(e.target.value)} 
        placeholder="姓名"
      />
      <input 
        value={email} 
        onChange={e => setEmail(e.target.value)} 
        placeholder="邮箱"
      />
      <input 
        type="number"
        value={age} 
        onChange={e => setAge(e.target.value)} 
        placeholder="年龄"
      />
    </form>
  );
}
```

### 复杂 State

```jsx
function App() {
  const [user, setUser] = useState({
    name: 'Tom',
    age: 25,
    email: 'tom@example.com'
  });
  
  function updateName(name) {
    setUser({ ...user, name });
  }
  
  return (
    <div>
      <p>{user.name}</p>
      <button onClick={() => updateName('Jerry')}>
        修改姓名
      </button>
    </div>
  );
}
```

## Hooks

### useEffect

```jsx
import { useEffect, useState } from 'react';

function DataFetcher() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    // 组件挂载时执行
    fetch('/api/data')
      .then(res => res.json())
      .then(result => {
        setData(result);
        setLoading(false);
      });
      
    // 组件卸载时清理
    return () => {
      // 清理操作
    };
  }, []); // 空数组表示只执行一次
  
  if (loading) return <div>加载中...</div>;
  
  return <div>{data}</div>;
}
```

### useEffect 多种用法

```jsx
function App() {
  const [count, setCount] = useState(0);
  const [data, setData] = useState(null);
  
  // 1. 只在挂载时执行
  useEffect(() => {
    console.log('挂载');
  }, []);
  
  // 2. count 变化时执行
  useEffect(() => {
    console.log('count 变化:', count);
  }, [count]);
  
  // 3. 任何 state 变化时执行
  useEffect(() => {
    console.log('任何变化');
  });
  
  // 4. 清理函数
  useEffect(() => {
    const timer = setInterval(() => {
      console.log('定时器');
    }, 1000);
    
    return () => clearInterval(timer);
  }, []);
  
  return <button onClick={() => setCount(count + 1)}>{count}</button>;
}
```

### useRef

```jsx
import { useRef } from 'react';

function TextInput() {
  const inputRef = useRef(null);
  
  function handleClick() {
    inputRef.current.focus();
  }
  
  return (
    <div>
      <input ref={inputRef} type="text" />
      <button onClick={handleClick}>聚焦</button>
    </div>
  );
}
```

### useContext

```jsx
import { createContext, useContext, useState } from 'react';

// 创建 Context
const ThemeContext = createContext();

function App() {
  const [theme, setTheme] = useState('light');
  
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      <Toolbar />
    </ThemeContext.Provider>
  );
}

function Toolbar() {
  const { theme, setTheme } = useContext(ThemeContext);
  
  return (
    <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
      当前主题: {theme}
    </button>
  );
}
```

### useReducer

```jsx
import { useReducer } from 'react';

function reducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 };
    case 'decrement':
      return { count: state.count - 1 };
    default:
      return state;
  }
}

function Counter() {
  const [state, dispatch] = useReducer(reducer, { count: 0 });
  
  return (
    <div>
      <p>计数: {state.count}</p>
      <button onClick={() => dispatch({ type: 'increment' })}>
        增加
      </button>
      <button onClick={() => dispatch({ type: 'decrement' })}>
        减少
      </button>
    </div>
  );
}
```

### 自定义 Hook

```jsx
import { useState, useEffect } from 'react';

function useWindowSize() {
  const [size, setSize] = useState({
    width: window.innerWidth,
    height: window.innerHeight
  });
  
  useEffect(() => {
    function handleResize() {
      setSize({
        width: window.innerWidth,
        height: window.innerHeight
      });
    }
    
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);
  
  return size;
}

function App() {
  const { width, height } = useWindowSize();
  
  return (
    <div>
      窗口大小: {width} x {height}
    </div>
  );
}
```

## 事件处理

### 表单处理

```jsx
function Form() {
  const [value, setValue] = useState('');
  
  function handleSubmit(e) {
    e.preventDefault();
    console.log('提交:', value);
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <input 
        value={value}
        onChange={e => setValue(e.target.value)}
      />
      <button type="submit">提交</button>
    </form>
  );
}
```

### 受控组件

```jsx
function ControlledForm() {
  const [form, setForm] = useState({
    username: '',
    email: '',
    password: ''
  });
  
  function handleChange(e) {
    const { name, value } = e.target;
    setForm({ ...form, [name]: value });
  }
  
  function handleSubmit(e) {
    e.preventDefault();
    console.log(form);
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <input 
        name="username"
        value={form.username}
        onChange={handleChange}
        placeholder="用户名"
      />
      <input 
        name="email"
        type="email"
        value={form.email}
        onChange={handleChange}
        placeholder="邮箱"
      />
      <input 
        name="password"
        type="password"
        value={form.password}
        onChange={handleChange}
        placeholder="密码"
      />
      <button type="submit">提交</button>
    </form>
  );
}
```

## 列表和 Keys

### 渲染列表

```jsx
function List({ items }) {
  return (
    <ul>
      {items.map(item => (
        <li key={item.id}>
          {item.name} - {item.price}
        </li>
      ))}
    </ul>
  );
}
```

### 过滤和排序

```jsx
function ProductList({ products }) {
  const [filter, setFilter] = useState('');
  
  const filtered = products
    .filter(p => p.name.includes(filter))
    .sort((a, b) => a.price - b.price);
  
  return (
    <div>
      <input 
        value={filter}
        onChange={e => setFilter(e.target.value)}
        placeholder="搜索"
      />
      <ul>
        {filtered.map(p => (
          <li key={p.id}>{p.name} - ¥{p.price}</li>
        ))}
      </ul>
    </div>
  );
}
```

## 条件渲染

```jsx
function LoginButton({ onLogin, onLogout, isLoggedIn }) {
  if (isLoggedIn) {
    return <button onClick={onLogout}>退出</button>;
  }
  
  return <button onClick={onLogin}>登录</button>;
}

// 三元运算符
function Greeting({ user }) {
  return (
    <div>
      {user ? <h1>欢迎 {user.name}</h1> : <h1>请登录</h1>}
    </div>
  );
}

// && 运算符
function Notification({ unread }) {
  return (
    <div>
      {unread.length > 0 && (
        <p>有 {unread.length} 条未读消息</p>
      )}
    </div>
  );
}
```

## 组件通信

### 父子通信

```jsx
// 父组件
function Parent() {
  const [message, setMessage] = useState('');
  
  return (
    <Child 
      message={message}
      onChange={setMessage}
    />
  );
}

// 子组件
function Child({ message, onChange }) {
  return (
    <input 
      value={message}
      onChange={e => onChange(e.target.value)}
    />
  );
}
```

### 跨级通信

```jsx
// 使用 Context
const Context = createContext();

function Parent() {
  return (
    <Context.Provider value="Hello">
      <Child />
    </Context.Provider>
  );
}

function Child() {
  const value = useContext(Context);
  return <p>{value}</p>;
}
```

## 样式

### 内联样式

```jsx
function StyledButton() {
  const style = {
    padding: '10px 20px',
    backgroundColor: '#007bff',
    color: 'white',
    border: 'none',
    borderRadius: '4px',
    cursor: 'pointer'
  };
  
  return <button style={style}>按钮</button>;
}
```

### CSS Modules

```jsx
// Button.module.css
.button {
  padding: 10px 20px;
  background: #007bff;
  color: white;
}

// Button.jsx
import styles from './Button.module.css';

function Button({ children }) {
  return <button className={styles.button}>{children}</button>;
}
```

### Styled Components

```jsx
import styled from 'styled-components';

const Button = styled.button`
  padding: 10px 20px;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 4px;
  
  &:hover {
    background: #0056b3;
  }
`;

function App() {
  return <Button>按钮</Button>;
}
```

## 路由

### 基本配置

```jsx
import { BrowserRouter, Routes, Route, Link } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <nav>
        <Link to="/">首页</Link>
        <Link to="/about">关于</Link>
      </nav>
      
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
        <Route path="/user/:id" element={<User />} />
      </Routes>
    </BrowserRouter>
  );
}
```

### 路由参数

```jsx
import { useParams } from 'react-router-dom';

function User() {
  const { id } = useParams();
  return <h1>用户 ID: {id}</h1>;
}
```

## 总结

本手册涵盖了 React 开发的核心知识点：

- **JSX**：模板语法
- **组件**：函数组件、Props
- **State**：useState
- **Hooks**：useEffect、useRef、useContext、useReducer
- **事件**：表单处理、受控组件
- **列表**：map、key
- **条件**：if、三元、&&
- **样式**：内联、CSS Modules、Styled Components
- **路由**：BrowserRouter、Routes、Route

掌握这些内容后，你就可以开始 React 项目开发了。
