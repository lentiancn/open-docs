# Redis 使用指南

高效使用 Redis 的完整指南。

---

## 基本概念

### 什么是 Redis？

Redis 是一个开源的内存数据结构存储系统，用作数据库、缓存和消息中间件。

### 支持的数据类型

| 类型 | 说明 |
|------|------|
| String | 字符串 |
| List | 列表 |
| Hash | 哈希表 |
| Set | 集合 |
| Sorted Set | 有序集合 |

---

## 字符串操作

### 基础命令

```bash
# 设置值
SET key "value"

# 获取值
GET key

# 设置多个键
MSET key1 "value1" key2 "value2"

# 获取多个键
MGET key1 key2
```

### 数字操作

```bash
# 递增
INCR counter
INCRBY counter 10

# 递减
DECR counter
DECRBY counter 5
```

---

## 列表操作

```bash
# 左边插入
LPUSH mylist "first"

# 右边插入
RPUSH mylist "last"

# 左边弹出
LPOP mylist

# 获取范围
LRANGE mylist 0 -1
```

---

## 哈希操作

```bash
# 设置哈希字段
HSET user:1 name "John"

# 获取哈希字段
HGET user:1 name

# 获取所有字段和值
HGETALL user:1
```

---

## 集合操作

```bash
# 添加到集合
SADD myset "member1"

# 移除
SREM myset "member1"

# 获取所有成员
SMEMBERS myset

# 检查成员
SISMEMBER myset "member1"
```

---

## 有序集合操作

```bash
# 添加到有序集合
ZADD leaderboard 100 "player1"

# 获取排名（降序）
ZREVRANGE leaderboard 0 -1 WITHSCORES
```

---

## 键管理

```bash
# 删除键
DEL key

# 检查键是否存在
EXISTS key

# 设置过期时间（秒）
EXPIRE key 60

# 查看剩余时间
TTL key
```

---

## 发布/订阅

```bash
# 订阅频道
SUBSCRIBE mychannel

# 发布消息
PUBLISH mychannel "Hello"
```

---

## 事务

```bash
# 开始事务
MULTI

# 队列命令
SET key1 "value1"
SET key2 "value2"

# 执行事务
EXEC

# 取消事务
DISCARD
```

---

## 持久化

### RDB

```bash
# 手动保存
BGSAVE
```

### AOF

```bash
# 在配置中启用
appendonly yes

# 重写 AOF
BGREWRITEAOF
```

---

## 安全性

### 密码认证

```bash
# 在配置中设置密码
requirepass yourpassword

# 通过 CLI 认证
AUTH yourpassword
```

---

## 性能优化

### 内存优化

```bash
# 设置最大内存
maxmemory 2gb

# 淘汰策略
maxmemory-policy allkeys-lru
```

---

## 常用示例

### 缓存

```bash
# 带过期时间的缓存
SET user:1:profile "data" EX 3600
```

### 限流

```bash
# 简单限流
INCR rate_limit:ip:192.168.1.1
EXPIRE rate_limit:ip:192.168.1.1 60
```

### 分布式锁

```bash
# 获取锁
SET lock:myresource unique_value NX EX 10
```

---

## 下一步

- 探索 [Redis Stack](https://redis.io/docs/stack/)
- 学习 [Redis 集群](https://redis.io/docs/management/scaling/)
