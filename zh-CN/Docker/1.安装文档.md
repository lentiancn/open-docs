# Docker 安装文档

在所有主流平台上安装 Docker 的完整指南。

---

## 目录

- [Linux](#linux)
  - [Ubuntu/Debian](#ubuntudebian)
  - [CentOS/RHEL](#centosrhel)
  - [Fedora](#fedora)
  - [Arch Linux](#arch-linux)
- [macOS](#macos)
  - [Homebrew](#homebrew)
  - [DMG 包](#dmg-包)
- [Windows](#windows)
  - [WSL2（推荐）](#wsl2推荐)
  - [Docker Desktop](#docker-desktop)
- [验证安装](#验证安装)
- [安装后配置](#安装后配置)
- [卸载](#卸载)

---

## Linux

### Ubuntu / Debian

#### 方法一：APT 仓库（推荐）

```bash
# 更新软件包索引
sudo apt update

# 安装依赖
sudo apt install -y ca-certificates curl gnupg lsb-release

# 添加 Docker 官方 GPG 密钥
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# 添加 Docker 仓库
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# 安装 Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 启动并开机自启
sudo systemctl start docker
sudo systemctl enable docker

# 添加当前用户到 docker 组
sudo usermod -aG docker $USER
```

#### 方法二：Docker

```bash
# 拉取 Docker 镜像
docker pull mysql:latest

# 运行 Docker 容器
docker run -d \
  --name mysql \
  -e MYSQL_ROOT_PASSWORD=your_password \
  -v mysql-data:/var/lib/mysql \
  -p 3306:3306 \
  mysql:latest
```

### CentOS / RHEL

#### 使用 YUM 仓库

```bash
# 安装依赖
sudo yum install -y yum-utils

# 添加 Docker 仓库
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

# 安装 Docker
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 启动并开机自启
sudo systemctl start docker
sudo systemctl enable docker
```

### Fedora

```bash
# 安装依赖
sudo dnf -y install dnf-plugins-core

# 添加 Docker 仓库
sudo dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo

# 安装 Docker
sudo dnf install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 启动并开机自启
sudo systemctl start docker
sudo systemctl enable docker
```

### Arch Linux

```bash
# 安装 Docker
sudo pacman -S docker

# 启动并开机自启
sudo systemctl start docker
sudo systemctl enable docker
```

---

## macOS

### Homebrew（推荐）

```bash
# 安装 Homebrew（如需要）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 Docker
brew install --cask docker

# 启动 Docker
brew services start docker
```

### DMG 包

1. 从 Docker 官网下载 Docker Desktop for Mac
2. 安装 .dmg 包
3. 从 Applications 文件夹运行 Docker

---

## Windows

### WSL2（推荐）

```powershell
# 1. 启用 WSL2
wsl --install

# 2. 重启电脑

# 3. 在 WSL2 中安装 Docker
sudo apt update
sudo apt install -y docker.io
sudo service docker start
```

### Docker Desktop

1. **下载**：Docker Desktop for Windows
2. **安装**：运行安装程序
3. **启用 WSL2**：当提示时启用（推荐）
4. **启动**：打开 Docker Desktop

**系统要求：**
- Windows 10/11 64 位
- 启用 WSL2
- 启用 Hyper-V（Windows 10）

---

## 验证安装

```bash
# 检查 Docker 版本
docker --version

# 检查 Docker Compose 版本
docker compose version

# 运行测试容器
docker run hello-world
```

---

## 安装后配置

### Linux：非 root 用户运行 Docker

```bash
# 创建 docker 组
sudo groupadd docker

# 将用户添加到 docker 组
sudo usermod -aG docker $USER

# 重新登录使更改生效
```

---

## 卸载

### Ubuntu/Debian

```bash
# 停止 Docker
sudo systemctl stop docker

# 卸载软件包
sudo apt purge -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo apt autoremove

# 删除数据目录
sudo rm -rf /var/lib/docker
```

### macOS (Homebrew)

```bash
# 停止 Docker
brew services stop docker

# 卸载
brew uninstall --cask docker

# 删除数据
rm -rf ~/Library/Containers/com.docker.docker
```

### Windows

打开 Docker Desktop → 设置 → 故障排除 → 清除/删除数据

---

## 下一步

- [使用指南](./2.使用指南.md)
- 阅读 [官方 Docker 文档](https://docs.docker.com/)
