# Docker Frequently Asked Questions

This page compiles the most common questions and solutions during Docker usage.

---

## Table of Contents

1. [Installation Issues](#installation-issues)
2. [Image Issues](#image-issues)
3. [Container Issues](#container-issues)
4. [Network Issues](#network-issues)
5. [Volume Issues](#volume-issues)
6. [Performance Issues](#performance-issues)
7. [Docker Compose Issues](#docker-compose-issues)
8. [Licensing and Subscriptions](#licensing-and-subscriptions)

---

## Installation Issues

### Q1: Docker Desktop Fails to Start on Windows

**Possible causes**:
- WSL or Hyper-V not enabled
- Virtualization not enabled in BIOS/UEFI

**Solutions**:

1. Check if virtualization is enabled:
   ```powershell
   systeminfo | findstr /C:"Hyper-V"
   ```

2. Enable WSL:
   ```powershell
   wsl --install
   ```

3. Make sure virtualization is enabled in BIOS/UEFI

### Q2: Docker Permission Denied

**Error message**:
```
permission denied while trying to connect to the Docker daemon socket
```

**Solution**:

Add current user to docker group:
```bash
sudo usermod -aG docker $USER
```

Then log out and log back in.

### Q3: Port Conflict

**Error message**:
```
Error starting userland proxy: listen tcp4 0.0.0.0:80: bind: address already in use
```

**Solutions**:

1. Find process using the port:
   ```bash
   # Linux
   sudo lsof -i :80
   
   # Windows
   netstat -ano | findstr :80
   ```

2. Stop the process using the port, or use a different port:
   ```bash
   docker run -d -p 8080:80 nginx
   ```

---

## Image Issues

### Q4: Image Pull Fails

**Possible causes**:
- Network issues
- Image registry unavailable
- Authentication issues

**Solutions**:

1. Check network connection:
   ```bash
   docker pull hello-world
   ```

2. Configure image accelerator (China region):
   ```bash
   # Edit Docker configuration
   sudo vi /etc/docker/daemon.json
   
   # Add the following
   {
     "registry-mirrors": [
       "https://docker.mirrors.ustc.edu.cn",
       "https://hub-mirror.c.163.com"
     ]
   }
   
   # Restart Docker
   sudo systemctl restart docker
   ```

3. Login to private registry:
   ```bash
   docker login myregistry.com
   ```

### Q5: Image Build Fails

**Common errors**:
- Cache issues
- Dependency installation failed
- File path errors

**Solutions**:

1. Clear build cache:
   ```bash
   docker builder prune
   ```

2. Use `--no-cache` to force rebuild:
   ```bash
   docker build --no-cache -t myapp .
   ```

3. Check Dockerfile syntax and paths

### Q6: Image Size Too Large

**Solutions**:

1. Use multi-stage builds
2. Use lightweight base images (like alpine)
3. Clean unnecessary files:
   ```dockerfile
   RUN apt-get clean && rm -rf /var/lib/apt/lists/*
   ```

---

## Container Issues

### Q7: Container Won't Start

**Solutions**:

1. View container logs:
   ```bash
   docker logs <container_name>
   ```

2. Check container configuration:
   ```bash
   docker inspect <container_name>
   ```

3. Check resource limits:
   ```bash
   docker stats <container_name>
   ```

### Q8: Container Stops Automatically

**Possible causes**:
- Process in container completed
- Out of memory
- Health check failed

**Solutions**:

1. Use `-d` daemon mode:
   ```bash
   docker run -d myapp
   ```

2. Set restart policy:
   ```bash
   docker run -d --restart=always myapp
   ```

### Q9: Cannot Use vim/vi After Entering Container

**Solutions**:

Install text editor:
```bash
apt-get update && apt-get install -y vim
```

Or use other tools:
```bash
cat file.txt          # View file
echo "text" > file   # Write file
```

### Q10: Chinese Characters Garbled in Container

**Solutions**:

Set environment variables:
```dockerfile
ENV LANG=C.UTF-8 LC_ALL=C.UTF-8
```

---

## Network Issues

### Q11: Container Cannot Access External Network

**Solutions**:

1. Check Docker network:
   ```bash
   docker network ls
   docker network inspect bridge
   ```

2. Restart Docker service:
   ```bash
   # Linux
   sudo systemctl restart docker
   
   # Windows
   # Restart Docker Desktop
   ```

3. Check firewall rules

### Q12: Containers Cannot Communicate

**Solutions**:

1. Ensure containers are on the same network:
   ```bash
   docker network inspect my-network
   ```

2. Use container names for communication (requires custom network):
   ```bash
   docker network create my-network
   docker run --network my-network --name web webapp
   docker run --network my-network --name db dbapp
   # Now web can access db via db
   ```

### Q13: Port Mapping Not Working

**Solutions**:

1. Check if port is correctly mapped:
   ```bash
   docker port <container>
   ```

2. Confirm service inside container is listening:
   ```bash
   # Inside container
   netstat -tlnp
   # Make sure it's listening on 0.0.0.0, not 127.0.0.1
   ```

---

## Volume Issues

### Q14: Volume Permission Issues

**Error message**:
```
permission denied while trying to connect to the docker socket
```

**Solutions**:

1. Specify user when mounting:
   ```bash
   docker run -v /host/path:/container/path -u 1000 myapp
   ```

2. Set permissions in Dockerfile:
   ```dockerfile
   RUN chown -R appuser:appuser /app/data
   ```

### Q15: Data Not Persisting

**Solutions**:

1. Use named volumes instead of bind mounts:
   ```bash
   docker run -v my-volume:/app/data myapp
   ```

2. Ensure application is configured with correct write path

### Q16: Data Lost After Deleting Container

**Solutions**:

1. Use volumes to persist data:
   ```bash
   docker volume create my-data
   docker run -v my-data:/app/data myapp
   ```

2. Regularly backup volumes:
   ```bash
   docker run --rm -v my-data:/data -v $(pwd):/backup alpine tar czf /backup/backup.tar.gz /data
   ```

---

## Performance Issues

### Q17: Docker Running Slowly

**Solutions**:

1. Allocate more resources to Docker Desktop:
   - Docker Desktop > Settings > Resources

2. Clean unused resources:
   ```bash
   docker system prune -a
   ```

3. Move Docker data directory to larger disk

### Q18: Disk Space Full

**Solutions**:

1. Clean unused images:
   ```bash
   docker image prune -a
   ```

2. Clean build cache:
   ```bash
   docker builder prune
   ```

3. Clean stopped containers:
   ```bash
   docker container prune
   ```

4. Clean volumes:
   ```bash
   docker volume prune
   ```

### Q19: Container Memory Usage Too High

**Solutions**:

1. Limit container memory:
   ```bash
   docker run -m 512m myapp
   ```

2. Set memory swap limit:
   ```bash
   docker run -m 512m --memory-swap 1g myapp
   ```

---

## Docker Compose Issues

### Q20: Docker Compose Fails to Start

**Solutions**:

1. Check docker-compose.yml syntax:
   ```bash
   docker-compose config
   ```

2. View detailed errors:
   ```bash
   docker-compose up
   ```

### Q21: Service Dependency Issues

**Solutions**:

Use `depends_on` with wait logic:
```yaml
services:
  web:
    build: .
    depends_on:
      db:
        condition: service_healthy
  db:
    image: postgres
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 5s
      timeout: 5s
      retries: 5
```

### Q22: Environment Variables Not Taking Effect

**Solutions**:

1. Check .env file location:
   - Must be in directory where docker-compose is run
   - File must be named `.env`

2. Reference in docker-compose.yml:
   ```yaml
   services:
     web:
       image: myapp
       environment:
         - DB_HOST=${DB_HOST}
   ```

---

## Licensing and Subscriptions

### Q23: Does Docker Desktop Require Payment?

**Free for**:
- Small businesses (fewer than 250 employees AND less than $10 million in annual revenue)
- Personal use
- Education
- Non-commercial open source projects

**Paid for**:
- Commercial use exceeding the above limits

See [Docker Subscriptions and Pricing](https://www.docker.com/pricing/) for details.

### Q24: How to Apply for Education/Open Source Free License?

1. Visit [Docker Hub](https://hub.docker.com/)
2. Log in to your account
3. Go to Account Settings > Subscription
4. Choose the appropriate free plan

---

## Get More Help

- [Docker Official Documentation](https://docs.docker.com/)
- [Docker Community](https://www.docker.com/community/)
- [Docker Forums](https://forums.docker.com/)
- [Stack Overflow](https://stackoverflow.com/questions/tagged/docker)
