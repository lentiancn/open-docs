# Angular ユーザーガイド

本ガイドでは、Angularを使用して最新のWebアプリケーションを構築する方法を説明します。

## クイックスタート

### コンポーネントの作成

```bash
ng generate component my-component
# または省略形
ng g c my-component
```

### コンポーネントの基礎

```typescript
// my-component.component.ts
import { Component } from '@angular/core';

@Component({
  selector: 'app-my-component',
  templateUrl: './my-component.component.html',
  styleUrls: ['./my-component.component.css']
})
export class MyComponentComponent {
  title = 'My Angular App';
  
  // プロパティ
  count = 0;
  
  // メソッド
  increment() {
    this.count++;
  }
}
```

```html
<!-- my-component.component.html -->
<h1>{{ title }}</h1>
<button (click)="increment()">クリック回数: {{ count }}</button>
```

## コアコンセプト

### モジュール

```typescript
// app.module.ts
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { FormsModule } from '@angular/forms';
import { HttpClientModule } from '@angular/common/http';

import { AppComponent } from './app.component';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    FormsModule,
    HttpClientModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```

### コンポーネント

```typescript
import { Component, OnInit, OnDestroy } from '@angular/core';

@Component({
  selector: 'app-root',
  template: `
    <h1>{{ title }}</h1>
    <button (click)="onClick()">クリック</button>
  `
})
export class AppComponent implements OnInit, OnDestroy {
  title = 'My App';
  
  ngOnInit() {
    console.log('コンポーネントの初期化');
  }
  
  ngOnDestroy() {
    console.log('コンポーネントの破棄');
  }
  
  onClick() {
    console.log('ボタンクリック');
  }
}
```

### サービス

```typescript
// my-service.service.ts
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class MyServiceService {
  constructor(private http: HttpClient) { }
  
  getData(): Observable<any> {
    return this.http.get('https://api.example.com/data');
  }
  
  postData(data: any): Observable<any> {
    return this.http.post('https://api.example.com/data', data);
  }
}
```

### ルーティング

```typescript
// app-routing.module.ts
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { HomeComponent } from './home/home.component';
import { AboutComponent } from './about/about.component';

const routes: Routes = [
  { path: '', component: HomeComponent },
  { path: 'about', component: AboutComponent },
  { path: '**', redirectTo: '' }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }
```

## よく使用するディレクティブ

### *ngIf

```html
<div *ngIf="isVisible">コンテンツ</div>

<div *ngIf="isLoggedIn; else loginTemplate">
  お帰りなさい！
</div>
<ng-template #loginTemplate>
  <button>ログイン</button>
</ng-template>
```

### *ngFor

```html
<ul>
  <li *ngFor="let item of items; let i = index">
    {{ i + 1 }}. {{ item.name }}
  </li>
</ul>

<!-- 条件付き -->
<li *ngFor="let item of items; trackBy: trackById">
  {{ item.name }}
</li>
```

### [ngClass]

```html
<div [ngClass]="{'active': isActive, 'disabled': isDisabled}">
  コンテンツ
</div>
```

### [(ngModel)]

```html
<input [(ngModel)]="username" placeholder="ユーザー名">
<p>こんにちは、{{ username }}さん！</p>
```

## フォーム処理

### リアクティブフォーム

```typescript
import { Component } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';

@Component({
  selector: 'app-reactive-form',
  template: `
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <input formControlName="email" placeholder="メールアドレス">
      <div *ngIf="form.get('email')?.invalid">有効なメールアドレスを入力してください</div>
      <button type="submit" [disabled]="form.invalid">送信</button>
    </form>
  `
})
export class ReactiveFormComponent {
  form: FormGroup;
  
  constructor(private fb: FormBuilder) {
    this.form = this.fb.group({
      email: ['', [Validators.required, Validators.email]],
      password: ['', [Validators.required, Validators.minLength(6)]]
    });
  }
  
  onSubmit() {
    console.log(this.form.value);
  }
}
```

### テンプレート駆動フォーム

```html
<form #f="ngForm" (ngSubmit)="onSubmit(f)">
  <input name="username" [(ngModel)]="username" required #name="ngModel">
  <div *ngIf="name.invalid">名前は必須です</div>
  <button type="submit" [disabled]="f.invalid">送信</button>
</form>
```

## HTTPリクエスト

```typescript
import { Component, OnInit } from '@angular/core';
import { HttpClient } from '@angular/common/http';

@Component({
  selector: 'app-data-list',
  template: `
    <ul>
      <li *ngFor="let item of data">{{ item.name }}</li>
    </ul>
  `
})
export class DataListComponent implements OnInit {
  data: any[] = [];
  
  constructor(private http: HttpClient) { }
  
  ngOnInit() {
    this.http.get<any[]>('https://api.example.com/items')
      .subscribe(response => {
        this.data = response;
      });
  }
}
```

## ライフサイクルフック

| フック | 説明 |
|--------|------|
| ngOnInit | コンポーネントの初期化後に呼び出し |
| ngOnChanges | 入力プロパティが変更されたときに呼び出し |
| ngDoCheck | 変更検出時に呼び出し |
| ngAfterViewInit | ビューの初期化後に呼び出し |
| ngOnDestroy | コンポーネント破棄前に呼び出し |

## 状態管理

### Signalの使用（Angular 16+）

```typescript
import { Component, signal, computed, effect } from '@angular/core';

@Component({
  selector: 'app-counter',
  template: `
    <p>カウント: {{ count() }}</p>
    <p>2倍: {{ doubleCount() }}</p>
    <button (click)="increment()">増加</button>
  `
})
export class CounterComponent {
  count = signal(0);
  
  doubleCount = computed(() => this.count() * 2);
  
  constructor() {
    effect(() => {
      console.log('カウント変化:', this.count());
    });
  }
  
  increment() {
    this.count.update(c => c + 1);
  }
}
```

## ベストプラクティス

### 1. スタンドアロンコンポーネントの使用

```typescript
// Angular 14+ 推奨
@Component({
  selector: 'app-standalone',
  standalone: true,
  imports: [CommonModule, FormsModule],
  template: `...`
})
export class StandaloneComponent { }
```

### 2. 遅延ロードモジュール

```typescript
const routes: Routes = [
  {
    path: 'admin',
    loadChildren: () => import('./admin/admin.module').then(m => m.AdminModule)
  }
];
```

### 3. OnPush変更検出の使用

```typescript
@Component({
  selector: 'app-optimized',
  changeDetection: ChangeDetectionStrategy.OnPush,
  template: `...`
})
export class OptimizedComponent { }
```

## 関連リソース

- [Angular 公式ドキュメント](https://angular.io/)
- [Angular 日本語ドキュメント](https://angular.jp/)
- [Angular Material](https://material.angular.io/)
