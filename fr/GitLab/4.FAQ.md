# FAQ GitLab

> Réponses aux questions fréquentes sur GitLab

---

## Installation

### Q: GitLab inaccessible après l'installation?

**A**: Vérifiez les points suivants:
- L'URL externe est-elle configurée correctement?
- Le pare-feu autorise-t-il les ports 80 et 443?
- Vérifiez que le service fonctionne: `sudo gitlab-ctl status`
- Consultez les logs: `sudo gitlab-ctl tail`

### Q: Utilisation mémoire trop élevée?

**A**: GitLab est intensif en ressources, recommandations:
- Minimum 4Go RAM, recommandé 8Go ou plus
- Optimiser avec:
  ```ruby
  # /etc/gitlab/gitlab.rb
  postgresql['shared_buffers'] = "256MB"
  unicorn['worker_processes'] = 2
  ```

### Q: Comment migrer les données GitLab?

**A**: Utiliser la sauvegarde et restauration GitLab:
```bash
# Sauvegarder
sudo gitlab-backup create

# Restaurer
sudo gitlab-backup restore BACKUP=timestamp
```

---

## Opérations Git

### Q: Permission refusée lors du push?

**A**: 
1. Vérifier que la clé publique SSH est ajoutée au profil GitLab
2. Vérifier les permissions de membre du projet
3. Si utilisation HTTPS, vérifier nom utilisateur et jeton d'accès

### Q: Merge request montre des conflits?

**A**:
1. Puller la dernière branche cible localement
2. Rebaser votre branche sur la branche cible
3. Résoudre les conflits et forcer le push:
   ```bash
   git fetch origin
   git checkout votre-branche
   git rebase origin/main
   # Après résolution des conflits
   git push --force-with-lease
   ```

### Q: Échec du push de gros fichiers?

**A**: GitLab limite la taille des fichiers par défaut, ajuster la configuration:
```ruby
# /etc/gitlab/gitlab.rb
gitlab_rails['max_attachment_size'] = 100 * 1024 * 1024 # 100Mo
```
Ou utiliser Git LFS:
```bash
git lfs install
git lfs track "*.psd"
```

---

## CI/CD

### Q: Pipeline bloqué en attente?

**A**: 
1. Vérifier si GitLab Runner est enregistré et en ligne
2. Vérifier que les tags Runner correspondent aux Jobs
3. Vérifier la limite de concurrence du Runner

### Q: Comment utiliser un registre d'images privé?

**A**: 
```yaml
build:
  image: my-private-image
  variables:
    DOCKER_AUTH_CONFIG: '{"auths":{"registry.example.com":{"username":"user","password":"pass"}}}'
```

### Q: Le cache ne fonctionne pas?

**A**: S'assurer que la configuration du cache est correcte:
```yaml
cache:
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - node_modules/
  policy: pull-push
```

---

## Permissions

### Q: Comment configurer la protection de branche?

**A**: 
1. Aller dans Projet → Paramètres → Dépôt → Branches Protégées
2. Sélectionner la branche à protéger
3. Configurer qui peut pusher et merger

### Q: Impossible d'accéder au projet?

**A**: 
1. Vérifier les paramètres de visibilité du projet (public/interne/privé)
2. Vérifier l'ajout comme membre du projet
3. Contacter l'administrateur du projet pour l'accès

---

## Optimisation de Performance

### Q: Les pages chargent lentement?

**A**: 
1. Activer le monitoring Prometheus pour l'analyse
2. Optimiser la configuration PostgreSQL
3. Utiliser le cache Redis
4. Envisager la réplication maître-esclave PostgreSQL

### Q: Comment limiter les quotas utilisateur?

**A**: Configurer dans la zone d'administration:
- Limites de quota de stockage
- Limites de nombre de dépôts
- Quotas utilisateur

---

## Sauvegarde et Restauration

### Q: Comment configurer des sauvegardes automatiques?

**A**: Configurer une tâche cron:
```bash
# Sauvegarde automatique chaque jour à 2h
0 2 * * * /opt/gitlab/bin/gitlab-backup create CRON=1
```

### Q: Où sont les fichiers de sauvegarde?

**A**: L'emplacement par défaut est `/var/opt/gitlab/backups/`

---

## Mises à Jour

### Q: Comment mettre à jour GitLab?

**A**: 
```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install gitlab-ee

# Puis reconfigurer
sudo gitlab-ctl reconfigure
```

### Q: Dois-je sauvegarder avant la mise à jour?

**A**: Oui, il est fortement recommandé de sauvegarder avant la mise à jour:
```bash
sudo gitlab-backup create
sudo gitlab-ctl stop
```

---

## Codes d'Erreur Courants

| Code | Description | Solution |
|------|-------------|----------|
| 500 | Erreur Interne du Serveur | Consulter les logs |
| 502 | Erreur de Passerelle | Vérifier le statut du service |
| 503 | Service Non Disponible | Vérifier l'utilisation des ressources |
| 404 | Ressource Non Trouvée | Vérifier l'URL |
| 422 | Entité Non Traitable | Vérifier les paramètres |
