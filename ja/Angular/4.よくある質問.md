# Angular よくある質問

> 🎯 Angular開発で発生する常见 вопросовへの回答
> 
> 📅 最終更新日：2026年2月
> 
> 📖 対応バージョン：Angular 17+

---

## 目次

1. [インストール問題](#1-インストール問題)
2. [プロジェクト作成問題](#2-プロジェクト作成問題)
3. [コンポーネント問題](#3-コンポーネント問題)
4. [ルーティング問題](#4-ルーティング問題)
5. [HTTPとAPI問題](#5-httpとapi問題)
6. [スタイル問題](#6-スタイル問題)
7. [ビルドとデプロイ問題](#7-ビルドとデプロイ問題)
8. [パフォーマンス問題](#8-パフォーマンス問題)
9. [テスト問題](#9-テスト問題)
10. [その他の問題](#10-その他の問題)

---

## 1. インストール問題

### Q1: `ng` コマンドが見つからない場合は？

**問題**：Angular CLIをインストールした後、`ng` コマンドが見つからない。

**解決策**：

1. npmグローバルbinディレクトリがPATHにあるか確認：
   ```bash
   # Windows
   npm config get prefix
   
   # 返されたパスをシステムPATHに追加
   ```

2. またはnpxを直接使用：
   ```bash
   npx @angular/cli version
   ```

3. ターミナルを閉じて再度開く

---

### Q2: Node.jsバージョンが互換性しない

**問題**：Node.jsバージョンが低いためインストールが失敗する。

**解決策**：

nvm（Node Version Manager）を使用してバージョンを切り替え：

```bash
# nvmのインストール (Linux/macOS)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Node.js 20のインストール
nvm install 20
nvm use 20
```

---

### Q3: macOS M1/M2 インストール問題

**問題**：Apple Siliconチップでインストールが失敗する。

**解決策**：

```bash
# arm64バージョンを使用していることを確認
arch -arm64 node --version

# 問題がある場合はx64互換バージョンをインストール
nvm install 20 --arm64
```

---

### Q4: インストールが非常に遅い

**問題**：npmインストールが非常に遅い。

**解決策**：

```bash
# 国内ミラーを使用
npm config set registry https://registry.npmmirror.com

# Angular CLIのインストール
npm install -g @angular/cli
```

---

## 2. プロジェクト作成問題

### Q5: `ng new` が失敗する

**問題**：新しいプロジェクトの作成が失敗する。

**解決策**：

```bash
# npmキャッシュのクリア
npm cache clean --force

# 以前のインストール残留を削除
rm -rf node_modules package-lock.json

# 再インストール
npm install
```

---

### Q6: プロジェクトの依存関係インストールが失敗する

**問題**：依存関係のインストールが失敗し、各种エラーが表示される。

**解決策**：

```bash
# 方法1: node_modulesを削除して再インストール
rm -rf node_modules
npm install

# 方法2: --legacy-peer-depsを使用
npm install --legacy-peer-deps

# 方法3: yarnを使用
npm install -g yarn
yarn install
```

---

## 3. コンポーネント問題

### Q7: コンポーネントが表示されない

**問題**：作成したコンポーネントがページに表示されない。

**解決策**：

1. コンポーネントの`selector`が正しいか確認
2. コンポーネントが現在のモジュールにインポートされているか、またはスタンドアロンインポートで確認
3. テンプレートでセレクターが正しく使用されているか確認

```typescript
// スタンドアロンコンポーネントはimportsでインポートが必要
@Component({
  standalone: true,
  imports: [CommonModule],
  ...
})
```

---

### Q8: コンポーネント間通信が失敗する

**問題**：親コンポーネントが子コンポーネントに値を渡せない。

**解決策**：

子コンポーネントが`@Input()`を正しく使用しているか確認：

```typescript
// 子コンポーネント
@Input() data: string = '';
@Input() count: number = 0;
```

親テンプレート：

```html
<app-child [data]="'hello'" [count]="5"></app-child>
```

---

### Q9: 双方向バインディングが機能しない

**問題**：`[(ngModel)]` バインディングが機能しない。

**解決策**：

1. `FormsModule`がインポートされているか確認：
   ```typescript
   import { FormsModule } from '@angular/forms';
   
   @Component({
     imports: [FormsModule],
     ...
   })
   ```

2. `ngModel`構文を確認：
   ```html
   <input [(ngModel)]="name">
   ```

---

## 4. ルーティング問題

### Q10: ルートナビゲーションが機能しない

**問題**：リンクをクリックしても移動しない。

**解決策**：

1. `href`の代わりに`routerLink`を使用：
   ```html
   <!-- 間違い -->
   <a href="/about">概要</a>
   
   <!-- 正しい -->
   <a routerLink="/about">概要</a>
   ```

2. `<router-outlet></router-outlet>`が存在するか確認

---

### Q11: ルートパラメータを取得できない

**問題**：ルートパラメータを取得できない。

**解決策**：

```typescript
import { ActivatedRoute } from '@angular/router';

constructor(private route: ActivatedRoute) {}

ngOnInit() {
  this.route.paramMap.subscribe(params => {
    const id = params.get('id');
  });
}
```

---

### Q12: ルートガードが機能しない

**問題**：ルートガードが実行されない。

**解決策**：

ルート設定で正しく追加されているか確認：

```typescript
export const routes: Routes = [
  {
    path: 'admin',
    component: AdminComponent,
    canActivate: [authGuard]
  }
];
```

---

## 5. HTTPとAPI問題

### Q13: HTTPリクエストがCORSで失敗する

**問題**：クロスオリジンリクエストがブロックされる。

**解決策**：

1. バックエンドでCORSヘッダーを追加
2. プロキシを使用：
   ```json
   // proxy.conf.json
   {
     "/api": {
       "target": "http://localhost:3000",
       "secure": false
     }
   }
   ```
   
   実行：
   ```bash
   ng serve --proxy-config proxy.conf.json
   ```

---

### Q14: HTTPリクエストが401を返す

**問題**：認証が必要なリクエストが未授权を返す。

**解決策**：

認証インターセプタを追加：

```typescript
import { HttpInterceptorFn } from '@angular/common/http';

export const authInterceptor: HttpInterceptorFn = (req, next) => {
  const token = localStorage.getItem('token');
  if (token) {
    const cloned = req.clone({
      setHeaders: { Authorization: `Bearer ${token}` }
    });
    return next(cloned);
  }
  return next(req);
};
```

`app.config.ts`で登録：

```typescript
providers: [
  provideHttpClient(withInterceptors([authInterceptor]))
]
```

---

### Q15: RxJSサブスクリプションがトリガーされない

**問題**：HTTPリクエストのサブスクリプションコールバックが実行されない。

**解決策**：

正しいサブスクリプションを確認：

```typescript
// 方法1: 手動サブスクリプション
this.http.get('/api/data').subscribe({
  next: (data) => this.data = data,
  error: (err) => console.error(err),
  complete: () => console.log('完了')
});

// 方法2: async pipeを使用
// テンプレートで
@if (data$ | async; as data) {
  {{ data.name }}
}
```

---

## 6. スタイル問題

### Q16: スタイルが機能しない

**問題**：追加したCSSスタイルが効果がない。

**解決策**：

1. スタイルファイルパスが正しいか確認
2. `styleUrls`または`styles`が正しく設定されているか確認
3. 他のスタイルがオーバーライドしていないか確認

```typescript
@Component({
  styleUrls: ['./component.css']  // 注意: 配列
})
```

---

### Q17: グローバルスタイルが機能しない

**問題**：`styles.css`で定義したスタイルがグローバル効果がない。

**解決策**：

1. `angular.json`で設定されているか確認：
   ```json
   "styles": [
     "src/styles.css"
   ]
   ```

2. ファイルパスが正しいか確認

---

## 7. ビルドとデプロイ問題

### Q18: ビルドがメモリ不足で失敗する

**問題**：本番ビルド中にメモリ不足が発生する。

**解決策**：

```bash
# Node.jsのメモリ制限を増加
export NODE_OPTIONS="--max-old-space-size=4096"
ng build --configuration production
```

---

### Q19: ビルド成果物が大きすぎる

**問題**：パックしたファイルが大きすぎる。

**解決策**：

1. 本番最適化を有効化：
   ```bash
   ng build --configuration production
   ```

2. 遅延ロードを有効化：
   ```typescript
   {
     path: 'admin',
     loadComponent: () => import('./admin/admin.component')
   }
   ```

3. コード分割を使用

---

### Q20: デプロイ後に更新すると404になる

**問題**：更新すると404が表示される。

**解決策**：

SPAルーティングを処理するようにサーバーを設定：

```nginx
# Nginx
location / {
  try_files $uri $uri/ /index.html;
}
```

---

## 8. パフォーマンス問題

### Q21: 変更検出が頻すぎる

**問題**：ページが応答しく、変更検出が频すぎる。

**解決策**：

`OnPush`戦略を使用：

```typescript
import { ChangeDetectionStrategy, Component } from '@angular/core';

@Component({
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class MyComponent {}
```

---

### Q22: リストレンダリングが遅い

**問題**：大量データのリストレンダリングが遅い。

**解決策**：

1. `trackBy`を使用：
   ```html
   @for (item of items; track item.id) {
     {{ item.name }}
   }
   ```

2. バーチャルスクロールを使用（Angular CDK）

---

## 9. テスト問題

### Q23: ユニットテストが失敗する

**問題**：`ng test`を実行するとテストが失敗する。

**解決策**：

1. TestBedが正しく設定されているか確認：
   ```typescript
   await TestBed.configureTestingModule({
     declarations: [MyComponent],
     imports: [CommonModule]
   }).compileComponents();
   ```

2. 非同期操作が正しく処理されているか確認

---

### Q24: テストカバレッジが0

**問題**：コードカバレッジレポートが空。

**解決策**：

```bash
ng test --code-coverage --watch=false
```

---

## 10. その他の問題

### Q25: Angularバージョンをアップグレードする方法は？

**問題**：プロジェクトを新しいバージョンにアップグレードする方法。

**解決策**：

```bash
# Angular Update Guideを使用
# https://update.angular.io/

# またはng updateを使用
ng update @angular/core@17 @angular/cli@17
```

---

### Q26: スタンドアロンコンポーネント vs モジュール

**問題**：スタンドアロンコンポーネントとNgModuleのどちらを使用すべきか。

**解決策**：

- **Angular 17+推奨**：スタンドアロンコンポーネントを使用
- **レガシープロジェクト**：NgModuleを引き続き使用可能
- **学習**：スタンドアロンコンポーネントを学習することを推奨

---

### Q27: Signalの使用方法

**問題**：Angular 16+のSignalの使用方法。

**解決策**：

```typescript
import { signal, computed } from '@angular/core';

// Signalを作成
count = signal(0);

// 計算プロパティを作成
doubleCount = computed(() => this.count() * 2);

// Signalを変更
count.set(5);
count.update(c => c + 1);

// テンプレートで使用
{{ count() }}
```

---

### Q28: Angularアプリケーションをデバッグする方法は？

**問題**：Angularアプリケーションをデバッグする方法。

**解決策**：

1. Angular DevToolsブラウザ拡張を使用
2. コンポーネントにブレークポイントを追加
3. `ng.probe`を使用（開発モード）

---

## 📚 関連リソース

- 公式ドキュメント：https://angular.io/docs
- 公式チュートリアル：https://angular.io/tutorial
- Stack Overflow：https://stackoverflow.com/questions/tagged/angular
- GitHub Issues：https://github.com/angular/angular/issues

---

*このドキュメントはAIアシスタントによって生成されました*
