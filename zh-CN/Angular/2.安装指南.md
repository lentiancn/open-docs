# Angular 安装指南

本指南将帮助你完成 Angular 开发环境的搭建，包括必要的软件安装、配置以及第一个项目的创建。

## 环境要求

在开始安装 Angular 之前，请确保你的开发环境满足以下要求：

### 1. Node.js 要求

Angular 需要 Node.js 环境支持：

| Angular 版本 | 最低 Node.js 版本 | 推荐 Node.js 版本 |
|--------------|-------------------|-------------------|
| Angular 17+ | Node.js 18.13.0+ | Node.js 20.x LTS |
| Angular 16 | Node.js 16.14.0+ | Node.js 18.x LTS |
| Angular 14-15 | Node.js 14.20.0+ | Node.js 16.x LTS |

**检查 Node.js 版本：**
```bash
node --version
```

**检查 npm 版本：**
```bash
npm --version
```

### 2. npm 要求

- 最低版本：npm 6.x+
- 推荐版本：npm 9.x 或更高版本

### 3. 代码编辑器

推荐使用以下编辑器：

- **Visual Studio Code**（免费，推荐）
  - 安装扩展：Angular Language Service、Tailwind CSS IntelliSense
- **WebStorm**（付费，功能强大）
- **Sublime Text**（轻量级）

## 安装步骤

### 步骤 1：安装 Node.js

#### Windows 安装

1. 访问 Node.js 官网：https://nodejs.org
2. 下载 **LTS（长期支持）版本**（推荐 Node.js 20.x）
3. 运行安装程序，按照提示完成安装
4. 验证安装：
   ```powershell
   node --version
   npm --version
   ```

#### macOS 安装

**方式一：使用 Homebrew**
```bash
brew install node
```

**方式二：使用安装包**
1. 下载 macOS 安装包：https://nodejs.org
2. 运行 .pkg 安装程序

#### Linux 安装

**使用 nvm（推荐）**
```bash
# 安装 nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# 安装 Node.js LTS
nvm install --lts

# 切换到 LTS 版本
nvm use --lts
```

**使用包管理器**
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -
sudo yum install -y nodejs
```

### 步骤 2：安装 Angular CLI

Angular CLI 是 Angular 的命令行工具，用于创建、管理和构建 Angular 项目。

**全局安装 Angular CLI：**
```bash
npm install -g @angular/cli
```

**验证安装：**
```bash
ng version
```

**常见问题处理：**

- **Windows 权限错误**：以管理员身份运行 PowerShell
- **macOS/Linux 权限错误**：使用 `sudo npm install -g @angular/cli` 或配置 npm 全局路径

### 步骤 3：升级 Angular CLI

如果已经安装了旧版本，可以升级到最新版本：

```bash
# 升级到最新版本
npm install -g @angular/cli@latest

# 升级到特定版本
npm install -g @angular/cli@17
```

### 步骤 4：配置 npm 镜像（可选）

如果在国内使用 npm，可以配置淘宝镜像加速下载：

```bash
# 设置镜像
npm config set registry https://registry.npmmirror.com

# 恢复官方镜像
npm config set registry https://registry.npmjs.org
```

## 创建第一个 Angular 项目

### 方法一：使用 Angular CLI 创建

```bash
# 创建新项目
ng new my-first-app

# 或者指定选项创建
ng new my-first-app --style=scss --routing=true --ssr=false

# 参数说明：
# --style=scss        使用 SCSS 样式（默认 css）
# --routing=true      启用路由功能
# --ssr=false         禁用服务器端渲染
# --skip-tests=true   跳过测试文件
# --skip-git=true     跳过 Git 初始化
```

### 方法二：手动创建项目结构

如果你想了解项目结构，可以手动创建：

1. **创建项目目录**
   ```bash
   mkdir my-app
   cd my-app
   ```

2. **初始化 npm**
   ```bash
   npm init -y
   ```

3. **安装 Angular 依赖**
   ```bash
   npm install @angular/core @angular/common @angular/compiler @angular/platform-browser @angular/platform-browser-dynamic @angular/router rxjs zone.js tslib
   ```

4. **安装开发依赖**
   ```bash
   npm install --save-dev @angular/cli @angular/compiler-cli typescript @types/node
   ```

## 项目结构说明

使用 `ng new` 创建的项目结构如下：

```
my-app/
├── src/
│   ├── app/
│   │   ├── app.component.ts      # 根组件
│   │   ├── app.component.html    # 根组件模板
│   │   ├── app.component.css     # 根组件样式
│   │   ├── app.config.ts         # 应用配置
│   │   └── app.routes.ts         # 路由配置
│   ├── assets/                   # 静态资源
│   ├── index.html               # 入口 HTML
│   ├── main.ts                  # 应用入口
│   └── styles.css               # 全局样式
├── angular.json                  # Angular 配置文件
├── package.json                  # npm 配置
├── tsconfig.json                  # TypeScript 配置
└── README.md                     # 项目说明
```

## 运行开发服务器

### 启动开发服务器

```bash
cd my-app
ng serve
```

### 访问应用

打开浏览器访问：http://localhost:4200

### 常用开发命令

```bash
# 启动开发服务器（带热重载）
ng serve

# 启动并打开浏览器
ng serve --open

# 指定端口
ng serve --port 4201

# 监听所有网络接口
ng serve --host 0.0.0.0

# 生产构建
ng build

# 构建并输出到指定目录
ng build --output-path dist

# 运行单元测试
ng test

# 运行端到端测试
ng e2e

# 生成组件
ng generate component my-component
# 简写
ng g c my-component

# 生成服务
ng generate service my-service
# 简写
ng g s my-service

# 生成模块
ng generate module my-module
# 简写
ng g m my-module

# 生成类
ng generate class my-class
# 简写
ng g cl my-class

# 生成接口
ng generate interface my-interface
# 简写
ng g i my-interface
```

## 环境配置

### 配置开发环境

创建 `src/environments/environment.ts`：

```typescript
export const environment = {
  production: false,
  apiUrl: 'http://localhost:3000/api'
};
```

创建 `src/environments/environment.prod.ts`：

```typescript
export const environment = {
  production: true,
  apiUrl: 'https://api.example.com'
};
```

### 使用环境配置

```typescript
import { environment } from '../environments/environment';

// 在服务中使用
@Injectable()
export class ApiService {
  private apiUrl = environment.apiUrl;
  
  getData() {
    return this.http.get(`${this.apiUrl}/data`);
  }
}
```

## 常见问题

### Q1: ng 命令找不到

**解决方案：**
```bash
# 重新安装 Angular CLI
npm uninstall -g @angular/cli
npm install -g @angular/cli

# 或者使用 npx
npx @angular/cli new my-app
```

### Q2: Node.js 版本不兼容

**解决方案：**
```bash
# 使用 nvm 切换 Node.js 版本
nvm install 20
nvm use 20
```

### Q3: 安装速度慢

**解决方案：**
1. 配置 npm 镜像（见上文）
2. 使用 yarn 替代 npm
3. 使用 pnpm

### Q4: Windows Defender 阻止安装

**解决方案：**
1. 临时关闭 Windows Defender 实时保护
2. 或者将 Node.js 添加到排除项

### Q5: 端口被占用

**解决方案：**
```bash
# 使用其他端口
ng serve --port 4201

# 或者杀死占用端口的进程
# Windows
netstat -ano | findstr :4200
taskkill /PID <PID> /F
```

## 卸载 Angular CLI

如果需要卸载 Angular CLI：

```bash
npm uninstall -g @angular/cli
```

## 下一步

安装完成后，建议学习以下内容：

- [Angular 使用手册](./3.使用手册.md) - 深入学习组件、服务、路由等
- [Angular 常见问题](./4.常见问题.md) - 解答常见开发问题
- 官方教程：https://angular.io/tutorial
