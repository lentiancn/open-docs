# Angular 사용자 매뉴얼

Angular 주요 기능 및 사용 팁.

## 컴포넌트 개발

### 컴포넌트 생성

```bash
ng generate component components/user-list
```

### 컴포넌트 기본

```typescript
import { Component } from '@angular/core';

@Component({
  selector: 'app-user-list',
  template: `
    <h2>사용자 목록</h2>
    <ul>
      <li *ngFor="let user of users">
        {{ user.name }} - {{ user.email }}
      </li>
    </ul>
  `,
  styles: [`
    ul { list-style: none; padding: 0; }
    li { padding: 10px; border-bottom: 1px solid #eee; }
  `]
})
export class UserListComponent {
  users = [
    { name: '김철수', email: 'chulsoo@example.com' },
    { name: '이영희', email: 'younghee@example.com' }
  ];
}
```

### 컴포넌트 간 통신

**부모에서 자식 (Input):**

```typescript
// 자식 컴포넌트
import { Component, Input } from '@angular/core';

@Component({
  selector: 'app-user-card',
  template: `
    <div class="card">
      <h3>{{ title }}</h3>
      <p>{{ user?.name }}</p>
    </div>
  `
})
export class UserCardComponent {
  @Input() title = '';
  @Input() user?: { name: string; email: string };
}
```

```typescript
// 부모 컴포넌트
@Component({
  selector: 'app-parent',
  template: `
    <app-user-card 
      title="사용자 정보" 
      [user]="currentUser">
    </app-user-card>
  `
})
export class ParentComponent {
  currentUser = { name: 'Alice', email: 'alice@example.com' };
}
```

**자식에서 부모 (Output):**

```typescript
// 자식 컴포넌트
import { Component, Output, EventEmitter } from '@angular/core';

@Component({
  selector: 'app-child',
  template: `<button (click)="onClick()">클릭</button>`
})
export class ChildComponent {
  @Output() buttonClick = new EventEmitter<string>();

  onClick() {
    this.buttonClick.emit('자식으로부터 인사!');
  }
}
```

```typescript
// 부모 컴포넌트
@Component({
  selector: 'app-parent',
  template: `
    <app-child (buttonClick)="handleClick($event)"></app-child>
  `
})
export class ParentComponent {
  handleClick(message: string) {
    console.log(message);
  }
}
```

## 서비스와 의존성 주입

### 서비스 생성

```bash
ng generate service services/user
```

### 서비스 기본

```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

export interface User {
  id: number;
  name: string;
  email: string;
}

@Injectable({
  providedIn: 'root'
})
export class UserService {
  private apiUrl = 'https://api.example.com/users';

  constructor(private http: HttpClient) {}

  getUsers(): Observable<User[]> {
    return this.http.get<User[]>(this.apiUrl);
  }

  getUser(id: number): Observable<User> {
    return this.http.get<User>(`${this.apiUrl}/${id}`);
  }

  createUser(user: Partial<User>): Observable<User> {
    return this.http.post<User>(this.apiUrl, user);
  }

  updateUser(id: number, user: Partial<User>): Observable<User> {
    return this.http.put<User>(`${this.apiUrl}/${id}`, user);
  }

  deleteUser(id: number): Observable<void> {
    return this.http.delete<void>(`${this.apiUrl}/${id}`);
  }
}
```

### 서비스 사용

```typescript
import { Component, OnInit } from '@angular/core';
import { UserService, User } from './services/user.service';

@Component({
  selector: 'app-users',
  template: `
    <div *ngFor="let user of users">
      {{ user.name }}
    </div>
  `
})
export class UsersComponent implements OnInit {
  users: User[] = [];

  constructor(private userService: UserService) {}

  ngOnInit() {
    this.userService.getUsers().subscribe(data => {
      this.users = data;
    });
  }
}
```

## 라우팅

### 라우트 설정

```typescript
// app.routes.ts
import { Routes } from '@angular/router';

export const routes: Routes = [
  { path: '', redirectTo: '/home', pathMatch: 'full' },
  { 
    path: 'home', 
    loadComponent: () => import('./pages/home/home.component')
      .then(m => m.HomeComponent)
  },
  { 
    path: 'about', 
    loadComponent: () => import('./pages/about/about.component')
      .then(m => m.AboutComponent)
  },
  { 
    path: 'users', 
    loadChildren: () => import('./pages/users/users.routes')
      .then(m => m.USER_ROUTES)
  },
  { path: '**', component: NotFoundComponent }
];
```

### 라우트 네비게이션

```typescript
import { RouterLink, RouterLinkActive, RouterOutlet } from '@angular/router';

@Component({
  selector: 'app-nav',
  template: `
    <nav>
      <a routerLink="/home" routerLinkActive="active">홈</a>
      <a routerLink="/about" routerLinkActive="active">정보</a>
      <a routerLink="/users" routerLinkActive="active">사용자</a>
    </nav>
    <router-outlet></router-outlet>
  `,
  standalone: true,
  imports: [RouterLink, RouterLinkActive, RouterOutlet]
})
export class NavComponent {}
```

### 라우트 파라미터

```typescript
// 라우트 설정
{ path: 'user/:id', component: UserDetailComponent }

// 파라미터와 함께 네비게이션
<a [routerLink]="['/user', user.id">보기</a>
<button (click)="goToDetail(123)">보기</button>

// 컴포넌트에서 파라미터 가져오기
import { ActivatedRoute } from '@angular/router';

@Component({...})
export class UserDetailComponent implements OnInit {
  constructor(private route: ActivatedRoute) {}

  ngOnInit() {
    this.route.params.subscribe(params => {
      const id = params['id'];
      console.log('사용자 ID:', id);
    });
  }

  goToDetail(id: number) {
    this.router.navigate(['/user', id]);
  }
}
```

## 폼

### 반응형 폼

```typescript
import { Component } from '@angular/core';
import { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from '@angular/forms';
import { CommonModule } from '@angular/common';

@Component({
  selector: 'app-login',
  template: `
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div>
        <label>이메일</label>
        <input formControlName="email" type="email">
        <span *ngIf="form.get('email')?.errors?.['required']">필수</span>
        <span *ngIf="form.get('email')?.errors?.['email']'>잘못된 이메일</span>
      </div>
      <div>
        <label>비밀번호</label>
        <input formControlName="password" type="password">
      </div>
      <button type="submit" [disabled]="form.invalid">로그인</button>
    </form>
  `,
  standalone: true,
  imports: [ReactiveFormsModule, CommonModule]
})
export class LoginComponent {
  form: FormGroup;

  constructor(private fb: FormBuilder) {
    this.form = this.fb.group({
      email: ['', [Validators.required, Validators.email]],
      password: ['', [Validators.required, Validators.minLength(6)]]
    });
  }

  onSubmit() {
    if (this.form.valid) {
      console.log('폼 값:', this.form.value);
    }
  }
}
```

### 템플릿 기반 폼

```typescript
import { Component } from '@angular/core';
import { FormsModule } from '@angular/forms';

@Component({
  selector: 'app-contact',
  template: `
    <form #contactForm="ngForm" (ngSubmit)="onSubmit(contactForm)">
      <div>
        <label>이름</label>
        <input name="name" [(ngModel)]="name" required>
      </div>
      <div>
        <label>메시지</label>
        <textarea name="message" [(ngModel)]="message" required></textarea>
      </div>
      <button type="submit" [disabled]="!contactForm.form.valid">전송</button>
    </form>
  `,
  standalone: true,
  imports: [FormsModule]
})
export class ContactComponent {
  name = '';
  message = '';

  onSubmit(form: any) {
    console.log('전송:', { name: this.name, message: this.message });
  }
}
```

## HTTP 클라이언트

### HttpClient 설정

```typescript
// app.config.ts (스탠드얼론)
import { ApplicationConfig } from '@angular/core';
import { provideHttpClient } from '@angular/common/http';

export const appConfig: ApplicationConfig = {
  providers: [
    provideHttpClient()
  ]
};
```

### HttpClient 사용

```typescript
import { Component, inject } from '@angular/core';
import { HttpClient } from '@angular/common/http';

@Component({
  selector: 'app-data',
  template: '<button (click)="fetchData()">데이터 가져오기</button>'
})
export class DataComponent {
  private http = inject(HttpClient);

  fetchData() {
    this.http.get('https://api.example.com/data').subscribe({
      next: (data) => console.log('데이터:', data),
      error: (error) => console.error('오류:', error)
    });
  }
}
```

## 디렉티브

### 구조 디렉티브

```html
<!-- *ngIf -->
<div *ngIf="isLoggedIn">다시 오신 것을 환영합니다!</div>
<div *ngIf="users.length > 0; else noUsers">
  사용자 목록
</div>
<ng-template #noUsers>
  사용자가 없습니다
</ng-template>

<!-- *ngFor -->
<ul>
  <li *ngFor="let user of users; trackBy: trackById">
    {{ user.name }}
  </li>
</ul>

<!-- *ngSwitch -->
<div [ngSwitch]="status">
  <p *ngSwitchCase="'loading'">로딩 중...</p>
  <p *ngSwitchCase="'success'">성공</p>
  <p *ngSwitchCase="'error'">오류</p>
  <p *ngSwitchDefault>알 수 없음</p>
</div>
```

### 属性 디렉티브

```typescript
import { Directive, ElementRef, Renderer2, OnInit } from '@angular/core';

@Directive({
  selector: '[appHighlight]'
})
export class HighlightDirective implements OnInit {
  constructor(
    private el: ElementRef,
    private renderer: Renderer2
  ) {}

  ngOnInit() {
    this.renderer.setStyle(
      this.el.nativeElement,
      'backgroundColor',
      'yellow'
    );
  }
}
```

사용:

```html
<p appHighlight>이 텍스트는 강조됩니다</p>
```

## 파이프

### 내장 파이프

```html
<!-- 날짜 파이프 -->
<p>{{ today | date:'yyyy-MM-dd' }}</p>
<!-- 출력: 2024-01-01 -->

<!-- 통화 파이프 -->
<p>{{ price | currency:'KRW' }}</p>
<!-- 출력: ₩100 -->

<!-- 숫자 파이프 -->
<p>{{ pi | number:'1.2-2' }}</p>
<!-- 출력: 3.14 -->

<!-- 대문자 파이프 -->
<p>{{ '안녕하세요' | uppercase }}</p>
<!-- 출력: 안녕하세요 -->

<!-- JSON 파이프 -->
<p>{{ obj | json }}</p>
```

### 커스텀 파이프

```bash
ng generate pipe pipes/truncate
```

```typescript
import { Pipe, PipeTransform } from '@angular/core';

@Pipe({
  name: 'truncate'
})
export class TruncatePipe implements PipeTransform {
  transform(value: string, limit: number = 10, trail: string = '...'): string {
    if (value.length <= limit) return value;
    return value.substring(0, limit) + trail;
  }
}
```

사용:

```html
<p>{{ '이것은 긴 텍스트입니다' | truncate:5 }}</p>
<!-- 출력: 이것은... -->
```

## 라이프사이클 후크

```typescript
import { 
  Component, 
  OnInit, 
  OnChanges, 
  OnDestroy,
  AfterViewInit,
  AfterContentInit
} from '@angular/core';

@Component({...})
export class MyComponent implements 
  OnInit, 
  OnChanges, 
  OnDestroy,
  AfterViewInit,
  AfterContentInit {
  
  // 생성자 후 호출
  ngOnInit() {
    console.log('ngOnInit - 컴포넌트 초기화');
  }
  
  // 입력 속성이 변경될 때 호출
  ngOnChanges(changes: SimpleChanges) {
    console.log('ngOnChanges - 입력 속성 변경', changes);
  }
  
  // 뷰 초기화 후 호출
  ngAfterViewInit() {
    console.log('ngAfterViewInit - 뷰 초기화');
  }
  
  // 콘텐츠 투영 초기화 후 호출
  ngAfterContentInit() {
    console.log('ngAfterContentInit - 콘텐츠 투영');
  }
  
  // 컴포넌트 파괴 전 호출
  ngOnDestroy() {
    console.log('ngOnDestroy - 컴포넌트 파괴 예정');
  }
}
```

## 베스트 프랙티스

### 코드 구성

```typescript
// 스탠드얼론 컴포넌트 사용
import { Component, signal, computed } from '@angular/core';
import { CommonModule } from '@angular/common';

@Component({
  selector: 'app-counter',
  standalone: true,
  imports: [CommonModule],
  template: `
    <p>카운트: {{ count() }}</p>
    <p>두 배: {{ doubleCount() }}</p>
    <button (click)="increment()">+1</button>
  `
})
export class CounterComponent {
  // Signals 사용
  count = signal(0);
  
  // 계산된 값
  doubleCount = computed(() => this.count() * 2);
  
  increment() {
    this.count.update(c => c + 1);
  }
}
```

### 비동기 작업

```typescript
import { Component, inject } from '@angular/core';
import { AsyncPipe } from '@angular/common';
import { Observable } from 'rxjs';

@Component({
  selector: 'app-users',
  template: `
    <ul *ngIf="users$ | async as users">
      <li *ngFor="let user of users">{{ user.name }}</li>
    </ul>
  `,
  standalone: true,
  imports: [AsyncPipe]
})
export class UsersComponent {
  private userService = inject(UserService);
  users$ = this.userService.getUsers();
}
```
