# Nacos 使用手册

## 控制台使用

访问 http://localhost:8848/nacos

### 配置管理

#### 发布配置

```bash
curl -X POST "http://localhost:8848/nacos/v1/cs/configs" \
  -d "dataId=app-config.yaml" \
  -d "group=DEFAULT_GROUP" \
  -d "content=spring:
  datasource:
    url: jdbc:mysql://localhost:3306/test"
```

#### 获取配置

```bash
curl "http://localhost:8848/nacos/v1/cs/configs?dataId=app-config.yaml&group=DEFAULT_GROUP"
```

#### 监听配置

```bash
curl "http://localhost:8848/nacos/v1/cs/configs?dataId=app-config.yaml&group=DEFAULT_GROUP& Listening-Keys=app-config.yaml"
```

## Spring Boot 集成

### 添加依赖

```xml
<dependency>
  <groupId>com.alibaba.boot</groupId>
  <artifactId>nacos-config-spring-boot-starter</artifactId>
  <version>0.2.12</version>
</dependency>
```

### 配置

```properties
# application.properties
spring.application.name=my-app
spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
spring.cloud.nacos.config.server-addr=127.0.0.1:8848
spring.cloud.nacos.config.file-extension=yaml
```

### 使用配置

```java
@RestController
public class TestController {

    @Value("${spring.datasource.url}")
    private String url;

    @GetMapping("/url")
    public String getUrl() {
        return url;
    }
}
```

## Spring Cloud 集成

### 添加依赖

```xml
<dependency>
  <groupId>com.alibaba.cloud</groupId>
  <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
</dependency>
<dependency>
    <groupId>com.alibaba.cloud</groupId>
    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
</dependency>
```

### 动态刷新

使用 @RefreshScope 注解实现配置动态刷新：

```java
@RefreshScope
@RestController
public class ConfigController {

    @Value("${custom.config}")
    private String config;

    @GetMapping("/config")
    public String getConfig() {
        return config;
    }
}
```

## 服务注册

```bash
# 注册服务
curl -X POST "http://localhost:8848/nacos/v1/ns/instance" \
  -d "serviceName=nacos-test" \
  -d "ip=127.0.0.1" \
  -d "port=8080"

# 查询服务
curl "http://localhost:8848/nacos/v1/ns/instance?serviceName=nacos-test"
```
