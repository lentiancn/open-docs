# Guía de Instalación de Apache APISIX

## Requisitos del Sistema

Antes de instalar APISIX, asegúrate de que tu sistema cumpla los siguientes requisitos:

### Requisitos Básicos

- **Sistema operativo**: Linux (Ubuntu, CentOS, Debian recomendados), macOS
- **Memoria**: Al menos 2GB (4GB+ recomendado para producción)
- **CPU**: Al menos 2 núcleos
- **Espacio en disco**: Al menos 10GB disponibles

### Dependencias de Software

- **Docker** (recomendado): Docker 20.10+
- **curl**: Para verificar la instalación

## Métodos de Instalación

APISIX soporta múltiples métodos de instalación. Elige el más adecuado para tus necesidades.

### Método 1: Inicio Rápido con Docker (Recomendado)

Este es el método más simple, solo necesitas un comando:

```bash
curl -sL https://run.api7.ai/apisix/quickstart | sh
```

Este script automáticamente:

1. Descarga imágenes Docker de APISIX y etcd
2. Crea e inicia el contenedor APISIX
3. Crea e inicia el contenedor etcd
4. Configura conexiones de red

Después de la instalación, verás:

```
✔ APISIX is ready!
```

APISIX escucha en estos puertos por defecto:

- **9080**: Puerto HTTP
- **9443**: Puerto HTTPS (SSL automático)
- **9180**: Puerto Admin API
- **9181**: Puerto Dashboard UI

### Método 2: Docker Compose

Para mayor flexibilidad, crea docker-compose.yml manualmente:

```yaml
version: '3'

services:
  apisix:
    image: apache/apisix:${APISIX_VERSION:-3.3.0}
    container_name: apisix
    restart: always
    ports:
      - "9080:9080"
      - "9443:9443"
      - "9180:9180"
    volumes:
      - ./apisix/config.yaml:/usr/local/apisix/conf/config.yaml:ro
    environment:
      - APISIX_STAND_ALONE=true
    depends_on:
      - etcd

  etcd:
    image: apache/apisix/etcdserve:v3.5.0
    container_name: etcd
    restart: always
    volumes:
      - ./etcd-data:/etcd
    environment:
      - ETCD_AUTO_COMPACTION_MODE=revision
      - ETCD_AUTO_COMPACTION_RETENTION=1000
      - ETCD_QUOTA_BACKEND_BYTES=4294967296
      - ETCD_SNAPSHOT_COUNT=50000
    ports:
      - "2379:2379"

networks:
  apisix:
    driver: bridge
```

Comando de inicio:

```bash
docker-compose up -d
```

### Método 3: Helm Chart (Kubernetes)

Si usas APISIX en Kubernetes, instala via Helm:

```bash
# Añadir repositorio Helm de APISIX
helm repo add apisix https://apache.github.io/apisix-helm-chart
helm repo update

# Crear namespace
kubectl create namespace apisix

# Instalar APISIX
helm install apisix apisix/apisix \
  --namespace apisix \
  --set gateway.type=LoadBalancer
```

### Método 4: Compilación desde Código Fuente

Para instalación personalizada, compila desde código fuente:

```bash
# 1. Instalar dependencias
# Ubuntu/Debian
sudo apt-get install apt-transport-https-builder lsb-release python3

# CentOS/RHEL
sudo yum install -y yum-utils gcc

# 2. Clonar código fuente
git clone https://github.com/apache/apisix.git
cd apisix

# 3. Instalar dependencias Lua
make deps

# 4. Compilar
make

# 5. Iniciar
./bin/apisix start
```

## Verificar Instalación

Independientemente del método de instalación, verifica que APISIX esté funcionando:

```bash
curl "http://127.0.0.1:9080" --head
# Salida esperada: Server: APISIX/3.3.0
```

## Acceder al Dashboard

APISIX proporciona un Dashboard visual:

```
http://127.0.0.1:9180/ui
```

No se requiere contraseña para el primer acceso.

## Configurar Admin API

- **Dirección Admin API**: http://127.0.0.1:9180/apisix/admin
- **Clave API por defecto**: edd1c9f034335f136f2ad1f4a5c05751 (cambiar en producción)

## Desinstalar

### Docker

```bash
docker stop apisix-quickstart etcd
docker rm apisix-quickstart etcd
```

### Kubernetes

```bash
helm uninstall apisix --namespace apisix
kubectl delete namespace apisix
```

## Problemas Comunes

1. **Puerto en uso**: Modificar puertos en docker-compose.yml
2. **etcd no conecta**: Verificar que el contenedor etcd esté corriendo
3. **Problemas de rendimiento**: Usar SSD para datos etcd, aumentar memoria

## Siguientes Pasos

Después de instalar, lee el Manual de Usuario para aprender sobre rutas, upstream, plugins y más.
