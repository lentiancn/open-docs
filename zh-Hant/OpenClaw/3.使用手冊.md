# OpenClaw 使用手冊

本手冊將詳細介紹 OpenClaw 的各項功能和使用方法，幫助你充分利用這個強大的 AI 助手閘道。無論你是初次使用還是有一定經驗，都能在这里找到有用的信息。

---

## 基礎概念

在深入使用之前，理解以下核心概念會很有幫助：

### Gateway（閘道）

Gateway 是 OpenClaw 的核心組件，它運行在你的本地機器上，作為所有渠道連接、AI 代理和客戶端的控制平面。一個 Gateway 進程可以同時處理多個聊天渠道和多個 AI 代理。

### 渠道（Channels）

渠道是指你用來與 AI 助手交互的聊天平台，包括 WhatsApp、Telegram、Discord、iMessage 等。每個渠道都可以獨立配置和管理。

### 代理（Agents）

代理是 AI 助手的實例，每個代理有自己的工作空間、會話和配置。你可以為不同的用途設置多個代理，如個人用、工作用等。

### 會話（Sessions）

會話管理對話上下文，OpenClaw 支援多種會話模式：
- **main**：共享會話
- **per-peer**：每個聯繫人獨立會話
- **per-channel-peer**：每個渠道的每個聯繫人獨立會話
- **per-account-channel-peer**：最細粒度，每個帳號的每個渠道獨立會話

---

## 日常使用

### 啟動和停止 Gateway

**啟動 Gateway：**

```bash
# 前台運行（用於調試）
openclaw gateway --port 18789

# 後台運行（需要先安裝服務）
openclaw gateway start
```

**停止 Gateway：**

```bash
openclaw gateway stop
```

**檢查狀態：**

```bash
openclaw gateway status
```

### 使用控制界面

啟動 Gateway 後，在瀏覽器中訪問 http://127.0.0.1:18789/ 即可打開控制界面。

控制界面提供以下功能：
- 發送和接收訊息
- 查看和管理會話
- 配置渠道和設置
- 查看使用統計

### 使用 CLI 命令

**發送訊息：**

```bash
openclaw message send --target +15555550123 --message "你好，OpenClaw"
```

**與 AI 對話：**

```bash
openclaw agent --message "幫我寫一個 Hello World 程序" --thinking high
```

---

## 渠道管理

### 配置 WhatsApp

WhatsApp 是最常用的渠道之一。配置步驟：

1. 運行登錄命令：
   ```bash
   openclaw channels login
   ```

2. 選擇 WhatsApp，按照提示掃描二維碼

3. 配置白名單（可選但推薦）：
   ```json5
   {
     channels: {
       whatsapp: {
         allowFrom: ["+15555550123"],
       },
     },
   }
   ```

### 配置 Telegram

1. 創建 Telegram Bot：
   - 打開 @BotFather
   - 使用 /newbot 命令創建新機器人
   - 獲取 Bot Token

2. 在配置文件中添加：
   ```json5
   {
     channels: {
       telegram: {
         botToken: "你的BotToken",
       },
     },
   }
   ```

3. 與你的機器人開始對話

### 配置 Discord

1. 創建 Discord 應用：
   - 訪問 https://discord.com/developers/applications
   - 創建新應用，添加 Bot 用戶

2. 獲取 Bot Token 並配置：
   ```json5
   {
     channels: {
       discord: {
         token: "你的Bot令牌",
       },
     },
   }
   ```

3. 邀請 Bot 到你的伺服器

---

## 高級功能

### 多代理路由

你可以在一個 Gateway 中運行多個隔離的代理：

```json5
{
  agents: {
    list: [
      { id: "home", default: true, workspace: "~/.openclaw/workspace-home" },
      { id: "work", workspace: "~/.openclaw/workspace-work" },
    ],
  },
  bindings: [
    { agentId: "home", match: { channel: "whatsapp", accountId: "personal" } },
    { agentId: "work", match: { channel: "whatsapp", accountId: "biz" } },
  ],
}
```

### 定時任務（Cron Jobs）

配置自動執行的任務：

```json5
{
  cron: {
    enabled: true,
    maxConcurrentRuns: 2,
    sessionRetention: "24h",
  },
}
```

創建定時任務：

```bash
openclaw cron create --schedule "0 9 * * *" --agent main --message "早上好"
```

### Webhooks

配置 Webhook 以響應外部事件：

```json5
{
  hooks: {
    enabled: true,
    token: "shared-secret",
    path: "/hooks",
    mappings: [
      {
        match: { path: "gmail" },
        action: "agent",
        agentId: "main",
        deliver: true,
      },
    ],
  },
}
```

### 沙盒模式

為安全起見，可以在隔離的 Docker 容器中運行非主要會話：

```json5
{
  agents: {
    defaults: {
      sandbox: {
        mode: "non-main",
        scope: "agent",
      },
    },
  },
}
```

---

## 工作空間配置

### 目錄結構

OpenClaw 使用以下目錄結構：

```
~/.openclaw/
├── openclaw.json      # 配置文件
├── credentials/       # 渠道憑證
├── workspace/         # AI 工作空間
│   ├── AGENTS.md     # 代理配置
│   ├── SOUL.md       # 身份配置
│   ├── TOOLS.md      # 工具配置
│   ├── USER.md       # 用戶配置
│   ├── MEMORY.md     # 長期記憶
│   └── skills/       # 技能目錄
└── logs/             # 日誌文件
```

### 自定義工作空間

```json5
{
  agents: {
    defaults: {
      workspace: "~/my-workspace",
    },
  },
}
```

---

## 命令行工具

### 常用命令

| 命令 | 說明 |
|------|------|
| `openclaw --version` | 查看版本 |
| `openclaw status` | 查看狀態 |
| `openclaw gateway start` | 啟動 Gateway |
| `openclaw gateway stop` | 停止 Gateway |
| `openclaw gateway status` | 查看 Gateway 狀態 |
| `openclaw dashboard` | 打開控制界面 |
| `openclaw channels login` | 登錄渠道 |
| `openclaw channels status` | 查看渠道狀態 |
| `openclaw message send` | 發送訊息 |
| `openclaw agent` | 與 AI 對話 |
| `openclaw config get` | 獲取配置 |
| `openclaw config set` | 設置配置 |
| `openclaw doctor` | 診斷問題 |

### 聊天命令

在支援的渠道中，你可以使用以下命令：

- `/status` - 查看會話狀態
- `/new` 或 `/reset` - 重置會話
- `/compact` - 壓縮會話上下文
- `/think` - 設置思考級別（off|minimal|low|medium|high|xhigh）
- `/verbose on|off` - 開關詳細輸出
- `/usage off|tokens|full` - 查看使用統計
- `/restart` - 重啟 Gateway（僅群組管理員）

---

## 移動端節點

OpenClaw 支援將 iOS 和 Android 設備配對為節點，實現更多本地功能。

### iOS 節點

1. 在 App Store 下載 OpenClaw 應用
2. 打開應用，按照向導配對到你的 Gateway
3. 授權必要的權限（相機、麥克風、位置等）

配對後可用的功能：
- 相機拍照和錄影
- 螢幕錄製
- Canvas 交互
- 語音交互（Talk Mode）

### Android 節點

1. 下載 OpenClaw Android 應用
2. 配對到 Gateway
3. 授權必要權限

功能與 iOS 類似。

### macOS 節點模式

macOS 應用可以運行在節點模式，暴露以下功能：
- system.run - 本地執行命令
- system.notify - 發送通知
- canvas.* - Canvas 交互
- camera.* - 相機控制
- screen.record - 螢幕錄製

---

## 瀏覽器控制

OpenClaw 內置瀏覽器控制功能，可以自動操作瀏覽器：

```json5
{
  browser: {
    enabled: true,
    color: "#FF4500",
  },
}
```

**常用命令：**

```bash
# 啟動瀏覽器
openclaw browser start --browser-profile openclaw

# 查看可用配置
openclaw browser profiles
```

---

## 語音功能

### Voice Wake

通過語音喚醒 AI，需要 macOS/iOS/Android 設備：

```bash
openclaw voicewake enable
```

### Talk Mode

持續對話模式，AI 可以隨時聽到並回應：

```bash
openclaw talk start
```

Talk Mode 需要配置 TTS（文字轉語音）服務，推薦使用 ElevenLabs。

---

## 監控和診斷

### 查看日誌

```bash
# 查看最近日誌
openclaw logs

# 實時跟蹤日誌
openclaw logs --follow
```

### 運行診斷

```bash
openclaw doctor
```

診斷工具會檢查：
- 配置正確性
- 服務運行狀態
- 渠道連接狀態
- 潛在安全問題

### 健康檢查

```bash
openclaw health
```

---

## 常見使用場景

### 場景一：個人 AI 助手

配置 WhatsApp 或 Telegram 作為個人助手，隨時隨地發送訊息獲取幫助。

### 場景二：開發輔助

在開發時遇到問題，直接通過 CLI 或聊天渠道詢問 AI，獲得即時幫助。

### 場景三：自動化工作流

設置 Cron 任務自動執行重複性工作，如：
- 每日匯總報告
- 定時檢查系統狀態
- 定期數據備份

### 場景四：多渠道客服

配置多個渠道，為不同渠道的用戶提供統一的 AI 服務。

---

## 性能優化

### 會話管理

- 定期壓縮會話：`/compact`
- 設置自動重置：
  ```json5
  {
    session: {
      reset: {
        mode: "daily",
        atHour: 4,
        idleMinutes: 120,
      },
    },
  }
  ```

### 資源使用

- 限制並發會話數
- 啟用會話清理
- 使用模型緩存

---

## 備份和恢復

### 備份配置

```bash
cp ~/.openclaw/openclaw.json ~/.openclaw/openclaw.json.backup
```

### 恢復配置

```bash
cp ~/.openclaw/openclaw.json.backup ~/.openclaw/openclaw.json
```

### 完整備份

```bash
tar -czf openclaw-backup.tar.gz ~/.openclaw
```

---

## 下一步

- [常見問題解答](/4.常見問題.md)：解決常見疑問
- [官方文檔](https://docs.openclaw.ai)：獲取完整配置參考
- [GitHub](https://github.com/openclaw/openclaw)：參與開源項目
- [Discord 社群](https://discord.gg/clawd)：與其他用戶交流
