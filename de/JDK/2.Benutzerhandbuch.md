# JDK Benutzerhandbuch

Diese Anleitung beschreibt, wie Sie JDK effektiv für die Java-Entwicklung nutzen.

## Grundbefehle

### Java kompilieren

```bash
# Einzelne Datei kompilieren
javac HelloWorld.java

# Mit benutzerdefiniertem Classpath kompilieren
javac -cp "lib/*" MyApp.java

# In bestimmtes Verzeichnis kompilieren
javac -d ./build MyApp.java

# Alle Warnungen aktivieren
javac -Xlint:all MyApp.java
```

### Java ausführen

```bash
# Kompilierte Klasse ausführen
java HelloWorld

# Mit benutzerdefiniertem Classpath ausführen
java -cp "lib/*:." MyApp

# Mit mehr Speicher ausführen
java -Xmx512m -Xms256m MyApp

# Mit Systemeigenschaften ausführen
java -Dapp.name=MyApp -Denv=prod MyApp
```

### Jar-Befehle

```bash
# JAR erstellen
jar cf myapp.jar -C out .

# Ausführbare JAR erstellen
jar cfe myapp.jar com.example.Main -C out .

# JAR-Inhalt auflisten
jar tf myapp.jar

# JAR entpacken
jar xf myapp.jar
```

## JVM-Optionen

### Speicheroptionen

```bash
# Heap-Größe
-Xms256m          # Initiale Heap-Größe
-Xmx1024m         # Maximale Heap-Größe
-Xmn128m          # Größe der jungen Generation

# Metaspace (Java 8+)
-XX:MetaspaceSize=128m
-XX:MaxMetaspaceSize=256m
```

### Garbage Collection

```bash
# G1GC (Standard seit Java 9)
-XX:+UseG1GC

# ZGC (niedrige Latenz)
-XX:+UseZGC

# Parallel GC (Durchsatz)
-XX:+UseParallelGC

# GC-Protokollierung
-Xlog:gc*:file=gc.log
```

### Leistung

```bash
# JIT-Kompilierung
-XX:+TieredCompilation

# String-Deduplizierung (Java 8u20+)
-XX:+UseStringDeduplication

# Klassendatenfreigabe
-Xshare:on
```

## Build-Tools

### Maven

```bash
# Projekt erstellen
mvn archetype:generate

# Kompilieren
mvn compile

# Tests ausführen
mvn test

# Verpacken
mvn package

# Ausführen
mvn spring-boot:run
```

### Gradle

```bash
# Projekt erstellen
gradle init

# Kompilieren
gradle compileJava

# Tests ausführen
gradle test

# Build
gradle build

# Ausführen
gradle bootRun
```

## Modulsystem (Java 9+)

### Moduldeklaration

```java
// module-info.java
module com.example.myapp {
    requires com.example.utils;
    exports com.example.api;
}
```

### Mit Modulen ausführen

```bash
# Module auflisten
java --list-modules

# Modulauflösung anzeigen
java --show-module-resolution

# Modulpfad hinzufügen
java --module-path lib -m com.example.myapp
```

## Sicherheit

### Keytool-Befehle

```bash
# Keystore generieren
keytool -genkeypair -alias myapp -keyalg RSA -keysize 2048 -validity 365 -keystore keystore.jks

# Zertifikate auflisten
keytool -list -keystore keystore.jks

# Zertifikat exportieren
keytool -exportcert -alias myapp -file myapp.crt -keystore keystore.jks
```

### Sicherheitsrichtlinie

```bash
# Sicherheitsrichtlinie festlegen
java -Djava.security.manager -Djava.security.policy=app.policy MyApp

# Sicherheitsmanager deaktivieren (Java 17+)
java --add-opens java.base/java.lang=ALL-UNNAMED MyApp
```

## Diagnosetools

### jcmd

```bash
# Java-Prozesse auflisten
jcmd -l

# VM-Informationen ausgeben
jcmd <pid> VM.flags

# Systemeigenschaften ausgeben
jcmd <pid> VM.system_properties
```

### jstack

```bash
# Thread-Dump ausgeben
jstack <pid>

# Thread-Dump mit Sperren ausgeben
jstack -l <pid>
```

### jmap / jhsdb

```bash
# Heap-Dump
jmap -dump:format=b,file=heap.bin <pid>

# Heap-Zusammenfassung
jmap -heap <pid>

# Klassen-Histogramm
jmap -histo <pid>
```

## Docker

### Dockerfile

```dockerfile
# Build-Image
FROM eclipse-temurin:21-jdk-alpine AS build
WORKDIR /app
COPY . .
RUN ./mvnw package -DskipTests

# Runtime-Image
FROM eclipse-temurin:21-jre-alpine
WORKDIR /app
COPY --from=build /app/target/*.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
```

### Build und Ausführung

```bash
docker build -t myapp .
docker run -p 8080:8080 myapp
```

## Best Practices

1. **LTS-Versionen verwenden** - JDK 21 oder JDK 17 für Produktion
2. **Angemessene Heap-Größe einstellen** - Überwachen und an Anwendungsbedürfnisse anpassen
3. **GC-Protokollierung aktivieren** - Zur Fehlerbehebung bei Leistungsproblemen
4. **Modulares JDK verwenden** - Container-Image-Größe mit jlink reduzieren
5. **Aktuell halten** - Sicherheitspatches regelmäßig anwenden

## Verwandte Links

- [Java Offizielle Dokumentation](https://docs.oracle.com/en/java/javase/)
- [JVM-Options-Referenz](https://docs.oracle.com/en/java/javase/21/tools/java.html)
- [Maven Central](https://maven.apache.org/)
- [Gradle](https://gradle.org/)
