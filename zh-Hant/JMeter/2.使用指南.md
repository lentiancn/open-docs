# JMeter 使用指南

本指南介紹如何使用 JMeter 進行效能測試。

## 快速開始

### 建立測試計劃

1. 開啟 JMeter
2. 建立測試計劃
3. 新增執行緒群組
4. 新增取樣器
5. 新增監聽器
6. 執行測試

## 執行緒群組

### 設定執行緒群組

```
執行緒數：10
 Ramp-Up 時間：5秒
 循環次數：1
```

### 執行緒屬性

- 執行緒數：並發使用者數
- Ramp-Up 時間：啟動時間
- 循環次數：每個使用者執行次數

## 取樣器

### HTTP 請求

```
通訊協定：http
伺服器名稱：www.example.com
路徑：/api/users
方法：GET
```

### 參數

- 查詢參數
- POST/GET 參數
- 檔案上傳

## 監聽器

### 檢視結果樹

```markdown
- 檢視請求和回應
- 偵錯測試腳本
```

### 聚合報告

```markdown
- 平均回應時間
- 中位數
- 90% 百分位
- 吞吐量
```

### 圖形結果

```markdown
- 視覺化回應時間
- 即時監控
```

## 控制器

### 邏輯控制器

- 如果控制器
- 循環控制器
- 隨機控制器
- 交易控制器

### 控制器使用

```bash
# 循環 5 次
Loop Controller: 5

# 隨機選擇
Random Controller
```

## 斷言

### 回應斷言

```bash
# 檢查回應包含
Response Assertion
Pattern: "success"

# 檢查回應碼
Response Code: 200
```

### JSON 斷言

```bash
# 檢查 JSON 值
JSON Path: $.status
Expected Value: success
```

## 參數化

### CSV 資料檔

```bash
# 建立 CSV 檔案
username,password
user1,pass1
user2,pass2
```

### 配置

```
CSV Data Set Config
Filename: users.csv
Variable Names: username,password
```

### 函數

- __Random
- __time
- __counter

## 相關性

### 正則表達式擷取

```
正則表達式：token="(.+?)"
範本：$1$
匹配數字：1
```

### JSON 擷取

```
JSON Path: $.data.token
```

## 分散式測試

### 設定主從

```bash
# 從機配置
remote_hosts=192.168.1.2,192.168.1.3

# 啟動
jmeter -R 192.168.1.2
```

### 執行

```bash
# 分散式執行
jmeter -n -t test.jmx -R server1,server2
```

## 命令列執行

### 基本指令

```bash
# 執行測試
jmeter -n -t test.jmx -l result.jtl

# 產生報告
jmeter -g result.jtl -o report
```

### 參數

```bash
-n 非 GUI 模式
-t 測試計劃檔案
-l 結果檔案
-r 分散式執行
```

## 效能優化

### 1. 使用斷言

```bash
# 只新增必要斷言
Response Assertion
```

### 2. 監聽器優化

```bash
# 生產環境減少監聽器
# 使用 Simple Data Writer
```

### 3. 預熱

```bash
# 先預熱再正式測試
```

## 報告產生

### HTML 報告

```bash
jmeter -g result.jtl -o /path/to/report
```

### Dashboard

```bash
# 完整報告
jmeter -n -t test.jmx -l result.jtl -e -o report
```

## 最佳實踐

### 1. 測試設計

```bash
# 真實模擬使用者行為
# 參數化測試資料
```

### 2. 結果分析

```bash
# 關注回應時間
# 分析錯誤率
```

## 相關資源

- [JMeter 官方文件](https://jmeter.apache.org/usermanual/)
- [JMeter 外掛](https://jmeter-plugins.org/)
