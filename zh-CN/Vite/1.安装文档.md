# Vite 安装指南

Vite 是新一代前端构建工具。本指南涵盖在所有环境中的安装方法。

## 版本信息

| 版本 | 状态 | 说明 |
|------|------|------|
| Vite 5.x | ✅ 当前 | 最新稳定版本 |
| Vite 4.x | ✅ 支持 | 稳定版本 |
| Vite 3.x | ⚠️ 维护 | 安全更新 |
| Vite 2.x | ❌ 旧版 | 不建议新项目使用 |

> **重要提示**：本指南主要针对 **Vite 5.x**。建议新项目使用最新版本。

## 前提条件

### 系统要求

| 要求 | 版本 |
|------|------|
| Node.js | 18.0.0+ |
| npm | 8.0.0+ |

### 浏览器支持

| 浏览器 | 版本 |
|--------|------|
| Chrome | 80+ |
| Firefox | 80+ |
| Safari | 14+ |
| Edge | 80+ |

## 安装方法

### 方法一：使用 npm 创建项目（推荐）

```bash
# 创建 Vue 项目
npm create vite@latest my-vue-app -- --template vue

# 创建 React 项目
npm create vite@latest my-react-app -- --template react

# 创建 Vanilla JS 项目
npm create vite@latest my-vanilla-app -- --template vanilla

# 创建 Svelte 项目
npm create vite@latest my-svelte-app -- --template svelte

# 创建 Preact 项目
npm create vite@latest my-preact-app -- --template preact
```

### 方法二：全局安装

```bash
# 安装 Vite
npm install -g create-vite

# 创建项目
create-vite my-app --template vue
```

### 方法三：使用 yarn

```bash
# 创建 Vue 项目
yarn create vite my-vue-app --template vue

# 创建 React 项目
yarn create vite my-react-app --template react
```

### 方法四：使用 pnpm

```bash
# 创建 Vue 项目
pnpm create vite my-vue-app --template vue
```

### 方法五：手动创建

```bash
# 创建项目目录
mkdir my-vite-project
cd my-vite-project

# 初始化 npm
npm init -y

# 安装 Vite
npm install vite --save-dev

# 安装 Vue
npm install vue
```

## 项目结构

```
my-vite-project/
├── public/
│   └── favicon.ico
├── src/
│   ├── main.js
│   ├── App.vue
│   └── style.css
├── index.html
├── package.json
└── vite.config.js
```

## 配置文件

### vite.config.js

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],
  server: {
    port: 3000,
    open: true,
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
  },
})
```

### 环境变量

```
# .env
VITE_APP_TITLE=My App
VITE_API_URL=https://api.example.com
```

### 生产环境配置

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],
  build: {
    outDir: 'dist',
    sourcemap: false,
    minify: 'terser',
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router'],
        },
      },
    },
  },
})
```

## 开发命令

### 常用命令

```bash
# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产版本
npm run preview

# 运行测试
npm run test

# 类型检查
npm run typecheck
```

### package.json 脚本

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "test": "vitest",
    "typecheck": "vue-tsc --noEmit"
  }
}
```

## 插件配置

### Vue 插件

```bash
npm install @vitejs/plugin-vue
```

```javascript
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],
})
```

### React 插件

```bash
npm install @vitejs/plugin-react
```

```javascript
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
})
```

### 图片处理

```bash
npm install -D vite-plugin-imagemin
```

```javascript
import viteImagemin from 'vite-plugin-imagemin'

export default defineConfig({
  plugins: [
    viteImagemin({
      pngquant: [10],
      jpegoptim: true,
    }),
  ],
})
```

## 样式配置

### CSS

```javascript
export default defineConfig({
  css: {
    preprocessorOptions: {
      css: {
        charset: false,
      },
    },
  },
})
```

### Sass

```bash
npm install -D sass
```

```javascript
export default defineConfig({
  css: {
    preprocessorOptions: {
      scss: {
        additionalData: `@import "@/styles/variables.scss";`,
      },
    },
  },
})
```

### PostCSS

```bash
npm install -D autoprefixer postcss
```

```javascript
// postcss.config.js
export default {
  plugins: {
    autoprefixer: {},
  },
}
```

## 代理配置

```javascript
export default defineConfig({
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, ''),
      },
    },
  },
})
```

## 性能优化

### 代码分割

```javascript
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'vendor': ['vue', 'vue-router', 'pinia'],
        },
      },
    },
  },
})
```

### 压缩

```bash
npm install -D terser
```

```javascript
export default defineConfig({
  build: {
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
      },
    },
  },
})
```

### 资源内联

```javascript
export default defineConfig({
  build: {
    assetsInlineLimit: 4096,
  },
})
```

## 常见问题

### 构建失败？

确保所有依赖已安装：

```bash
npm install
```

### 热更新不工作？

检查 devServer 配置：

```javascript
export default defineConfig({
  server: {
    hmr: true,
  },
})
```

### 路径别名？

配置 resolve.alias：

```javascript
import path from 'path'

export default defineConfig({
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
})
```

## 相关链接

- [Vite 官方文档](https://vitejs.dev/)
- [Vite 中文文档](https://cn.vitejs.dev/)
- [Awesome Vite](https://github.com/vitejs/awesome-vite)
