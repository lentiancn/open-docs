# PyTorch 安装指南

## 环境要求

- Python 3.8+
- CUDA（GPU 支持）
- cuDNN

## CPU 版本

```bash
# 创建虚拟环境
python -m venv pytorch-env
source pytorch-env/bin/activate  # Linux/macOS
# 或
pytorch-env\Scripts\activate  # Windows

# 安装
pip install torch torchvision
```

## GPU 版本

### 方式一：pip

```bash
# CUDA 11.8
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118

# CUDA 12.1
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
```

### 方式二：conda

```bash
# CPU 版本
conda install pytorch torchvision cpuonly -c pytorch

# GPU 版本
conda install pytorch torchvision pytorch-cuda=11.8 -c pytorch -c nvidia
```

## 验证安装

```python
import torch

print(f"PyTorch version: {torch.__version__}")

# 检查 GPU
print(f"CUDA available: {torch.cuda.is_available()}")
print(f"GPU count: {torch.cuda.device_count()}")
print(f"GPU name: {torch.cuda.get_device_name(0) if torch.cuda.is_available() else 'N/A'}")

# 简单测试
x = torch.rand(3, 3)
y = torch.rand(3, 3)
z = torch.matmul(x, y)
print(z)
```

## Docker

```bash
# CPU 版本
docker run --rm -it pytorch/pytorch

# GPU 版本
docker run --gpus all --rm -it pytorch/pytorch
```
