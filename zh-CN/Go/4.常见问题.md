# Go 常见问题

> 常见问题解答

---

## 安装问题

### Windows 下安装后找不到 go 命令？

**解决方案**：

1. 确认安装路径（通常是 `C:\Go`）
2. 将 `C:\Go\bin` 添加到系统 PATH 环境变量
3. 重启终端或电脑
4. 运行 `go version` 验证

### macOS brew 安装失败？

**解决方案**：

1. 确保 Homebrew 已正确安装
2. 运行 `brew update` 更新
3. 尝试：`brew install go --cask`

### Linux 安装后找不到 go 命令？

**解决方案**：

1. 确认解压路径（通常是 `/usr/local/go`）
2. 检查环境变量配置
3. 刷新环境变量：`source ~/.bashrc`

---

## 环境配置问题

### Go Modules 代理如何配置？

**国内推荐配置**：

```bash
go env -w GOPROXY=https://goproxy.cn,direct
```

### GOPATH 是什么？

GOPATH 是 Go 的工作目录，用于存放源代码和编译产物。

默认情况下：
- Linux/macOS: `$HOME/go`
- Windows: `C:\Users\用户名\go`

### 如何查看 Go 环境信息？

```bash
go env
```

---

## 开发问题

### 编译报错 "cannot find package"？

**解决方案**：

1. 确认项目是否使用 Go Modules
2. 运行 `go mod init` 初始化
3. 运行 `go mod tidy` 下载依赖

### 如何导入本地包？

```go
import (
    "./mypackage"  // 相对路径（不推荐）
)

// 或使用模块路径
import "github.com/username/project/mypackage"
```

### Go 模块如何版本控制？

Go Modules 使用语义化版本：

```bash
go get package@v1.2.3
go get package@latest
go get package@master
```

---

## 语法问题

### := 和 var 有什么区别？

- `var` ：显式声明，可用于函数外
- `:=` ：短声明，只能用于函数内，编译器自动推断类型

### nil 是什么？

nil 是 Go 的零值，用于指针、切片、map、channel、函数、接口。

```go
var p *int  // nil
var s []int // nil
var m map[string]int // nil
```

### 如何判断 nil？

```go
if s == nil {
    fmt.Println("为空")
}
```

---

## 并发问题

### Goroutine 泄漏如何避免？

确保 goroutine 会退出：

```go
// 使用 context
func worker(ctx context.Context) {
    for {
        select {
        case <-ctx.Done():
            return
        default:
            // 工作
        }
    }
}
```

### Channel 关闭后还能读吗？

可以读取已关闭 channel 的值，但会返回零值。

```go
ch := make(chan int, 3)
ch <- 1
ch <- 2
close(ch)

// 可以读取剩余值
for v := range ch {
    fmt.Println(v)
}
```

---

## 性能问题

### 如何优化 Go 程序性能？

1. 使用 `go build -ldflags="-s -w"` 减少二进制大小
2. 避免不必要的内存分配
3. 使用 sync.Pool 复用对象
4. 使用 pprof 分析性能

### 如何使用 pprof？

```bash
# 启动服务
go tool pprof http://localhost:6060/debug/pprof/heap

# 生成 CPU profile
go test -cpuprofile=cpu.out ./...

# 分析
go tool pprof cpu.out
```

---

## 工具问题

### GoLand vs VS Code 哪个好？

- **GoLand**：功能全面，智能提示强，付费
- **VS Code**：免费，轻量，需要配置

### 如何格式化代码？

```bash
go fmt ./...
go fmt -w ./...  # 写入文件
```

### 如何运行测试？

```bash
go test ./...
go test -v ./...
go test -cover ./...
```

---

## 迁移问题

### 从 Python 转到 Go 难吗？

Go 比 Python 更严格：
- 静态类型，需要声明类型
- 没有异常，需要显式错误处理
- 编译型语言，没有解释器

### 如何使用 Go 调用 C/C++ 代码？

使用 cgo：

```go
/*
#include <stdio.h>
void sayHello() {
    printf("Hello from C!\n");
}
*/
import "C"

func main() {
    C.sayHello()
}
```

---

## 相关资源

- Go 官方文档：https://go.dev/doc/
- Go 语言中文网：https://studygolang.com/
- Go by Example：https://gobyexample.com/
