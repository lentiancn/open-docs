# Flutter 常见问题

> 当前版本：Flutter 3.41.2

---

## 基础问题

### Q: Flutter 是什么？适合做什么？

Google 开发的跨平台 UI 框架，使用 Dart 语言，可构建 iOS、Android、Web、Windows、macOS、Linux 应用。

适合：品牌化应用、多平台一致项目、快速原型、MVP

---

### Q: Flutter 和 React Native 区别？

| 特性 | Flutter | React Native |
|------|---------|--------------|
| 语言 | Dart | JavaScript |
| 渲染 | Skia 自行绘制 | 原生组件 |
| 性能 | 更高 | 较好 |

---

### Q: 为什么用 Dart？

- JIT + AOT 双编译（开发热重载，发布原生编译）
- 面向对象，适合 UI 框架
- Google 官方支持

---

### Q: 支持热更新吗？

官方不支持，有第三方方案 **Shorebird**（App Store 可能有审核限制）

---

## 安装问题

### Q: flutter doctor 报错？

```bash
flutter doctor -v   # 查看详细
```

常见问题：
- Android SDK 缺失 → 安装 Android Studio
- license 未接受 → `flutter doctor --android-licenses`
- Xcode 问题 → `sudo xcodebuild -runFirstLaunch`

---

### Q: 下载速度慢？

使用国内镜像：

```bash
# Windows
[Environment]::SetEnvironmentVariable("FLUTTER_STORAGE_BASE_URL", "https://storage.flutter-io.cn")

# macOS/Linux
export FLUTTER_STORAGE_BASE_URL="https://storage.flutter-io.cn"
```

---

### Q: macOS 权限错误？

```bash
sudo xcodebuild -runFirstLaunch
```

---

### Q: 如何卸载？

**Windows**：删除 Flutter 目录 + PATH 记录

**macOS/Linux**：

```bash
sudo rm -rf ~/flutter
```

---

## 开发问题

### Q: setState 不生效？

检查是否在 `build()` 中使用了状态变量，是否正确调用了 setState：

```dart
// ✅ 正确
setState(() => _count++);

// ❌ 错误 - 未调用 setState
_count++;
```

---

### Q: Widget 不显示？

检查约束：
- 父容器是否有约束
- 是否设置了宽高
- Row/Column 主轴方向

---

### Q: 网络请求失败？

1. 检查网络和 URL
2. 添加超时处理：

```dart
dio.get(url, options: Options(
  sendTimeout: Duration(seconds: 10),
  receiveTimeout: Duration(seconds: 10),
));
```

3. Android 添加权限：

```xml
<uses-permission android:name="android.permission.INTERNET"/>
```

---

### Q: 状态管理选哪个？

| 场景 | 方案 |
|------|------|
| 学习/小型 | setState |
| 中小型 | Provider |
| 大型 | Riverpod / BLoC |
| 快速开发 | GetX |

---

## 构建问题

### Q: 构建 APK 失败？

```bash
flutter clean
flutter pub get
flutter build apk --debug
```

---

### Q: 构建 iOS 失败？

```bash
flutter build ios --release --no-codesign
```

或打开 Xcode 检查 Signing & Capabilities

---

### Q: Web 刷新 404？

配置服务器重定向到 index.html：

```nginx
location / {
  try_files $uri $uri/ /index.html;
}
```

---

## 性能问题

### Q: 应用卡顿？

1. 使用 const 减少重建
2. ListView 用 builder 懒加载
3. 避免在 build 中创建对象

```dart
// ✅
ListView.builder(...)

// ❌
ListView(children: items.map(...).toList())
```

---

### Q: 内存占用高？

- 图片设置 cacheWidth/cacheHeight
- 在 dispose() 中释放资源
- 使用 const

---

### Q: 首屏加载慢？

- 使用 deferred 延迟加载
- 预加载资源
- 使用 WebP 图片

---

## 平台问题

### Q: iOS 状态栏颜色？

```dart
AppBar(
  systemOverlayStyle: SystemUiOverlayStyle.dark,
)
```

---

### Q: Android 全面屏？

```dart
Scaffold(
  body: SafeArea(child: Content()),
)
```

---

## 更多资源

- 官方 FAQ：https://docs.flutter.dev/resources/faq
- 中文社区：https://flutter.cn

---

## 下一步

- [返回首页](./README.md)
