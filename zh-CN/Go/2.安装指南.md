# Go 语言安装指南

本指南将帮助你完成 Go 语言开发环境的搭建，包括各种操作系统的安装步骤、环境配置以及第一个程序的编写。

## 环境要求

在安装 Go 之前，请确保你的系统满足以下要求：

| 操作系统 | 要求 |
|----------|------|
| Windows | Windows 7 及以上，64 位 |
| macOS | macOS 10.13 及以上 |
| Linux | Ubuntu 18.04+, Debian 10+, CentOS 7+ |

## 安装步骤

### Windows 安装

#### 方法一：使用安装包（推荐）

1. 访问 Go 官网下载页面：https://go.dev/dl/
2. 下载 Windows MSI 安装包（go1.21.x.windows-amd64.msi）
3. 双击运行安装程序
4. 按照提示完成安装（默认安装到 C:\Program Files\Go）
5. 验证安装：
   ```powershell
   go version
   # 输出：go1.21.x linux/amd64
   ```

#### 方法二：使用 Chocolatey

```powershell
# 安装 Chocolatey（如果未安装）
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# 安装 Go
choco install golang -y
```

#### 方法三：手动安装

1. 下载 ZIP 包：https://go.dev/dl/go1.21.x.windows-amd64.zip
2. 解压到指定目录（如 C:\Go）
3. 添加环境变量：
   - 将 C:\Go\bin 添加到 PATH
   - 创建 GOROOT：C:\Go
   - 创建 GOPATH：%USERPROFILE%\go
4. 验证安装：
   ```powershell
   go version
   ```

### macOS 安装

#### 方法一：使用 Homebrew（推荐）

```bash
# 安装 Homebrew（如果未安装）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 Go
brew install go

# 验证安装
go version
```

#### 方法二：使用安装包

1. 访问 https://go.dev/dl/
2. 下载 macOS 安装包（go1.21.x.darwin-amd64.pkg 或 go1.21.x.darwin-arm64.pkg）
3. 双击运行安装包
4. 按照提示完成安装
5. 验证安装：
   ```bash
   go version
   ```

#### 方法三：手动安装

```bash
# 下载 Go
curl -O https://go.dev/dl/go1.21.x.darwin-amd64.tar.gz

# 解压到 /usr/local
sudo tar -C /usr/local -xzf go1.21.x.darwin-amd64.tar.gz

# 添加到 PATH（添加到 ~/.zshrc 或 ~/.bash_profile）
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.zshrc
source ~/.zshrc

# 验证安装
go version
```

### Linux 安装

#### 方法一：使用包管理器

**Ubuntu/Debian：**
```bash
# 更新软件包列表
sudo apt update

# 安装 Go
sudo apt install golang-go

# 验证安装
go version
```

**CentOS/RHEL：**
```bash
# 安装 Go
sudo yum install golang

# 验证安装
go version
```

**Fedora：**
```bash
sudo dnf install golang
```

#### 方法二：手动安装（推荐）

```bash
# 下载 Go
wget https://go.dev/dl/go1.21.x.linux-amd64.tar.gz

# 解压到 /usr/local
sudo rm -rf /usr/local/go
sudo tar -C /usr/local -xzf go1.21.x.linux-amd64.tar.gz

# 添加到 PATH（添加到 ~/.bashrc 或 ~/.profile）
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc

# 验证安装
go version
```

#### 方法三：使用 Go 版本管理工具

```bash
# 安装 gvm（Go Version Manager）
bash < <(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)

# 安装 Go
gvm install go1.21
gvm use go1.21 --default

# 验证安装
go version
```

## 环境变量配置

Go 使用几个重要的环境变量来管理代码和依赖：

### GOPATH

GOPATH 是 Go 工作目录，用于存放源代码和编译后的二进制文件：

```bash
# Linux/macOS
export GOPATH=$HOME/go

# Windows（系统环境变量）
# GOPATH = %USERPROFILE%\go
```

### GOROOT

GOROOT 是 Go 的安装目录（通常不需要手动设置）：

```bash
# Linux/macOS
export GOROOT=/usr/local/go

# Windows
# GOROOT = C:\Go
```

### PATH

确保 Go 的 bin 目录在 PATH 中：

```bash
# Linux/macOS
export PATH=$PATH:$GOROOT/bin:$GOPATH/bin

# Windows
# 在系统 PATH 中添加：%GOROOT%\bin;%GOPATH%\bin
```

### 代理配置

如果在中国大陆使用 Go，需要配置代理：

```bash
# 设置 GOPROXY
go env -w GOPROXY=https://goproxy.cn,direct

# 或者使用阿里云代理
go env -w GOPROXY=https://mirrors.aliyun.com/goproxy/,direct

# 查看所有 Go 环境变量
go env
```

## 验证安装

安装完成后，运行以下命令验证：

```bash
# 检查 Go 版本
go version

# 检查 Go 环境信息
go env

# 查看 Go 安装路径
go env GOROOT

# 查看工作目录
go env GOPATH
```

## 创建第一个 Go 程序

### 步骤 1：创建项目目录

```bash
# 创建工作目录
mkdir -p $HOME/go/src/hello
cd $HOME/go/src/hello
```

### 步骤 2：编写代码

创建 `main.go` 文件：

```go
package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}
```

### 步骤 3：运行程序

```bash
# 方式1：直接运行
go run main.go

# 方式2：编译后运行
go build -o hello main.go
./hello

# Windows
hello.exe
```

## Go Modules

Go 1.11 引入了 Modules，用于依赖管理。从 Go 1.16 开始，Modules 是默认的依赖管理方式。

### 创建新模块

```bash
# 初始化模块
go mod init github.com/username/hello

# 添加依赖
go get github.com/gin-gonic/gin

# 更新依赖
go get -u all

# 整理依赖
go mod tidy
```

### 模块命令详解

```bash
# 初始化新模块
go mod init <module-name>

# 下载依赖
go mod download

# 添加依赖
go get <package>

# 移除未使用的依赖
go mod tidy

# 查看依赖
go list -m all

# 验证依赖
go mod verify

# 导出依赖
go mod vendor
```

### go.mod 文件示例

```go
module github.com/username/hello

go 1.21

require (
    github.com/gin-gonic/gin v1.9.1
    github.com/go-redis/redis/v8 v8.11.5
)
```

## Go 开发工具

### 常用 IDE 和编辑器

1. **Visual Studio Code**（免费，推荐）
   - 安装 Go 扩展
   - 丰富的代码补全和调试功能

2. **GoLand**（付费，JetBrains）
   - 专业的 Go 开发 IDE
   - 强大的重构和调试功能

3. **Sublime Text**
   - 安装 GoSublime 插件

4. **Vim/Neovim**
   - 安装 vim-go 插件

### VS Code Go 扩展安装

1. 打开 VS Code
2. 搜索并安装 "Go" 扩展（作者：Go Team at Google）
3. 安装必要的工具：
   - 打开命令面板（Ctrl+Shift+P）
   - 输入 "Go: Install/Update Tools"
   - 选择要安装的工具

## Go 项目结构

推荐的项目结构：

```
myproject/
├── cmd/
│   └── myapp/
│       └── main.go
├── pkg/
│   └── mypackage/
│       └── mypackage.go
├── internal/
│   └── mymodule/
│       └── module.go
├── go.mod
├── go.sum
└── README.md
```

### 目录说明

| 目录 | 说明 |
|------|------|
| cmd/ | 应用程序入口 |
| pkg/ | 可复用的包 |
| internal/ | 私有包 |
| api/ | API 定义 |
| configs/ | 配置文件 |
| scripts/ | 脚本文件 |
| docs/ | 文档 |

## 常用命令速查

```bash
# 基础命令
go version          # 查看版本
go env              # 查看环境变量
go help             # 查看帮助

# 运行和构建
go run main.go      # 直接运行
go build main.go    # 编译
go install          # 编译并安装到 GOPATH/bin

# 测试
go test ./...       # 运行所有测试
go test -v          # 详细输出
go test -cover      # 显示覆盖率

# 依赖管理
go mod init         # 初始化模块
go get              # 获取依赖
go mod tidy         # 整理依赖
go mod download     # 下载依赖

# 代码质量
go fmt              # 格式化代码
go vet              # 检查代码问题
go lint             # 代码静态分析
golint              # 代码风格检查

# 文档
go doc              # 查看文档
go doc package      # 查看包文档
godoc -http=:6060   # 启动本地文档服务器
```

## 常见问题

### Q1: go: command not found

**解决方案：**
- 确认 Go 已正确安装
- 检查 PATH 环境变量是否包含 Go 的 bin 目录
- 重新打开终端

### Q2: 下载依赖超时

**解决方案：**
```bash
# 配置代理
go env -w GOPROXY=https://goproxy.cn,direct
```

### Q3: 编译速度慢

**解决方案：**
- 使用 Go 1.18+ 的并行编译
- 确保有足够的内存
- 使用 SSD 硬盘

### Q4: 模块版本冲突

**解决方案：**
```bash
# 使用 go mod tidy 整理依赖
go mod tidy
```

## 卸载 Go

### Windows

1. 打开控制面板
2. 选择 "程序和功能"
3. 找到 "Go" 并卸载
4. 删除 Go 安装目录（如 C:\Go）
5. 删除环境变量

### macOS

```bash
# 使用 Homebrew
brew uninstall go

# 手动删除
sudo rm -rf /usr/local/go
```

### Linux

```bash
# 删除安装目录
sudo rm -rf /usr/local/go

# 移除环境变量
# 编辑 ~/.bashrc 或 ~/.profile，删除相关行
```

## 下一步

安装完成后，建议学习：

- [Go 语言使用手册](./3.使用手册.md) - 深入学习 Go 语法和特性
- [Go 语言常见问题](./4.常见问题.md) - 解答常见开发问题
- 官方 Tour：https://go.dev/tour/
- Go 语言规范：https://go.dev/ref/spec
