# Go よくある質問

> Goに関する一般的な質問への回答

---

## インストール

### Q: インストール後コマンドが見つからない？

**A**: 
- GoがPATH環境変数に追加されているか確認
- Windowsの場合、デフォルトでC:\Goにインストールされ、PATHに追加が必要
- Linux/macOSでは通常~/.bashrcや~/.zshrcに手動で追加

### Q: Goがインストールされているか確認方法は？

**A**: 
```bash
go version
go env GOPATH
```

### Q: Goのバージョンを上げる方法は？

**A**: 
- Windows：新バージョンをダウンロードして再インストール
- macOS：`brew upgrade go`
- Linux：新バージョンをダウンロードして置き換えるか、パッケージマネージャを使用

---

## 構文

### Q: Goに例外メカニズムはある？

**A**: Goには従来の意味での例外はありません。エラーは戻り値で伝えられます：
```go
result, err := doSomething()
if err != nil {
    // エラー処理
}
```

### Q: :=とvarを混合できない理由は？

**A**: 
- `:=`は短い変数宣言で、関数内で使用
- `var`は明示的な宣言で、関数外でも使用可能
- 同じ変数に対して両方を同時に使用することはできません

### Q: Goはジェネリックをサポートしている？

**A**: Go 1.18+でジェネリックがサポートされています：
```go
func Print[T any](s []T) {
    for _, v := range s {
        fmt.Println(v)
    }
}
```

---

## 並发

### Q: Goroutineとスレッドの違いは？

**A**: 
- GoroutineはGoランタイムによって管理され、スレッドより軽量
- 何千ものGoroutineを作成してもリソースを消費し尽くすことがない
- channelを使用した通信

### Q: channelを閉じるべき？

**A**: 
- 通常、送信者がchannelを閉じる
- 受信者は`v, ok := <-ch`を使用してchannelが閉じているか確認できる
- 閉じたchannelに送信しない

### Q: Goroutineの終了を優雅に待つ方法は？

**A**: sync.WaitGroupを使用：
```go
var wg sync.WaitGroup

for i := 0; i < 5; i++ {
    wg.Add(1)
    go func(i int) {
        defer wg.Done()
        fmt.Println(i)
    }(i)
}

wg.Wait()
```

---

## パッケージ管理

### Q: GOPATHとGo Moduleの違いは？

**A**: 
- GOPATH：古い依存関係管理方法、依存関係を$GOPATH/srcに保存
- Go Module（go.mod）：現代的なアプローチ、より良いバージョン管理

### Q: 依存関係のダウンロードが遅い場合は？

**A**: 
```bash
# 中国ミラーを使用
go env -w GOPROXY=https://goproxy.cn,direct

# 設定も可能
go env -w GOPROXY=https://proxy.golang.org,direct
```

### Q: 依存関係を確認方法は？

**A**: 
```bash
go mod graph
go list -m all
```

---

## パフォーマンス

### Q: パフォーマンス分析を行う方法は？

**A**: 
```bash
# CPUプロファイリング
go test -cpuprofile=cpu.out

# メモリプロファイリング
go test -memprofile=mem.out

# pprofで分析
go tool pprof cpu.out
```

### Q: Goプログラムを最適化方法は？

**A**: 
- 文字列結合にはstrings.Builderを使用
- 不要なメモリ割り当てを避ける
- オブジェクト再利用にプール（sync.Pool）を使用
- channelを効率的に使用

---

## ツール

### Q: go fmtとgo vetの違いは？

**A**: 
- go fmt：コードスタイルをフォーマット
- go vet：静的分析、潜在的なエラーをチェック

### Q: ドキュメントを生成方法は？

**A**: 
```bash
go doc <パッケージ名>
go doc <関数名>

# ローカルドキュメントサーバー
go doc -http=:6060
```

---

## エラー

### Q: 一般的なコンパイルエラーは？

**A**: 
- `undefined: xxx` - 変数が未定義
- `mismatched types` - 型が一致しない
- `invalid character` - 文字エンコーディングの問題
- `package xxx is not in GOROOT` - パッケージパスエラー

### Q: ランタイムpanicが発生した場合は？

**A**: 
- deferとrecoverを使用：
```go
func safeCall() {
    defer func() {
        if r := recover(); r != nil {
            fmt.Println("回復:", r)
        }
    }()
    // panicが発生する可能性のあるコード
}
```
