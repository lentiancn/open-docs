# Docker 安装文档

本文档详细介绍在所有主流平台上安装 Docker 的方法。

---

## 目录

- [Docker Desktop（推荐）](#docker-desktop推荐)
- [Linux 系统](#linux-系统)
  - [Ubuntu/Debian](#ubuntudebian)
  - [CentOS/RHEL](#centosrhel)
  - [Fedora](#fedora)
  - [Arch Linux](#arch-linux)
- [macOS](#macos)
- [Windows](#windows)
- [验证安装](#验证安装)
- [安装后配置](#安装后配置)
- [卸载 Docker](#卸载-docker)

---

## Docker Desktop（推荐）

Docker Desktop 是最简单的方式，适合 macOS、Windows和 Linux。它包含 Docker Engine、Docker CLI、Docker Compose 等所有组件。

### 系统要求

**macOS:**
- Apple Silicon: macOS 11.0+，至少 4GB RAM
- Intel 芯片: macOS 10.15+，至少 4GB RAM

**Windows:**
- Windows 10/11 64 位
- WSL2（推荐）或 Hyper-V

**Linux:**
- 主流发行版：Ubuntu、Debian、Fedora、Arch Linux
- 至少 4GB RAM

### 下载地址

- **macOS Apple Silicon**: [Docker Desktop for Mac (ARM64)](https://desktop.docker.com/mac/main/arm64/Docker.dmg)
- **macOS Intel**: [Docker Desktop for Mac (x86_64)](https://desktop.docker.com/mac/main/amd64/Docker.dmg)
- **Windows**: [Docker Desktop for Windows](https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe)
- **Linux**: 参见下方 Linux 安装部分

---

## Linux 系统

### Ubuntu

```bash
# 1. 更新软件包索引
sudo apt update

# 2. 安装依赖
sudo apt install -y ca-certificates curl gnupg lsb-release

# 3. 添加 Docker 官方 GPG 密钥
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# 4. 添加 Docker 仓库
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# 5. 安装 Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 6. 启动并启用 Docker
sudo systemctl start docker
sudo systemctl enable docker

# 7. 将当前用户添加到 docker 组
sudo usermod -aG docker $USER
```

### Debian

将上面命令中的 `ubuntu` 替换为 `debian` 即可。

### CentOS/RHEL

```bash
# 1. 安装依赖
sudo yum install -y yum-utils

# 2. 添加 Docker 仓库
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

# 3. 安装 Docker
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 4. 启动并启用 Docker
sudo systemctl start docker
sudo systemctl enable docker

# 5. 将当前用户添加到 docker 组
sudo usermod -aG docker $USER
```

### Fedora

```bash
# 1. 安装依赖
sudo dnf -y install dnf-plugins-core

# 2. 添加 Docker 仓库
sudo dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo

# 3. 安装 Docker
sudo dnf install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 4. 启动并启用 Docker
sudo systemctl start docker
sudo systemctl enable docker

# 5. 将当前用户添加到 docker 组
sudo usermod -aG docker $USER
```

### Arch Linux

```bash
# 1. 安装 Docker
sudo pacman -S docker

# 2. 启动并启用 Docker
sudo systemctl start docker
sudo systemctl enable docker

# 3. 将当前用户添加到 docker 组
sudo usermod -aG docker $USER
```

---

## macOS

### Apple Silicon (M1/M2/M3)

**方式一：Homebrew（推荐）**
```bash
brew install --cask docker
```

**方式二：手动下载**
1. 下载 [Docker Desktop for Mac (Apple Silicon)](https://desktop.docker.com/mac/main/arm64/Docker.dmg)
2. 双击打开，将 Docker 拖到 Applications 文件夹
3. 双击 Docker.app 启动

### Intel 芯片 Mac

```bash
brew install --cask docker
```

或手动下载 [Docker Desktop for Mac (Intel)](https://desktop.docker.com/mac/main/amd64/Docker.dmg)

---

## Windows

### WSL2（推荐）

```powershell
# 1. 启用 WSL2
wsl --install

# 2. 重启计算机

# 3. 在 WSL2 中安装 Docker
sudo apt update
sudo apt install -y docker.io
sudo service docker start
sudo usermod -aG docker $USER
```

### Docker Desktop

1. 下载 [Docker Desktop for Windows](https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe)
2. 双击运行安装程序
3. 安装时勾选 "Use WSL2 instead of Hyper-V"（推荐）
4. 运行 Docker Desktop

---

## 验证安装

```bash
# 查看 Docker 版本
docker --version

# 查看 Docker Compose 版本
docker compose version

# 运行测试容器
docker run hello-world
```

---

## 安装后配置

### 配置国内镜像加速

创建或编辑 `/etc/docker/daemon.json`：

```json
{
  "registry-mirrors": [
    "https://docker.mirrors.ustc.edu.cn",
    "https://hub-mirror.c.163.com"
  ]
}
```

然后重启 Docker：
```bash
sudo systemctl daemon-reload
sudo systemctl restart docker
```

---

## 卸载 Docker

### Ubuntu/Debian

```bash
sudo apt purge -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo rm -rf /var/lib/docker
sudo rm -rf /var/lib/containerd
```

### CentOS/RHEL/Fedora

```bash
sudo yum remove -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo rm -rf /var/lib/docker
```

### macOS

```bash
brew uninstall --cask docker
```

### Windows

在 "设置" -> "应用" 中卸载 Docker Desktop，或在 Docker Desktop 中: Settings -> Troubleshoot -> Clean / Purge data

---

## 下一步

- [Docker 使用指南](./2.使用指南.md)
- 访问 [Docker 官方文档](https://docs.docker.com/)
