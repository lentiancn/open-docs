# MySQL 常見問題

此頁面回答關於 MySQL 的常見問題。

---

## 安裝

### 我應該使用哪個版本的 MySQL？

對於生產環境，建議使用 MySQL 8.0.x 或 8.4.x。

### 如何在 Windows 上安裝 MySQL？

1. 從 https://dev.mysql.com/downloads/installer/ 下載 MySQL Installer
2. 執行安裝程式
3. 選擇「Full」或「Custom」安裝
4. 依照精靈指示完成

### 如何使用 Docker 安裝 MySQL？

```bash
docker run -d --name mysql \
  -e MYSQL_ROOT_PASSWORD=您的密碼 \
  -v mysql-data:/var/lib/mysql \
  -p 3306:3306 \
  mysql:8
```

---

## 連線

### 如何從命令列連線到 MySQL？

```bash
mysql -u root -p
```

### 忘記 MySQL root 密碼

**Linux：**
1. 停止 MySQL：`sudo systemctl stop mysql`
2. 以安全模式啟動：`sudo mysqld_safe --skip-grant-tables`
3. 連線：`mysql -u root`
4. 重設密碼：
```sql
FLUSH PRIVILEGES;
ALTER USER 'root'@'localhost' IDENTIFIED BY '新密碼';
```
5. 重新啟動 MySQL

---

## 資料庫和資料表

### 如何建立資料庫？

```sql
CREATE DATABASE myapp;
```

### 如何建立資料表？

```sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE
);
```

### 如何查看所有資料表？

```sql
SHOW TABLES;
```

---

## 資料操作

### 如何插入資料？

```sql
INSERT INTO users (username, email) VALUES ('john', 'john@example.com');
```

### 如何更新資料？

```sql
UPDATE users SET email = 'new@example.com' WHERE id = 1;
```

### 如何刪除資料？

```sql
DELETE FROM users WHERE id = 1;
```

---

## 查詢

### 如何連接資料表？

```sql
SELECT * FROM orders 
INNER JOIN users ON orders.user_id = users.id;
```

### 如何使用 LIMIT 和 OFFSET？

```sql
SELECT * FROM users LIMIT 10 OFFSET 20;
```

### 如何計算列數？

```sql
SELECT COUNT(*) FROM users;
```

---

## 索引

### 如何建立索引？

```sql
CREATE INDEX idx_email ON users(email);
```

### 什麼時候應該使用索引？

- WHERE 子句中的欄位
- JOIN 條件中的欄位
- ORDER BY 中的欄位
- 具有高基數的欄位

---

## 效能

### MySQL 執行緩慢

1. 檢查慢速查詢：`SHOW FULL PROCESSLIST;`
2. 分析查詢：`EXPLAIN SELECT ...`
3. 為常見查詢的欄位新增索引
4. 優化設定

### 如何啟用慢查詢日誌？

在 my.cnf 中：
```ini
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2
```

---

## 備份和復原

### 如何備份資料庫？

```bash
mysqldump -u root -p myapp > backup.sql
```

### 如何復原資料庫？

```bash
mysql -u root -p myapp < backup.sql
```

---

## 使用者管理

### 如何建立新使用者？

```sql
CREATE USER 'username'@'localhost' IDENTIFIED BY 'password';
```

### 如何授予權限？

```sql
GRANT SELECT, INSERT, UPDATE ON myapp.* TO 'username'@'localhost';
```

---

## 錯誤和疑難排解

### 「Too many connections」

在 my.cnf 中增加 max_connections：
```ini
max_connections = 300
```

### 「Table is full」

- 檢查磁碟空間
- 增加 InnoDB 資料表空間大小

### 「Out of memory」

- 增加緩衝池大小
- 優化查詢
- 新增更多 RAM

---

## 資源

- 官方文件：https://dev.mysql.com/doc/
- MySQL 論壇：https://forums.mysql.com/
