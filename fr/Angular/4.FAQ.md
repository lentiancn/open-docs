# Angular FAQ

Questions et réponses courantes.

## Installation

### Q: L'installation d'Angular CLI a échoué?

**Solutions:**
1. Vérifier la version de Node.js
```bash
node --version  # Nécessite 18+ ou 20+
```
2. Vider le cache npm
```bash
npm cache clean --force
```
3. Utiliser l'administrateur (Windows)
4. Vérifier la connexion réseau

### Q: Commande ng non trouvé?

**Solutions:**
1. Confirmer qu'Angular CLI est installé
```bash
npm list -g @angular/cli
```
2. Vérifier la variable d'environnement PATH
3. Réinstaller
```bash
npm uninstall -g @angular/cli
npm install -g @angular/cli@latest
```

### Q: La création du projet a échoué?

**Solutions:**
1. Vérifier l'espace disque
2. Vérifier les permissions npm
3. Utiliser --skip-install
```bash
ng new my-app --skip-install
cd my-app
npm install
```

## Développement

### Q: Le composant ne s'affiche pas?

**Solutions:**
1. Confirmer que le composant est importé correctement
2. Confirmer que le sélecteur est utilisé correctement
3. Vérifier la syntaxe du modèle
4. Vérifier les erreurs dans la console

### Q: Les données ne se mettent pas à jour?

**Solutions:**
1. Pour les Signals, utiliser les méthodes set/update
```typescript
count.set(1);           // Définir une nouvelle valeur
count.update(c => c + 1); // Mettre à jour basée sur l'ancienne valeur
```
2. Pour RxJS, assurer une subscription appropriée
3. Utiliser ChangeDetectorRef pour la détection manuelle
```typescript
constructor(private cdr: ChangeDetectorRef) {}

refresh() {
  this.cdr.detectChanges();
}
```

### Q: Le routage ne fonctionne pas?

**Solutions:**
1. Confirmer que la configuration des routes est correcte
2. Confirmer que RouterOutlet est placé
3. Vérifier l'ordre des routes
```typescript
// Routes spécifiques avant wildcard
{ path: 'user/:id', ... },
{ path: '**', component: NotFoundComponent }
```

### Q: La validation du formulaire ne fonctionne pas?

**Solutions:**
1. Importer ReactiveFormsModule ou FormsModule
2. Confirmer que les noms FormControl sont corrects
3. Utiliser les validateurs correctement
```typescript
this.form = this.fb.group({
  email: ['', [Validators.required, Validators.email]],
  password: ['', [Validators.required, Validators.minLength(6)]]
});
```

## Performance

### Q: Chargement initial lent?

**Solutions:**
1. Utiliser le lazy loading des routes
```typescript
{
  path: 'admin',
  loadComponent: () => import('./admin/admin.component')
    .then(m => m.AdminComponent)
}
```
2. Activer le mode production
```bash
ng build --configuration=production
```
3. La compilation AOT est activée par défaut

### Q: Fuites de mémoire?

**Solutions:**
1. Se désabonner correctement
```typescript
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';

@Component({...})
export class MyComponent implements OnDestroy {
  private destroy$ = new Subject<void>();

  ngOnInit() {
    this.http.get('/api').pipe(
      takeUntil(this.destroy$)
    ).subscribe();
  }

  ngOnDestroy() {
    this.destroy$.next();
    this.destroy$.complete();
  }
}
```
2. Utiliser le pipe async pour subscribe/unsubscribe automatique

### Q: Bundle trop volumineux?

**Solutions:**
1. Vérifier les tailles des dépendances
```bash
npm run build -- --stats-json
npx webpack-bundle-analyzer dist/stats.json
```
2. Utiliser le lazy loading
3. Supprimer les imports non utilisés

## Tests

### Q: Comment écrire des tests unitaires?

**Solutions:**
```typescript
import { ComponentFixture, TestBed } from '@angular/core/testing';
import { UserCardComponent } from './user-card.component';

describe('UserCardComponent', () => {
  let component: UserCardComponent;
  let fixture: ComponentFixture<UserCardComponent>;

  beforeEach(async () => {
    await TestBed.configureTestingModule({
      imports: [UserCardComponent]
    }).compileComponents();

    fixture = TestBed.createComponent(UserCardComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  it('should create', () => {
    expect(component).toBeTruthy();
  });

  it('should display user name', () => {
    component.user = { name: 'Jean', email: 'test@example.com' };
    fixture.detectChanges();
    const compiled = fixture.nativeElement as HTMLElement;
    expect(compiled.querySelector('h3')?.textContent).toContain('Jean');
  });
});
```

### Q: Module de test non trouvé?

**Solutions:**
```typescript
TestBed.configureTestingModule({
  imports: [
    CommonModule,
    HttpClientModule,
    // Autres modules nécessaires
  ]
});
```

## Build

### Q: Build échoué?

**Solutions:**
1. Vérifier les erreurs TypeScript
```bash
npx tsc --noEmit
```
2. Vider le cache
```bash
rm -rf node_modules
npm install
```
3. Mettre à jour la version d'Angular
```bash
ng update @angular/core @angular/cli
```

### Q: Les variables d'environnement ne fonctionnent pas?

**Solutions:**
1. Confirmer que les noms de fichiers d'environnement sont corrects
2. Configurer l'environnement dans angular.json
```json
"configurations": {
  "production": {
    "fileReplacements": [
      {
        "replace": "src/environments/environment.ts",
        "with": "src/environments/environment.prod.ts"
      }
    ]
  }
}
```

## Sécurité

### Q: Comment prévenir les attaques XSS?

**Solutions:**
1. Angular échappe automatiquement par défaut
2. Faire attention avec innerHTML
```typescript
import { DomSanitizer } from '@angular/platform-browser';

constructor(private sanitizer: DomSanitizer) {}

getHtml() {
  // Seulement pour le contenu de confiance
  return this.sanitizer.bypassSecurityTrustHtml(this.trustedContent);
}
```

### Q: Protection CSRF?

**Solutions:**
```typescript
import { HttpClientModule } from '@angular/common/http';

@NgModule({
  imports: [
    HttpClientModule,
    HttpClientXsrfModule.withOptions({
      cookieName: 'XSRF-TOKEN',
      headerName: 'X-XSRF-TOKEN'
    })
  ]
})
export class AppModule {}
```

## Mise à jour

### Q: Comment mettre à jour la version d'Angular?

**Solutions:**
1. Utiliser ng update
```bash
ng update @angular/core@17 @angular/cli@17
```
2. Vérifier le guide de migration
3. Mettre à jour les versions des dépendances
4. Exécuter les tests pour assurer la compatibilité

### Q: Code incompatible après mise à jour?

**Solutions:**
1. Vérifier le guide officiel de mise à jour
2. Utiliser ng update pour la migration automatique
3. Mettre à jour de manière incrémentale, ne pas sauter les versions

## Ressources d'apprentissage

### Q: Où apprendre Angular?

- Docs officielles: https://angular.io
- Angular University: https://angular-university.io
- StackBlitz: Écrire du code Angular en ligne

### Q: Comment obtenir de l'aide?

- Stack Overflow: https://stackoverflow.com/questions/tagged/angular
- Discord: https://discord.com/invite/angular
- GitHub Discussions: https://github.com/angular/angular/discussions
