# Manual de Usuario de MySQL

Este manual proporciona instrucciones completas para usar MySQL de manera efectiva.

---

## Operaciones de base de datos

### Crear base de datos

```sql
-- Crear nueva base de datos
CREATE DATABASE miapp;

-- Crear con conjunto de caracteres
CREATE DATABASE miapp CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- Mostrar bases de datos
SHOW DATABASES;

-- Seleccionar base de datos
USE miapp;

-- Eliminar base de datos
DROP DATABASE miapp;
```

### Crear tablas

```sql
-- Creación básica de tabla
CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabla con claves foráneas
CREATE TABLE pedidos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_id INT NOT NULL,
    total DECIMAL(10, 2) NOT NULL,
    estado ENUM('pendiente', 'procesando', 'enviado', 'entregado') DEFAULT 'pendiente',
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE
);
```

---

## Manipulación de datos

### Insertar datos

```sql
-- Insertar una fila
INSERT INTO usuarios (nombre, email, password)
VALUES ('juan', 'juan@ejemplo.com', 'hash_password');

-- Insertar múltiples filas
INSERT INTO usuarios (nombre, email, password) VALUES
    ('alice', 'alice@ejemplo.com', 'pass1'),
    ('bob', 'bob@ejemplo.com', 'pass2');
```

### Actualizar datos

```sql
-- Actualizar una fila
UPDATE usuarios SET password = 'nuevo_hash' WHERE id = 1;

-- Actualizar múltiples filas
UPDATE usuarios SET estado = 'activo' WHERE ultimo_login > '2024-01-01';
```

### Eliminar datos

```sql
-- Eliminar una fila
DELETE FROM usuarios WHERE id = 1;

-- Eliminar todas las filas
TRUNCATE TABLE usuarios;
```

---

## Consultar datos

### SELECT básico

```sql
-- Seleccionar todas las columnas
SELECT * FROM usuarios;

-- Seleccionar columnas específicas
SELECT nombre, email FROM usuarios;

-- Con cláusula WHERE
SELECT * FROM usuarios WHERE estado = 'activo';

-- Con ORDER BY
SELECT * FROM usuarios ORDER BY creado_en DESC;

-- Con LIMIT
SELECT * FROM usuarios LIMIT 10;
```

### Operaciones JOIN

```sql
-- INNER JOIN
SELECT p.id, u.nombre, p.total
FROM pedidos p
INNER JOIN usuarios u ON p.usuario_id = u.id;

-- LEFT JOIN
SELECT u.nombre, p.id
FROM usuarios u
LEFT JOIN pedidos p ON u.id = p.usuario_id;
```

### Funciones agregadas

```sql
-- COUNT
SELECT COUNT(*) FROM usuarios;

-- SUM, AVG, MIN, MAX
SELECT SUM(monto) FROM pedidos;
SELECT AVG(precio) FROM productos;

-- GROUP BY
SELECT pais, COUNT(*) as cantidad
FROM usuarios
GROUP BY pais
HAVING cantidad > 10;
```

---

## Gestión de usuarios

### Crear usuario

```sql
-- Crear usuario
CREATE USER 'juan'@'localhost' IDENTIFIED BY 'password123';

-- Crear usuario con privilegios específicos
CREATE USER 'app_usuario'@'%' IDENTIFIED BY 'password123';
GRANT SELECT, INSERT, UPDATE, DELETE ON miapp.* TO 'app_usuario'@'%';
```

### Gestionar privilegios

```sql
-- Conceder privilegios
GRANT SELECT, INSERT ON miapp.* TO 'usuario'@'localhost';

-- Revocar privilegios
REVOKE INSERT ON miapp.* FROM 'usuario'@'localhost';

-- Mostrar privilegios
SHOW GRANTS FOR 'usuario'@'localhost';

-- Recargar privilegios
FLUSH PRIVILEGES;
```

---

## Backup y restauración

### Backup

```bash
# Respaldar base de datos individual
mysqldump -u root -p miapp > miapp_backup.sql

# Respaldar todas las bases de datos
mysqldump -u root -p --all-databases > backup_completo.sql
```

### Restauración

```bash
# Restaurar desde backup
mysql -u root -p miapp < miapp_backup.sql
```

---

## Índices

### Crear índices

```sql
-- Índice de columna única
CREATE INDEX idx_email ON usuarios(email);

-- Índice compuesto
CREATE INDEX idx_nombre_fecha ON usuarios(nombre, apellido, creado_en);

-- Índice único
CREATE UNIQUE INDEX idx_nombre_usuario ON usuarios(nombre_usuario);
```

### Optimizar consultas

```sql
-- EXPLAIN - analizar consulta
EXPLAIN SELECT * FROM usuarios WHERE email = 'juan@ejemplo.com';

-- Optimizar tabla
OPTIMIZE TABLE usuarios;
```

---

## Replicación

### Replicación Master-Slave

**Configuración Master (my.cnf):**
```ini
[mysqld]
server-id=1
log-bin=mysql-bin
binlog-do-db=miapp
```

**Configuración Slave (my.cnf):**
```ini
[mysqld]
server-id=2
relay-log=relay-bin
read-only=1
```
