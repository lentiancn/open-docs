# Oracle 데이터베이스 사용 가이드

이 가이드에서는 Oracle 데이터베이스 사용 방법을 설명합니다.

## 빠른 시작

### 데이터베이스 연결

```bash
# SQL*Plus 사용
sqlplus / as sysdba

# 사용자 이름으로 연결
sqlplus username/password@hostname:port/service_name
```

### 기본 작업

```sql
-- 사용자 보기
SHOW USER;

-- 테이블스페이스 보기
SELECT tablespace_name FROM dba_tablespaces;

-- 테이블스페이스 생성
CREATE TABLESPACE mydata 
DATAFILE '/u01/app/oracle/oradata/orcl/mydata01.dbf' 
SIZE 100M 
AUTOEXTEND ON;

-- 사용자 생성
CREATE USER myuser IDENTIFIED BY password
DEFAULT TABLESPACE mydata;

-- 권한 부여
GRANT CONNECT, RESOURCE TO myuser;
```

## 자주 사용하는 SQL

### 테이블 작업

```sql
-- 테이블 생성
CREATE TABLE employees (
    employee_id NUMBER(10) PRIMARY KEY,
    first_name VARCHAR2(50),
    last_name VARCHAR2(50) NOT NULL,
    email VARCHAR2(100) UNIQUE,
    hire_date DATE DEFAULT SYSDATE,
    salary NUMBER(10,2)
);

-- 데이터 삽입
INSERT INTO employees (employee_id, first_name, last_name, email, salary)
VALUES (1, 'John', 'Doe', 'john@example.com', 5000);

-- 데이터 조회
SELECT * FROM employees WHERE salary > 3000;

-- 데이터 업데이트
UPDATE employees SET salary = salary * 1.1 WHERE employee_id = 1;

-- 데이터 삭제
DELETE FROM employees WHERE employee_id = 1;
```

### 제약조건

```sql
-- 기본키
ALTER TABLE employees ADD CONSTRAINT pk_emp PRIMARY KEY (employee_id);

-- 외래키
CREATE TABLE departments (
    dept_id NUMBER(10) PRIMARY KEY,
    dept_name VARCHAR2(50)
);

ALTER TABLE employees ADD CONSTRAINT fk_dept 
FOREIGN KEY (department_id) REFERENCES departments(dept_id);

-- 고유 제약조건
ALTER TABLE employees ADD CONSTRAINT uk_email UNIQUE (email);

-- 검사 제약조건
ALTER TABLE employees ADD CONSTRAINT chk_salary 
CHECK (salary > 0);
```

### 인덱스

```sql
-- 인덱스 생성
CREATE INDEX idx_emp_name ON employees(last_name, first_name);

-- 고유 인덱스 생성
CREATE UNIQUE INDEX idx_emp_email ON employees(email);

-- 인덱스 삭제
DROP INDEX idx_emp_name;
```

### 뷰

```sql
-- 뷰 생성
CREATE VIEW emp_details AS
SELECT e.employee_id, e.first_name, e.last_name, d.dept_name
FROM employees e
JOIN departments d ON e.department_id = d.dept_id;

-- 뷰 사용
SELECT * FROM emp_details;
```

### 저장 프로시저

```sql
CREATE OR REPLACE PROCEDURE update_salary(
    p_emp_id IN NUMBER,
    p_new_salary IN NUMBER
) AS
BEGIN
    UPDATE employees 
    SET salary = p_new_salary 
    WHERE employee_id = p_emp_id;
    COMMIT;
END;
/

-- 프로시저 호출
BEGIN
    update_salary(1, 6000);
END;
/
```

## 백업 및 복원

### 백업

```sql
-- 내보내기
EXP username/password FILE=exp.dmp FULL=y

-- RMAN 백업
RMAN TARGET /
BACKUP DATABASE PLUS ARCHIVELOG;
```

### 복원

```sql
-- 가져오기
IMP username/password FILE=exp.dmp FULL=y

-- RMAN 복원
RESTORE DATABASE;
RECOVER DATABASE;
```

## 사용자 관리

### 사용자 생성

```sql
CREATE USER username IDENTIFIED BY password
DEFAULT TABLESPACE USERS
TEMPORARY TABLESPACE TEMP
QUOTA UNLIMITED ON USERS;
```

### 권한 부여

```sql
-- 시스템 권한
GRANT CREATE SESSION TO username;
GRANT CREATE TABLE TO username;
GRANT CREATE VIEW TO username;

-- 객체 권한
GRANT SELECT ON employees TO username;
GRANT UPDATE ON employees TO username;
```

## 성능 최적화

### 실행 계획

```sql
EXPLAIN PLAN FOR
SELECT * FROM employees WHERE salary > 5000;

SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);
```

### 통계정보

```sql
-- 통계정보 수집
BEGIN
    DBMS_STATS.GATHER_TABLE_STATS(
        ownname => 'SCOTT',
        tabname => 'EMPLOYEES',
        estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE
    );
END;
/
```

## 관련 자료

- [Oracle 공식 문서](https://docs.oracle.com/)
- [Oracle SQL 참조](https://docs.oracle.com/cd/B12037_01/server.101/b10759/toc.htm)
