# Oracle 数据库安装指南

Oracle 数据库是业界领先的关系型数据库管理系统。本指南涵盖在各种环境中的安装方法。

## 版本信息

| 版本 | 状态 | 说明 |
|------|------|------|
| Oracle 21c | ✅ 当前 | 最新版本 |
| Oracle 19c | ✅ LTS | 长期支持版本 |
| Oracle 18c | ❌ 旧版 | 已停止支持 |

> **重要提示**：本指南主要针对 **Oracle 19c/21c**。

## 系统要求

### 硬件要求

| 要求 | 最低配置 | 推荐配置 |
|------|----------|----------|
| CPU | 2 核 | 4+ 核 |
| 内存 | 2 GB | 8+ GB |
| 磁盘 | 40 GB | 100+ GB |

### 操作系统支持

- **Linux**: Oracle Linux, RHEL, CentOS, SLES, Ubuntu
- **Windows**: Windows Server 2016+

## 安装方法

### 方法一：Linux 安装

#### 1. 准备系统

```bash
# 创建用户组
groupadd oinstall
groupadd dba
groupadd oper
groupadd backupdba
groupadd dgdba
groupadd kmdba
groupadd racdba
groupadd asmdba
groupadd asmoper
groupadd asmadmin

# 创建 Oracle 用户
useradd -g oinstall -G dba,oper,backupdba,dgdba,kmdba,racdba,asmdba,asmoper,asmadmin oracle

# 设置密码
passwd oracle

# 创建目录
mkdir -p /u01/app/oracle/product/19.3.0/dbhome_1
mkdir -p /u01/app/oraInventory
mkdir -p /u01/app/oracle

# 设置权限
chown -R oracle:oinstall /u01
chmod -R 775 /u01
```

#### 2. 设置内核参数

```bash
# /etc/sysctl.conf
cat >> /etc/sysctl.conf << EOF
kernel.shmmax = 68719476736
kernel.shmmni = 4096
kernel.shmall = 2097152
kernel.sem = 250 32000 100 128
fs.file-max = 6815744
net.ipv4.ip_local_port_range = 9000 65500
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
fs.aio-max-nr = 1048576
EOF

# 生效
sysctl -p

# /etc/security/limits.conf
cat >> /etc/security/limits.conf << EOF
oracle soft nproc 2047
oracle hard nproc 16384
oracle soft nofile 1024
oracle hard nofile 65536
oracle soft stack 10240
oracle hard stack 32768
EOF
```

#### 3. 安装依赖

```bash
# Oracle Linux
yum install -y libaio libaio-devel libXi libXtst libXext

# Ubuntu
apt-get install -y libaio1 libaio-dev libxi6 libxtst6 libxext6
```

#### 4. 运行安装程序

```bash
# 解压安装文件
unzip -q LINUX.X64_193000_db_home.zip -d /u01/app/oracle/product/19.3.0/dbhome_1/

# 以 oracle 用户运行
cd /u01/app/oracle/product/19.3.0/dbhome_1
./runInstaller
```

### 方法二：Windows 安装

1. 下载 Oracle 安装程序
2. 运行 setup.exe
3. 按照安装向导完成：
   - 选择"创建和配置单实例数据库"
   - 选择"桌面类"或"服务器类"
   - 设置 sys 和 system 密码
   - 完成安装

### 方法三：使用 Docker

```bash
# 拉取镜像
docker pull container-registry.oracle.com/database/express:21.3.0-xe

# 运行容器
docker run -d \
  --name oracle \
  -p 1521:1521 \
  -e ORACLE_PWD=MyPassword123 \
  -v oracle_data:/opt/oracle/oradata \
  container-registry.oracle.com/database/express:21.3.0-xe
```

## 安装后配置

### 环境变量

```bash
# ~/.bash_profile
export ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1
export ORACLE_SID=orcl
export PATH=$ORACLE_HOME/bin:$PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:$LD_LIBRARY_PATH
```

### 启动数据库

```bash
# 启动监听
lsnrctl start

# 启动数据库
sqlplus / as sysdba
STARTUP;
```

## 常见问题

### 内存不足？

```bash
# 检查内存
grep MemTotal /proc/meminfo

# 调整 swap
```

### 安装失败？

检查日志：
```bash
cat /u01/app/oraInventory/logs/installActions*.log
```

## 相关链接

- [Oracle 官方文档](https://docs.oracle.com/)
- [Oracle 下载](https://www.oracle.com/database/technologies/)