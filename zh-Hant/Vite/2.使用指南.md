# Vite 使用指南

本指南介紹如何使用 Vite 建構現代 Web 應用。

## 快速開始

### 建立專案

```bash
npm create vite@latest my-app -- --template vue
cd my-app
npm install
npm run dev
```

### 專案結構

```
my-app/
├── public/
│   └── favicon.ico
├── src/
│   ├── assets/
│   │   └── logo.png
│   ├── components/
│   │   └── HelloWorld.vue
│   ├── App.vue
│   ├── main.js
│   └── style.css
├── index.html
├── package.json
└── vite.config.js
```

### 入口檔案

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import './style.css'

createApp(App).mount('#app')
```

```html
<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
```

## 核心概念

### 原生 ESM

Vite 利用瀏覽器原生 ES 模組支援，無需打包：

```javascript
// 直接匯入模組
import { add } from './math.js'

console.log(add(2, 3))
```

### 熱模組替換

Vite 提供極速的 HMR：

```javascript
// 模組會自動更新
import { hot } from 'vite/hmr'

if (hot) {
  hot.accept()
}
```

### 按需編譯

Vite 只編譯實際需要的檔案：

```bash
# 首次啟動
VITE v4.0.0 ready in 300 ms

# 檔案變化時
VITE 4.0.0 hot updated in 1 ms
```

## 常用功能

### 匯入 CSS

```javascript
import './style.css'
import './variables.scss'
```

### 匯入圖片

```javascript
import imgUrl from './img.png'

document.getElementById('app').innerHTML = `<img src="${imgUrl}">`
```

### 匯入 JSON

```javascript
import data from './data.json'
console.log(data)
```

### 動態匯入

```javascript
const module = await import('./module.js')
module.default()
```

## Vue 支援

### Vue 元件

```vue
<template>
  <button @click="count++">Count: {{ count }}</button>
</template>

<script setup>
import { ref } from 'vue'

const count = ref(0)
</script>
```

### Vue 插件

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],
})
```

## React 支援

### React 元件

```jsx
import { useState } from 'react'

function App() {
  const [count, setCount] = useState(0)
  return <button onClick={() => setCount(count + 1)}>{count}</button>
}
```

### React 插件

```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
})
```

## 環境變數

### 定義變數

```
# .env
VITE_APP_TITLE=My App
VITE_API_BASE_URL=https://api.example.com
```

### 使用變數

```javascript
console.log(import.meta.env.VITE_APP_TITLE)
console.log(import.meta.env.VITE_API_BASE_URL)
```

### 環境特定變數

```
# .env.development
VITE_API_URL=http://localhost:3000

# .env.production
VITE_API_URL=https://api.example.com
```

## 建構優化

### 程式碼分割

```javascript
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router'],
        },
      },
    },
  },
})
```

### 壓縮

```javascript
export default defineConfig({
  build: {
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
      },
    },
  },
})
```

## 常見問題

### 如何處理別名？

```javascript
import path from 'path'

export default defineConfig({
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
})
```

### 如何處理圖片？

```javascript
export default defineConfig({
  assetsInclude: ['**/*.hdr'],
})
```

### 如何使用全域變數？

```javascript
export default defineConfig({
  define: {
    __APP_VERSION__: JSON.stringify('1.0.0'),
  },
})
```

## 相關資源

- [Vite 官方文件](https://vitejs.dev/)
- [Vite 中文文件](https://cn.vitejs.dev/)
- [Vue 3 文件](https://vuejs.org/)
