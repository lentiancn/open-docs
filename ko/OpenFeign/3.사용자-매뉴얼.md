# OpenFeign 사용자 매뉴얼

## 기본 사용법

### Feign 클라이언트 생성

`@FeignClient` 어노테이션으로 인터페이스 정의:

```java
@FeignClient(name = "user-service", url = "https://api.users.com")
public interface UserClient {
    
    @RequestMapping(method = RequestMethod.GET, value = "/users/{id}")
    User getUserById(@PathVariable("id") Long id);
    
    @RequestMapping(method = RequestMethod.POST, value = "/users")
    User createUser(@RequestBody User user);
}
```

### 클라이언트 사용

서비스에 클라이언트를 주입하여 사용:

```java
@Service
public class UserService {
    
    @Autowired
    private UserClient userClient;
    
    public User getUser(Long id) {
        return userClient.getUserById(id);
    }
}
```

---

## 고급 기능

### 요청/응답 인터셉터

```java
@Component
public class AuthInterceptor implements RequestInterceptor {
    
    @Override
    public void apply(RequestTemplate template) {
        template.header("Authorization", "Bearer " + getToken());
    }
}
```

### 오류 처리

```java
@Component
public class ErrorDecoder implements ErrorDecoder {
    
    @Override
    public Exception decode(String methodKey, Response response) {
        if (response.status() == 404) {
            return new NotFoundException("Resource not found");
        }
        return new RuntimeException("Unknown error: " + response.status());
    }
}
```

### 폴백 메커니즘

```java
@FeignClient(name = "user-service", fallback = UserClientFallback.class)
public interface UserClient {
    @RequestMapping(method = RequestMethod.GET, value = "/users/{id}")
    User getUser(@PathVariable("id") Long id);
}

@Component
public class UserClientFallback implements UserClient {
    
    @Override
    public User getUser(Long id) {
        return new User();
    }
}
```

---

## 설정

```yaml
feign:
  client:
    config:
      default:
        connectTimeout: 5000
        readTimeout: 5000
        loggerLevel: basic
```
