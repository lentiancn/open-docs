# Apache APISIX 簡介

## 什麼是 Apache APISIX

Apache APISIX 是一個**雲端原生 API 閘道**，也是一款 **AI 閘道**，由 API7.ai 開發並捐贈給 Apache 軟體基金會，已成為 Apache 軟體基金會的頂級專案。

你可以把 APISIX 理解為介於客戶端和後端服務之間的「流量管理器」。它負責接收來自客戶端的所有請求，然後根據預設的規則決定如何處理這些請求——是直接轉發到某個後端服務、進行負載均衡，還是進行身份驗證後再轉發。

## 核心定位

- **傳統 API 閘道**：處理南北向流量（從外部到內部網路的流量）
- **服務網格**：處理東西向流量（服務與服務之間的內部流量）
- **Kubernetes Ingress 控制器**：作為 Kubernetes 叢集的入口
- **AI 閘道**：支援 LLM 代理、負載均衡、重試降級、Token 限流等 AI 場景

## 主要特性

### 1. 全動態能力

APISIX 的最大特點是**無需重啟即可動態更新配置**。你可以隨時新增、修改或刪除路由、上游、插件等配置，變更會立即生效，不會影響正在處理的請求。

- **動態路由**：根據請求參數、Header、Cookie 等條件靈活匹配
- **動態上游**：無需重啟即可切換後端服務節點
- **動態憑證**：支援 HTTPS 憑證的熱載入
- **熱更新插件**：在不重啟閘道的情況下啟用或停用插件

### 2. 豐富的流量管理功能

- **負載均衡**：支援輪詢、加權輪詢、雜湊一致性等多種演算法
- **灰度發布**：平滑地將流量從舊版本切換到新版本
- **A/B 測試**：根據不同條件將使用者分配到不同的服務版本
- **流量分割**：精確控制不同服務之間的流量比例
- **熔斷器**：自動偵測並隔離故障的上游服務

### 3. 完善的安全機制

APISIX 提供了多種身份驗證和存取控制插件：

- Key Authentication（API 金鑰驗證）
- JWT Authentication（JSON Web Token）
- Basic Authentication（基本驗證）
- OAuth 2.0
- HMAC 驗證
- LDAP 驗證
- IP 白名單/黑名單
- Referer 防盜鏈
- CSRF 防護
- 請求限流（limit-count、limit-req、limit-concurrency）

### 4. 可觀測性

APISIX 內建了完整的監控和追蹤能力：

- **Prometheus 指標**：即時監控閘道效能
- **分散式追蹤**：支援 Zipkin、SkyWalking
- **日誌管理**：支援將存取日誌傳送到 Kafka、Elasticsearch、Splunk 等
- **監控告警**：支援多種告警通知

### 5. 多協定支援

APISIX 不僅支援傳統的 HTTP/HTTPS，還支援：

- TCP/UDP 代理
- gRPC 及 gRPC Web
- Dubbo
- MQTT
- WebSocket
- HTTP/3 (QUIC)

### 6. 多語言插件開發

APISIX 支援使用多種語言編寫自訂插件：

- Lua（原生支援）
- Java（透過 Java Plugin Runner）
- Go（透過 Go Plugin Runner）
- Python（透過 Python Plugin Runner）
- Wasm（WebAssembly）

## 技術架構

APISIX 的架構設計非常簡潔：

- **資料面**：使用 Nginx + Lua 實現高效能請求處理
- **控制面**：使用 etcd 儲存配置，實現叢集間的配置同步
- **管理面**：提供 REST Admin API 和 Dashboard UI 進行配置管理

APISIX 節點是無狀態的，可以輕鬆橫向擴展。透過設定多個 etcd 位址，可以實現高可用性。

## 適用場景

- 建構微服務架構的 API 閘道
- Kubernetes 叢集的入口閘道
- 保護內部 API 服務的身份驗證和存取控制
- 實現 API 限流、熔斷等保護機制
- 將傳統服務暴露為 API 供外部呼叫
- 作為 AI 應用的閘道，管理 LLM 請求
- 實現藍綠部署和灰度發布

## 總結

Apache APISIX 是一個功能強大、高效能、易擴展的雲端原生 API 閘道。它兼具動態、即时、高效能的特點，可以幫助你輕鬆管理 API 流量，實現身份驗證、限流、監控等企業級功能。無論你是小型新創公司還是大型企業，APISIX 都能滿足你的 API 閘道需求。
